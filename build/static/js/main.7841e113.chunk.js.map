{"version":3,"sources":["store/api.js","Account/Login.js","Account/SignUp.js","store/globalsReducer.js","CommunityManager/CommunityManager.js","TopNavBar/TopNavbar.js","store/dialogReducer.js","store/kftag.service.js","store/notifier.js","store/noteReducer.js","components/dialog/Dialog.js","components/editor/MCEditor.js","components/attachmentCollapse/AttachPanel.js","store/scaffoldReducer.js","components/scaffold/scaffold.service.js","components/scaffold/ScaffoldSelect.js","components/attachmentArea/AttachArea.js","components/writeTab/WriteTab.js","components/historyTab/History.js","components/propertiesTab/Properties.js","components/authorSelect/AuthorSelect.js","components/authorsTab/AuthorTab.js","components/annotator/annotator.service.js","store/userReducer.js","store/store.js","components/annotator/Annotator.js","components/note/Note.js","components/drawDialog/DrawDialog.js","components/dialogHandler/DialogHandler.js","components/NoteContent/NoteContent.js","components/Author/Author.js","View/View.js","components/newNote/NewNote.js","Account/ChangePassword.js","components/test/TestComponent.js","App.js","serviceWorker.js","index.js"],"names":["url","apiUrl","setToken","token","axios","defaults","headers","common","sessionStorage","getItem","getCommunity","communityId","get","getGroups","a","data","getLinks","objectId","direction","type","links","filter","each","postLink","fromId","toId","post","from","to","deleteLink","linkId","delete","getObject","putObject","object","put","postAttachment","authorId","newobj","title","authors","status","permission","version","postContribObject","obj","getCommunityAuthors","getRecords","contribId","uploadFile","file","onProgress","formData","FormData","append","onUploadProgress","Login","state","userName","password","handleChange","bind","handleSubmit","e","target","name","value","this","setState","preventDefault","console","log","Axios","then","response","setItem","props","history","push","catch","error","Container","className","Col","Form","onSubmit","FormGroup","Label","htmlFor","Input","id","placeholder","onChange","Button","Component","SignUp","firstName","lastName","email","registrationKey","message","alert","class","setCommunity","createAction","setCommunityId","setViewId","setAuthor","setView","editCommunity","dateFormatOptions","year","month","day","hour","minute","second","hour12","initState","viewId","contextId","author","view","community","globalsReducer","createReducer","action","payload","rootContextId","fetchAuthor","dispatch","getAuthor","res","fetchView","fetchCommunity","groups","CommunityManager","myRegistrations","config","Authorization","communitites","welcomeId","userId","registrations","registerUrl","result","window","location","reload","communityData","myCommunity","myState","viewUrl","_id","pathname","map","Row","key","_community","variant","onClick","enterCommunity","mapDispatchToProps","connect","ownProps","TopNavbar","loggedIn","myViews","viewTitle","removeItem","n","length","test","persist","Navbar","bg","fixed","Brand","href","Nav","Link","logout","openDialog","closeDialog","openDrawDialog","closeDrawDialog","focusDialog","openAttachPanel","closeAttachPanel","dialogCounter","dialogReducer","dialogs","drawTool","focused","attachPanel","dlgs","dlg","zIndex","createScaffoldStartTag","isTemplate","tag","createScaffoldEndTag","createReferenceTag","contId","text","preProcess","body","toConnections","fromConnections","doc","jq","$","supportStart","find","addClass","i","elem","startsWith","hasClass","ref","conn","innerHTML","_from","supportEnd","references","_to","html","postProcess","contributionId","handler","endtags","supportLinksIds","supportStarts","supportEnds","toCreate","supportStartsIds","supportId","split","includes","link","oldId","newId","toDeleteSupports","referenceLinksIds","kfReferences","kfreferenceIds","referenceId","toDeleteReferences","Promise","all","notifConfig","insert","container","animationIn","animationOut","dismiss","duration","addNotification","notif","store","addNote","removeNote","editNote","addDrawing","removeDrawing","editSvg","addAttachment","removeAttachment","setAttachments","setWordCount","setLinks","setRecords","removeContribAuthor","addContribAuthor","setAnnotation","setAnnotationsLoaded","removeAnnotation","noteReducer","drawing","attachments","notes","note","Object","assign","noteId","svg","attachment","att","attId","forEach","wordCount","wc","contrib","fromLinks","toLinks","records","auth","annos","annotation","annoId","newNote","mode","group","_groupMembers","newN","contextMode","content","undefined","buildson","langInNote","docId","myself","coauthors","ca","createdBy","docShared","text4search","createNote","api","x","y","confirmButton","fetchAttachments","link_atts","attach","fetchLinks","openContribution","getState","noteBody","annoLinks","annLink","anno","modelId","annot","dialog_style","display","Dialog","style","default","pageXOffset","pageYOffset","width","height","onMouseDown","dragHandleClassName","bounds","Card","Header","alignItems","onClose","size","marginLeft","Body","children","Footer","onConfirm","MCEditor","apiKey","init","setup","editor","onEditorSetup","content_css","menubar","statusbar","media_live_embeds","plugins","external_plugins","toolbar","onEditorChange","React","AttachPanel","useSelector","globals","useDispatch","useState","progress","setProgress","handleClose","onFileSelect","fileList","files","Array","indexOf","_URL","URL","webkitURL","img","document","createElement","onload","naturalWidth","naturalHeight","createAttachment","src","createObjectURL","attachRes","uploadRes","filename","tmpFilename","newAttachment","inlineAttach","data_mce_src","serverUrl","onNewInlineAttach","progressEvent","percentCompleted","Math","round","loaded","total","Modal","show","onHide","closeButton","Title","File","color","FileDrop","onFrameDragEnter","event","onFrameDragLeave","onFrameDrop","onDragOver","onDragLeave","onDrop","ProgressBar","now","requestScaffold","receiveScaffold","scaffoldReducer","isFetching","items","fetched","addHyphen","initText","supportContentId","Date","getTime","toString","ScaffoldSelect","scaffoldSelected","scaffoldId","support","scaffold","addhyphen","initialText","scaffold_text","tagCreator","scaffoldService","onScaffoldSelected","selected","initVal","onSelectChange","fetchScaffolds","scaffolds","options","supports","md","Group","controlId","Control","as","scaffold_promise","el","AttachArea","selectedImgs","setSelectedImgs","deleteAttachment","onNewAttachClick","getElementById","getElementsByClassName","tagName","getAttribute","classList","cls_name","disabled","imgs","alt","downloadUrl","download","WriteTab","onNewAttachmentClick","inline","val","History","reduce","acc","read","edit","record","date","Properties","onPermissionChange","evt","checked","contribution","AuthorSelect","select_options","entries","label","selectedOption","setSelectedOption","isClearable","onAuthorSelected","AuthorTab","users","communityAuthors","group_options","g","setG","idx","cursor","removeAuthor","method","setKFPlugin","annotatorHandler","uname","scaffoldElement","Annotator","Plugin","KFPlugin","pluginInit","annotator","subscribe","annotationCreated","annotationUpdated","annotationDeleted","displayEditor","viewer","annotations","displayViewer","editorHidden","annotatorInitialized","__hasProp","hasOwnProperty","RichText","_super","child","parent","call","ctor","constructor","prototype","__super__","__extends","editorId","element","apply","arguments","tinymce","selector","toolbar_items_size","extended_valid_elements","supported","addField","load","updateEditor","updateViewer","ed","mceditor","on","activeEditor","getContent","css","ui","registry","addSidebar","tooltip","icon","onSetup","sidebar","overflow","fontSize","ReactDOM","render","onShow","field","count","editors","setContent","remove","textDiv","parentNode","user","permissions","update","admin","showEditPermissionsCheckbox","vm2m","isPublic","loc","ranges","start","substring","end","addUser","addAuthors","userReducer","fetchAuthors","configureStore","reducer","devTools","contentRef","createRef","fixPopupLocation","loadAnnotations","annotatedElem","current","scaffoldElem","annotPlugins","onDelete","containerId","prevProps","prevState","annotsFetched","off","values","annots","highlights","onAnnotsLoaded","$element","attr","adder","observer","MutationObserver","mutationsList","takeRecords","observe","attributes","attributeOldValue","onCreate","onUpdate","classes","invert","popup","dlgOffset","offset","ppOffset","top","left","selection","insertContent","contentTag","dom","setCursorLocation","dangerouslySetInnerHTML","__html","Note","onDrawingToolOpen","onNoteChange","onTabSelected","onAnnotationCreated","onAnnotationDeleted","onAnnotationUpdated","snapshot","addSupport","wordcount","getCount","labels","numwords","scaffoldWordCount","onDrawButton","editSvgDialog","tab","fetchRecords","fetchCommGroups","createAnnotation","deleteAnnotation","model","modifyAnnotation","formatter","Intl","DateTimeFormat","format","modified","Tabs","defaultActiveKey","transition","onSelect","Tab","eventKey","dlgId","timestamp","ann","anno_updated","DrawDialog","onLoad","getIframeRef","wnd1","iframe_ref","contentWindow","svgCanvas","current_drawing_","all_layers","wnd2","widd","getBBox","heig","svgElem_","setAttribute","childNodes","selectAllInCurrentLayer","groupSelectedElements","alignSelectedElements","ungroupSelectedElement","clearSelection","setResolution","getSvgString","canvas","ctx","getContext","btoa","drawImage","p","toDataURL","frame","setSvgString","DialogHandler","onDialogClose","useCallback","onDialogConfirm","dialogId","onFocusDialog","onCloseDrawDialog","onConfirmDrawDialog","elt","NoteContent","noteList","addView","visible","noteContnetList","query","setTimeout","Alert","isOpen","English","index","closeNote","Author","authorName","authorUrl","filteredObj","_","require","View","myCommunityId","myTempTo","hierarchyNote","noteData1","noteContnetNew","handleChangeView","noteArray","pop","filterNotes","filteredResults","filteredData","handleInputChange","viewLinks","toLowerCase","scaffoldTitle","scaffoldsTitle","handleFilter","buildOn","openNote","myCommunities","views","showView","showCommunity","showContribution","showNote","hNotes","showRiseAbove","showModel","showNoteContent","noteData","handleSubmitView","onCloseDialog","showContent","viewNotesUrl","noteUrl","sortedLinks","sortBy","reverse","searchUrl","l","temporaryTo","addViewUrl","isChecked","viewObj","handleShow","sm","xs","DropdownButton","drop","Dropdown","Item","newView","newRiseAbove","created","subObj","j","varient","changeView","riseAboveTitle","NewNote","useEffect","marginTop","ChangePassword","oldPassword","newPassword","changePasswdUrl","TestComponent","App","exact","path","component","Boolean","hostname","match","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7841e113.chunk.js","sourcesContent":["import axios from 'axios';\n\n// export const url = 'https://kf6.ikit.org';\nexport const url = 'https://kf6-stage.ikit.org';\n// export const url = \"http://localhost:9000\";\nexport const apiUrl = `${url}/api`;\n\n\nexport function setToken(token) {\n    axios.defaults.headers.common['Authorization'] =\n        `Bearer ${token}`;\n}\n\nexport const removeToken = () => {\n    delete axios.defaults.headers.common.Authorization\n}\n\n\nconst token = sessionStorage.getItem('token');\nif (token){\n    setToken(token)\n}\n\n//Contribution\nexport const postContribution = (communityId, obj) => {\n    return axios.post(`${apiUrl}/contributions/${communityId}`, obj);//, {mode: 'cors'});\n}\n\n//Community\nexport const getCommunity = (communityId) => {\n    return axios.get(`${apiUrl}/communities/${communityId}`);//, {mode: 'cors'});\n}\nexport const getGroups = async (communityId) => {\n    return (await axios.get(`${apiUrl}/communities/${communityId}/groups`)).data\n}\n\n//Links\nexport const getLinks = async (objectId, direction, type) => {\n    let links = await axios.get(`${apiUrl}/links/${direction}/${objectId}`);\n    links = links.data;\n    if (type) {\n        links = links.filter(function (each) {\n            return each.type === type;\n        });\n    }\n    return links\n}\n\nexport const postLink = async (fromId, toId, type, data) => {\n    return (await axios.post(`${apiUrl}/links`, {from: fromId, to: toId, type:type, data:data})).data\n}\n\nexport const deleteLink = async (linkId) => {\n    return (await axios.delete(`${apiUrl}/links/${linkId}`)).data\n}\n\n//Object\nexport const getObject = async (objectId) => {\n    return (await axios.get(`${apiUrl}/objects/${objectId}`)).data\n}\n\nexport const putObject = async (object, communityId, objectId) => {\n    return (await axios.put(`${apiUrl}/objects/${communityId}/${objectId}`, object)).data\n}\n\n//Record\nexport const read = (communityId, objectId) => {\n    return axios.post(`${apiUrl}/records/read/${communityId}/${objectId}`)\n}\n\nexport const postAttachment = (communityId, authorId) => {\n    var newobj = {\n        communityId: communityId,\n        type: 'Attachment',\n        title: 'an Attachment',\n        authors: [authorId],\n        status: 'unsaved',\n        permission: 'protected',\n        data: {\n            version: 0\n        }\n    };\n    return axios.post(`${apiUrl}/contributions/${communityId}`, newobj)\n}\n\nexport const postContribObject = async (communityId, obj) => {\n    return (await axios.post(`${apiUrl}/contributions/${communityId}`, obj)).data\n}\n\n//Author\nexport const getAuthor = (communityId) => {\n    return axios.get(`${apiUrl}/authors/${communityId}/me`)\n}\nexport const getCommunityAuthors = async (communityId) => {\n    return (await axios.get(`${apiUrl}/communities/${communityId}/authors`)).data\n}\n\n//Records\nexport const getRecords = async (contribId) => {\n    return (await axios.get(`${apiUrl}/records/object/${contribId}`)).data\n}\n\nexport const uploadFile = (file, onProgress) => {\n    var formData = new FormData();\n    formData.append(\"file\", file);\n    return axios.post(`${apiUrl}/upload`, formData, {\n        headers: {\n            'Content-Type': 'multipart/form-data',\n            // ...config.headers\n        },\n        onUploadProgress: onProgress,\n    })\n}\n\n// export default {url, apiUrl, postContribution, getCommunity,\n//                 getLinks, getObject, createAttachment,\n//                 getAuthor, uploadFile, putObject,\n//                 postLink, deleteLink, getCommunityAuthors,\n//                 getRecords, read\n//                }\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Axios from 'axios';\nimport {Container, Col, Form, FormGroup, Label, Input, Button} from 'reactstrap';\nimport {url, setToken} from '../store/api.js'\n\nclass Login extends Component {\n    constructor() {\n        super();\n\n        this.state = {\n            userName: '',\n            password: ''\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n    }\n\n    handleChange(e) {\n        let target = e.target;\n        let name = target.name;\n        let value = target.value;\n\n        this.setState({\n          [name]: value\n        });\n    }\n\n    handleSubmit(e) {\n        e.preventDefault();\n\n        console.log('The form was submitted with:');\n        console.log(this.state);\n\n        //LOGIN RETURNS TOKEN\n        Axios.post(\n            `${url}/auth/local`,\n            this.state)\n            .then((response)=>{\n                console.log(response.data.token);\n                this.token= response.data.token;\n\n                //SET TOKEN\n                sessionStorage.setItem('token',this.token);\n                setToken(this.token)\n                //NAVIGATE TO COMMUNITY MANAGER\n                this.props.history.push(\"/community-manager\");\n            })\n            .catch((error)=>{\n                // if(error.message){\n                //     console.log(error);\n                //     alert(\"Please enter Valid username and password\");\n                // }\n            }\n\n            );\n    }\n\n    render() {\n        return (\n            <Container>\n            <div className=\"mrg-4-top\">\n                <Col>\n                    <h3>Login</h3>\n                </Col>\n                <Form onSubmit={this.handleSubmit} className=\"form\">\n                <Col>\n                <FormGroup>\n                    <Label htmlFor=\"userName\">Username</Label>\n                    <Input type=\"text\" id=\"userName\" placeholder=\"Enter Username\" name=\"userName\" value={this.state.userName} onChange={this.handleChange} />\n                </FormGroup>\n                </Col>\n                <Col>\n                <FormGroup>\n                    <Label htmlFor=\"password\">Password</Label>\n                    <Input type=\"password\" id=\"password\" placeholder=\"Enter Password\" name=\"password\" value={this.state.password} onChange={this.handleChange} />\n                </FormGroup>\n                </Col>\n                <Col className=\"mrg-1-top\">\n                    <Button>Login</Button>\n                </Col>\n                <Col className=\"mrg-1-top\">\n                    <Link to=\"/signup\">If you don't have an account, please SignUp</Link>\n                </Col>\n                </Form>\n            </div>    \n          </Container>\n        );\n    }\n}\n\nexport default Login;\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Axios from 'axios';\nimport {Container, Col, Form, FormGroup, Label, Input, Button} from 'reactstrap';\nimport {apiUrl} from '../store/api.js';\n\nclass SignUp extends Component {\n    constructor() {\n        super();\n\n        this.state = {\n            firstName:'',\n            lastName:'',\n            email: '',\n            userName: '',\n            password: '',\n            registrationKey: '',\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n    }\n\n    //HANDLES THE REALTIME CHANGING VALUE\n    handleChange(e) {\n        let target = e.target;\n        let name = target.name;\n        let value = target.value;\n\n        //NAME IS ATTRIBUTE NAME AND VALUE IS ATTRIBUTE VALUE\n        this.setState({\n          [name]: value\n        });\n    }\n\n    //HANDLE SUBMIT\n    handleSubmit(e) {\n        e.preventDefault();\n\n        console.log('The form was submitted with:');\n        console.log(this.state);\n\n        Axios.post(\n          `${apiUrl}/users`,\n            this.state)\n            .then((response)=>{\n                console.log(response.data.token);\n                this.token= response.data.token;\n                \n                //SET TOKEN\n                sessionStorage.setItem('token',this.token);\n                //NAVIGATE TO COMMUNITY MANAGER TEMP\n                this.props.history.push('/community-manager')\n            })\n            .catch((error)=>{\n                if(error.message){\n                    console.log(error.message);\n                    alert(\"Enter Valid Username and Password\");\n                }\n            });\n    }\n\n    render() {\n        return (\n        <Container>\n        <div className=\"mrg-4-top\">\n          <Col>\n            <h3>SignUp</h3>\n          </Col>\n            <Form onSubmit={this.handleSubmit} class=\"form\">\n              <Col>\n              <FormGroup>\n                <Label htmlFor=\"firstName\">First Name</Label>\n                <Input type=\"text\" id=\"firstName\" placeholder=\"Enter First Name\" name=\"firstName\" value={this.state.firstName} onChange={this.handleChange} />\n              </FormGroup>\n              </Col>\n              <Col>\n              <FormGroup>\n                <Label htmlFor=\"lastName\">Last Name</Label>\n                <Input type=\"text\" id=\"lastName\" placeholder=\"Enter Last Name\" name=\"lastName\" value={this.state.lastName} onChange={this.handleChange} />\n              </FormGroup>\n              </Col>\n              <Col>\n              <FormGroup>\n                <Label htmlFor=\"email\">Email</Label>\n                <Input type=\"email\" id=\"email\" placeholder=\"Enter Email\" name=\"email\" value={this.state.email} onChange={this.handleChange} />\n              </FormGroup>\n              </Col>\n              <Col>\n              <FormGroup>\n                <Label htmlFor=\"userName\">Username</Label>\n                <Input type=\"text\" id=\"userName\" placeholder=\"Enter Username\" name=\"userName\" value={this.state.userName} onChange={this.handleChange} />\n              </FormGroup>\n              </Col>\n              <Col>\n              <FormGroup>\n                <Label htmlFor=\"password\">Password</Label>\n                <Input type=\"password\" id=\"password\" placeholder=\"Enter Password\" name=\"password\" value={this.state.password} onChange={this.handleChange} />\n              </FormGroup>\n              </Col>\n\n              <Col>\n                  <Button className=\"\">New Account</Button>\n              </Col>\n              <Col className=\"mrg-1-top\">\n                <Link to=\"/\" className=\"FormField__Link\">If you already have an account, please Signin</Link>\n              </Col>\n            </Form>\n          </div>\n          </Container>\n        );\n    }\n}\n\nexport default SignUp;","import { createAction, createReducer } from '@reduxjs/toolkit';\nimport {getAuthor, getObject, getCommunity, getGroups} from './api.js'\n\nexport const setCommunity = createAction('SET_COMMUNITY')\nexport const setCommunityId = createAction('SET_COMMUNITY_ID')\nexport const setViewId = createAction('SET_VIEW_ID')\nexport const setAuthor = createAction('SET_AUTHOR')\nexport const setView = createAction('SET_VIEW')\nexport const editCommunity = createAction('EDIT_COMMUNITY')\nexport const dateFormatOptions = {\n    year: 'numeric', month: 'numeric', day: 'numeric',\n    hour: 'numeric', minute: 'numeric', second: 'numeric',\n    hour12: true\n};\n\nconst initState = {\n    communityId: sessionStorage.getItem('communityId'),\n    viewId: sessionStorage.getItem('viewId'),\n    contextId: '',\n    // communityId: '5e445735d525b936837f7450',\n    author: {},\n    view: null,\n    community: null\n}\n\nexport const globalsReducer = createReducer(initState, {\n    [setCommunityId]: (state, action) => {\n        state.communityId = action.payload\n    },\n    [setViewId]: (state, action) => {\n        state.viewId = action.payload\n    },\n    [setAuthor]: (state, action) => {\n        state.author = action.payload\n    },\n    [setView]: (state, action) => {\n        state.view = action.payload\n    },\n    [setCommunity]: (state, action) => {\n        state.community = action.payload\n        state.contextId = action.payload.rootContextId\n    },\n    [editCommunity]: (state, action) => {\n        state.community = {...state.community, ...action.payload}\n    }\n});\n\nexport const fetchAuthor = (communityId) => {\n    return dispatch => {\n        return getAuthor(communityId).then( res => {\n            dispatch(setAuthor(res.data));\n        })\n    }\n}\n\nexport const fetchView = (viewId) => {\n    return dispatch => {\n        return getObject(viewId).then( res => {\n            dispatch(setView(res))\n        })\n    }\n}\n\nexport const fetchCommunity = (communityId) => {\n    return dispatch => {\n        return getCommunity(communityId).then( res => {\n            dispatch(setCommunity(\n                {groups: [], ...res.data}\n            ))\n        })\n    }\n}\n\nexport const fetchCommGroups = (communityId) => async (dispatch) => {\n    const groups = await getGroups(communityId)\n    dispatch(editCommunity({groups}))\n}\n","import React, { Component } from 'react';\nimport Axios from 'axios';\nimport {Container, Col, Row, Form, FormGroup, Label, Input} from 'reactstrap';\nimport { Button } from 'react-bootstrap';\nimport {apiUrl} from '../store/api.js'\nimport { connect } from 'react-redux'\nimport { setCommunityId, setViewId } from '../store/globalsReducer.js'\n\nclass CommunityManager extends Component {\n\n    token= sessionStorage.getItem('token');\n    myRegistrations= [];\n\n    //SET HEADER WITH TOKEN BEARER\n    config = {\n        headers: { Authorization: `Bearer ${this.token}` }\n    };\n\n    constructor(props) {\n        super(props);\n\n        this.state={\n            communitites: [],\n            password: '',\n            communityId: '',\n            welcomeId: '',\n            userId: sessionStorage.getItem(\"userId\"),\n            token: sessionStorage.getItem(\"token\"),\n            registrations: []\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n    }\n\n    handleChange = (e) => {\n        let target = e.target;\n        let name = target.name;\n        let value = target.value;\n        console.log(name,value);\n        \n\n        this.setState({\n            [name]: value\n        });\n    }\n\n    handleSubmit(e) {\n        e.preventDefault();\n        console.log(\"FORM\",this.state);\n        \n        //REGISTER NEW COMMUNITY TO AUTHOR\n        var registerUrl= `${apiUrl}/authors`;\n        var data= {\"communityId\": this.state.communityId, \"registrationKey\": this.state.password, \"userId\":this.state.userId};\n        var config = {\n            headers: { Authorization: `Bearer ${this.state.token}` }\n        };\n\n        Axios.post(registerUrl, data, config)\n            .then(\n                result=>{\n                    console.log(\"AUTHOR\", result.data);\n                    window.location.reload();                   \n                }).catch(\n                    error=>{\n                        // alert(error);\n                })\n        \n    }\n\n    componentDidMount(){\n        //GET LIST OF ALL COMMUNITIES\n        Axios.get(`${apiUrl}/communities`)\n        .then(\n            result=>{\n                this.communityData= result.data;\n                console.log(this.communityData);\n                this.setState({\n                    communitites: result.data\n                 })\n            }).catch(\n                error=>{\n                    console.log(\"GET Communities Failed\");\n                    alert(\"GET Communities Failed\");\n                }\n            );\n\n            //GET USER'S REGISTERED COMMUNITIES\n        Axios.get(`${apiUrl}/users/myRegistrations`, this.config)\n            .then(\n                result=>{\n                    console.log(\"registrations\")\n                    console.log(result.data)\n                    this.myRegistrations= result.data; \n                    this.setState({\n                        registrations: result.data\n                    })\n                }).catch(\n                    error=>{\n                        alert(error);\n                    }\n                );\n    }\n\n    enterCommunity(myCommunity){\n        var id= myCommunity.obj.communityId;\n        sessionStorage.setItem('communityId',myCommunity.obj.communityId)\n        this.props.setCommunityId(id)\n        let myState={\n            communityId:id,\n            welcomeId:''\n        } \n\n        //SET HEADER WITH TOKEN BEARER\n        var config = {\n            headers: { Authorization: `Bearer ${this.token}` }\n        };\n\n        //GET USER'S VIEWS\n        var viewUrl= `${apiUrl}/communities/${id}/views`;\n        console.log(viewUrl);\n        \n        Axios.get(viewUrl, config)\n        .then(\n            result=>{\n                // viewId= result.data[0]._id;\n                myState.welcomeId= result.data[0]._id;\n                sessionStorage.setItem('viewId',result.data[0]._id);\n                this.props.setViewId(result.data[0]._id)\n\n                this.props.history.push({pathname: \"/view\", state: myState});\n            }).catch(\n                error=>{\n                    alert(error);\n                });\n        \n    }\n\n    render() {\n        return (\n            <Container>\n                <div className=\"mrg-4-top\">\n                \n                <Container className=\"mrg-2-top\">\n                    <h6>My Knowledge Building Communities</h6>\n                    {this.state.registrations.map((obj, id) => {\n                        return <Row key={id} value={obj.communityId} className=\"mrg-05-top\">\n                            <Col>{obj._community.title}</Col>\n                            <Col><Button variant=\"outline-secondary\" onClick={()=>this.enterCommunity({obj})}>Enter Community</Button></Col>\n                        </Row>\n                    })}\n                </Container>\n\n                <Form onSubmit={this.handleSubmit} className=\"form\">\n                    <Col>\n                    <FormGroup>\n                    <Label>Register Community</Label>\n                        <Input type=\"select\" name=\"communityId\" id=\"communityId\" value={this.state.communityId}  onChange={this.handleChange}>{\n                            this.state.communitites.map((obj) => {\n                                return <option key={obj._id} value={obj._id}>{obj.title}</option>\n                            })\n                        }</Input>\n                    </FormGroup>\n                    <FormGroup>\n                    <Label>Registration Key</Label>\n                        <Input type=\"password\" name=\"password\" placeholder=\"Enter Registration Key\" id=\"password\" value={this.state.password} onChange={this.handleChange}/>\n                    </FormGroup>\n                    </Col>\n                    <Col>\n                        <Button variant=\"secondary\" onClick={this.handleSubmit}>Submit</Button>\n                    </Col>\n                </Form>\n               \n              </div>\n            </Container>);\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n    }\n}\n\nconst mapDispatchToProps = {\n    setCommunityId,\n    setViewId,\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(CommunityManager)\n/* export default CommunityManager; */\n","import React, { Component } from 'react';\nimport { Navbar, Nav, Button } from 'react-bootstrap';\nimport {Col, Form, FormGroup, Input} from 'reactstrap';\nimport { removeToken, apiUrl} from '../store/api.js'\nimport Axios from 'axios';\n\nclass TopNavbar extends Component {\n\n  constructor() {\n    super();\n\n    this.state={\n        loggedIn: sessionStorage.getItem('token') ? true: false,\n        userName: null,\n        token : sessionStorage.getItem('token'),\n        myViews : [],\n        viewId : sessionStorage.getItem('viewId') ? sessionStorage.getItem('viewId') : '',\n        viewTitle : sessionStorage.getItem(\"viewTitle\")? sessionStorage.getItem(\"viewTitle\") :'welcome',\n        communityId : sessionStorage.getItem('communityId'),\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentDidMount(){\n\n    //SET HEADER WITH TOKEN BEARER\n    var config = {\n      headers: { Authorization: `Bearer ${this.state.token}` }\n    };\n\n    // GET FULL NAME\n    /* HAVE A CONDITION WHEN USER IS LOGGED IN, THEN ONLY IT SHOWS THE NAME */\n    Axios.get(`${apiUrl}/users/me`, config)\n            .then(\n                result=>{\n                    this.setState({\n                        userName: result.data.firstName+ \" \"+ result.data.lastName,\n                     })\n\n                     sessionStorage.setItem(\"userId\", result.data._id);\n\n                    }).catch(\n                    error=>{\n                    });\n\n    //GET USER'S VIEWS\n    if(this.state.communityId){\n      var viewUrl= `${apiUrl}/communities/${this.state.communityId}/views`;\n\n      Axios.get(viewUrl, config)\n      .then(\n          result=>{\n            this.setState({\n              myViews: result.data\n            })\n          }).catch(\n              error=>{\n                  // alert(error);\n              });\n    }\n  }\n\n    logout(){\n        sessionStorage.removeItem('token');\n        removeToken()\n        var n = sessionStorage.length;\n        while(n--) {\n          var key = sessionStorage.key(n);\n          if(/foo/.test(key)) {\n      sessionStorage.removeItem(key);\n  }  \n}\n    }\n\n    handleChange(e) {\n      e.persist();\n      let target = e.target;\n      let value = target.value;\n\n      sessionStorage.setItem(\"viewId\", value);\n      \n      this.setState({\n        viewId: value,\n      });\n\n      var config = {\n        headers: { Authorization: `Bearer ${this.state.token}` }\n      };\n\n      var viewUrl= `${apiUrl}/objects/${target.value}`;\n\n      Axios.get(viewUrl, config)\n        .then(\n          result=>{\n            console.log(result.data);\n            \n               this.setState({\n                   viewTitle: result.data.title,\n                })\n                \n                sessionStorage.setItem(\"viewTitle\", result.data.title);\n              \n          }).catch(\n              error=>{\n                  alert(error);\n              });      \n  }\n\n    handleSubmit(e) {\n      e.preventDefault();\n      \n      console.log('The form was submitted with:');\n      console.log(this.state);\n    \n    }\n\n    render() {\n        return (\n            <Navbar bg=\"dark\" variant=\"dark\" fixed=\"top\">\n            <Navbar.Brand href=\"#community-manager\">KF6 Light</Navbar.Brand>\n            {this.state.loggedIn ? \n            (\n              <Nav className=\"mr-auto\">\n              <span className=\"mrg-105-top white\">{this.state.viewTitle}</span>\n              <Form onSubmit={this.handleSubmit} className=\"mrg-1-top\">\n                    <Col>\n                    <FormGroup>\n                    {/* <Label>Select Community</Label> */}\n                        <Input type=\"select\" name=\"viewId\" value={this.state.viewId} onChange={this.handleChange}>{\n                            this.state.myViews.map((obj) => {\n                                return <option key={obj._id} value={obj._id}> {obj.title} </option>\n                            })\n                        }</Input>\n                    </FormGroup>\n                    </Col>\n                </Form>\n            </Nav>\n            ):\n            (\n              <Nav className=\"mr-auto\">\n              <Nav.Link href=\"#signup\">Signup</Nav.Link>\n              <Nav.Link href=\"/\">Login</Nav.Link>\n            </Nav>\n            )}\n            \n            {this.state.loggedIn ? (\n              <>\n                <Nav.Link href=\"#change-password\"><i className=\"fas fa-cog white\"></i></Nav.Link>\n                <span className=\"white\"> {this.state.userName} </span>                \n                <Button variant=\"outline-secondary\" href=\"/\" onClick={this.logout}>Logout</Button>\n              </>\n            ):null}\n\n            </Navbar>\n        );\n    }\n}\n\nexport default TopNavbar;\n","import { createAction, createReducer } from '@reduxjs/toolkit';\n\nexport const openDialog = createAction('OPEN_DIALOG');\nexport const closeDialog = createAction('CLOSE_DIALOG');\nexport const openDrawDialog = createAction('OPEN_DRAW_DIALOG')\nexport const closeDrawDialog = createAction('CLOSE_DRAW_DIALOG')\nexport const focusDialog = createAction('FOCUS_DIALOG')\nexport const openAttachPanel = createAction('OPEN_ATTACH_PANEL')\nexport const closeAttachPanel = createAction('CLOSE_ATTACH_PANEL')\n\nlet dialogCounter= 0\nconst defaultZIndex = 1000\nconst focusedZindex = 1100\n//Dialog content\n// dialog = {id, noteId, title, content, confirmButton, zIndex}\nconst initState = { dialogs: [], drawTool: null, focused: null, attachPanel: {}};\nexport const dialogReducer = createReducer(initState, {\n    // actionCreator.toString() will automatically be called here\n    [openDialog] : (state, action) => {\n        //Unfocus previous focused dialog\n        const dlgs = state.dialogs.map(dlg => {\n            if (dlg.id === state.focused)\n                dlg.zIndex = defaultZIndex\n            return dlg\n        })\n        //Add new dialog\n        state.focused = dialogCounter\n        state.dialogs = [...dlgs, {id: dialogCounter++, zIndex: focusedZindex, ...action.payload}]\n        //Update index of focused\n        // state.dialogs.push({id: dialogCounter++, ...action.payload});\n    },\n\n    // Or, you can reference the .type field:\n    [closeDialog] : (state, action) => {\n        // console.log(state.dialogs)\n        state.dialogs = state.dialogs.filter((dlg) => dlg.id !== action.payload)\n    },\n\n    [openDrawDialog]: (state, action) => {\n        state.drawTool = action.payload;\n    },\n\n    [closeDrawDialog]: (state, action) => {\n        state.drawTool = null;\n    },\n\n    [openAttachPanel]: (state, action) => {\n        state.attachPanel = action.payload;\n    },\n\n    [closeAttachPanel]: (state, action) => {\n        state.attachPanel = {};\n    },\n\n    [focusDialog]: (state, action) => {\n        if (state.focused !== action.payload) {\n            state.dialogs = state.dialogs.map( dlg => {\n                if (dlg.id === state.focused)\n                    dlg.zIndex = defaultZIndex\n                else if (dlg.id === action.payload)\n                    dlg.zIndex = focusedZindex\n                return dlg\n            })\n            state.focused = action.payload\n        }\n    }\n});\n\n","import $ from 'jquery'\nimport {postLink, deleteLink} from './api.js'\n\n//Count words inside scaffold labels\nexport const scaffoldWordCount = (text) => {\n    const doc = '<div>' + text + '</div>';\n    const jq = $(doc); //convert to jquery dom element\n    let labels = jq.find('.kfSupportStartLabel')\n    let numwords = 0;\n    for (let i = 0; i< labels.length; i++){\n        numwords += labels[i].innerHTML.split(' ').length\n    }\n    return numwords\n}\n\nconst createScaffoldStartTag = (title, isTemplate) => {\n    let tag = '';\n    tag = tag + ' '; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span class=\"kfSupportStartMark\"> &nbsp; </span>';\n    } else {\n        tag = tag + '<span class=\"kfSupportStartMark kfTemplateStartMark\"> &nbsp; </span>';\n    }\n    tag = tag + ' '; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span class=\"kfSupportStartLabel\">' + title + '</span>';\n    } else {\n        tag = tag + '<span class=\"kfSupportStartLabel kfTemplateStartLabel\">' + title + '</span>';\n    }\n    tag = tag + ' '; //important for mce\n    return tag;\n};\n\nconst createScaffoldEndTag = (isTemplate) => {\n    let tag = '';\n    tag = tag + ' '; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span class=\"kfSupportEndMark\"> &nbsp; </span>';\n    } else {\n        tag = tag + '<span class=\"kfSupportEndMark kfTemplateEndMark\"> &nbsp; </span>';\n    }\n    tag = tag + ' '; //important for mce\n    return tag;\n};\n\nconst createReferenceTag = (contId, title, authors, text) => {\n    const authorText = '(missing authors)'//TODO $community.makeAuthorStringByIds(authors);\n    let tag = '';\n    if (text && text.length > 0) {\n        tag = tag + '<span class=\"KFReferenceQuote\"><span>\"</span><span class=\"KFReferenceText\">' + text + '</span><span>\"</span></span>';\n    }\n    tag = tag + '<span> (<a href=\"contribution/' + contId + '\" target=\"' + contId + '\">';\n    tag = tag + '<img src=\"/manual_assets/kf4images/icon-note-unread-othr-.gif\">\"' + title + '\"</a>';\n    tag = tag + '<span class=\"KFReferenceAuthor\"> by ' + authorText + '</span>)</span>';\n    tag = tag + '</span>';\n    return tag;\n};\n\nexport const preProcess = (body, toConnections, fromConnections) => {\n    const doc = '<div>' + body + '</div>';\n    const jq = $(doc);\n\n    const supportStart = jq.find('.KFSupportStart')\n    supportStart.addClass('mceNonEditable');\n    for (let i = 0; i < supportStart.length; i++) {\n        const elem = supportStart[i]\n        if (!elem.id.startsWith('supportid_')) {\n            const isTemplate = $(elem).hasClass('KFTemplateStart');\n            const ref = toConnections.filter((conn) => conn._id === elem.id)\n            if (ref.length) {\n                elem.innerHTML =createScaffoldStartTag(ref[0]._from.title, isTemplate);\n            } else {\n                if(toConnections !== 'Annotation'){\n                    elem.innerHTML = createScaffoldStartTag('(missing link)', isTemplate);\n                }\n            }\n        }\n    }\n    const supportEnd = jq.find('.KFSupportEnd')\n    supportEnd.addClass('mceNonEditable');\n    for (let i = 0; i < supportEnd.length; i++) {\n        const elem = supportEnd[i]\n        const isTemplate = $(elem).hasClass('KFTemplateEnd');\n        elem.innerHTML = createScaffoldEndTag(isTemplate);\n    }\n\n    const references = jq.find('.KFReference')\n    references.addClass('mceNonEditable');\n    for (let i = 0; i < references.length; i++) {\n        const elem = supportEnd[i]\n        let ref = fromConnections.filter((conn) => conn._id === elem.id)\n        if (ref.length) {\n            ref = ref[0]\n            let text = '';\n            if (ref.data) {\n                text = ref.data.text;\n            }\n            elem.innerHTML = createReferenceTag(ref.to, ref._to.title, ref._to.authors, text);\n        } else {\n            elem.innerHTML = createReferenceTag('', '(missing link)', '', '');\n        }\n    }\n    return jq.html();\n};\n\nexport const postProcess = async (text, contributionId, toConnections, fromConnections, handler) => {\n    const doc = '<div>' + text + '</div>';\n    const jq = $(doc); //convert to jquery dom element\n    const endtags = {};\n    const supportLinksIds = toConnections.filter((each) => each.type === 'supports')\n          .map((each) => each._id) //get only toConnections of type = supports\n    let supportStarts = jq.find('.KFSupportStart')\n    const supportEnds = jq.find('.KFSupportEnd')\n    const toCreate = []\n    const supportStartsIds = []\n\n    for (let i = 0; i < supportEnds.length; i++) {\n        const elem = supportEnds[i]\n        elem.innerHTML = '';\n        var id = elem.id;\n        endtags[id] = elem;\n    }\n    for (let i = 0; i < supportStarts.length; i++) {\n        const elem = supportStarts[i]\n        let supportId = elem.id;\n        elem.innerHTML = '';\n        if (supportId.startsWith('supportid_')) {\n            supportId = supportId.split('_')[1];\n        }\n        supportStartsIds.push(supportId)\n        if (!supportLinksIds.includes(supportId)) {//Is a new supportLink\n            //promise to create link\n            toCreate.push(postLink(supportId, contributionId, 'supports').then((link) => {\n                //Replace id with id of new created link\n                const oldId = elem.id;\n                const newId = link._id;\n                elem.id = newId;\n                if (endtags[oldId]) {\n                    endtags[oldId].id = newId;\n                }\n            }))\n        }\n    }\n    const toDeleteSupports = supportLinksIds.filter((each) => !supportStartsIds.includes(each))\n          .map((each) => deleteLink(each)) //Select toConnections that no longer appear in the tinymce text\n\n\n    const referenceLinksIds = fromConnections.filter((each) => each.type === 'references').map((each) => each._id) //get only ids of fromConnections of type=references\n    const kfReferences = jq.find('.KFReferenceText') //Get references dom elements\n    const kfreferenceIds = []\n\n    for (var i = 0; i < kfReferences.length; i++) {\n        const elem = kfReferences[i]\n        const data = {text:$(elem).find('.KFReferenceText').html()}\n        elem.innerHTML = '';\n        const referenceId = elem.id;\n        kfreferenceIds.push(referenceId)\n        if (!referenceLinksIds.includes(referenceId)) {//Is a new supportLink\n            //promise to create link\n            toCreate.push(postLink(contributionId, referenceId, 'references', data).then((link) => {\n                //Replace id with id of new created link\n                const oldId = elem.id;\n                const newId = link._id;\n                elem.id = newId;\n                if (endtags[oldId]) {\n                    endtags[oldId].id = newId;\n                }\n            }))\n        }\n    }\n\n    const toDeleteReferences = referenceLinksIds.filter((each) => !kfreferenceIds.includes(each)).map((each) => deleteLink(each)) //Select fromConnections that no longer appear in the tinymce text\n\n    await Promise.all(toDeleteSupports)\n    await Promise.all(toDeleteReferences)\n    await Promise.all(toCreate)\n    return jq\n}\n\n","import { store } from 'react-notifications-component';\n\nconst notifConfig = {\n    type: \"success\",\n    insert: \"top\",\n    container: \"top-right\",\n    animationIn: [\"animated\", \"fadeIn\"],\n    animationOut: [\"animated\", \"fadeOut\"],\n    dismiss: {\n        duration: 5000,\n        // onScreen: true\n    },\n}\nexport const addNotification = ( notif ) => {\n    return store.addNotification({...notifConfig, ...notif});\n}\n\nexport const removeNotification = (notifId) => {\n    store.removeNotification(notifId)\n}\n","import { createAction, createReducer } from '@reduxjs/toolkit';\nimport { openDialog, openDrawDialog, closeDialog } from './dialogReducer.js'\nimport { preProcess, postProcess } from './kftag.service.js'\nimport * as api from './api.js'\nimport { addNotification } from './notifier.js'\nimport { dateFormatOptions } from './globalsReducer.js'\n\nexport const addNote = createAction('ADD_NOTE')\nexport const removeNote = createAction('REMOVE_NOTE')\nexport const editNote = createAction('EDIT_NOTE')\nexport const addDrawing = createAction('ADD_DRAWING')\nexport const removeDrawing = createAction('REMOVE_DRAWING')\nexport const editSvg = createAction('EDIT_SVG')\nexport const addAttachment = createAction('ADD_ATTACHMENT')\nexport const removeAttachment = createAction('REMOVE_ATTACHMENT')\nexport const setAttachments = createAction('SET_ATTACHMENTS')\nexport const setWordCount = createAction('SET_WORDCOUNT')\nexport const setLinks = createAction('SET_CONNECTIONS')\nexport const setRecords = createAction('SET_RECORDS')\nexport const removeContribAuthor = createAction('REMOVE_CONTRIB_AUTHOR')\nexport const addContribAuthor = createAction('ADD_CONTRIB_AUTHOR')\nexport const setAnnotation = createAction('SET_ANNOTATION')\nexport const setAnnotationsLoaded = createAction('SET_ANNOTATIONS_LOADED')\nexport const removeAnnotation = createAction('REMOVE_ANNOTATION')\n\nconst initState = {drawing: '', attachments: {}}\n\nexport const noteReducer = createReducer(initState, {\n    [addNote]: (notes, action) => {\n        notes[action.payload._id] = action.payload\n    },\n    [removeNote]: (notes, action) => {\n        delete notes[action.payload]\n    },\n    [editNote]: (notes, action) => {\n        let note = notes[action.payload._id];\n        notes[action.payload._id] = Object.assign({}, note, action.payload)\n    },\n    [addDrawing]: (notes, action) => {\n        notes.drawing = action.payload\n    },\n    [removeDrawing]: (notes, action) => {\n        notes.drawing = '';\n    },\n    [editSvg]: (notes, action) => {\n        notes[action.payload.noteId].editSvg = action.payload.svg\n    },\n    [addAttachment]: (state, action) => {\n        let note = state[action.payload.noteId]\n        note.attachments.push(action.payload.attachment._id)\n        state.attachments[action.payload.attachment._id] = action.payload.attachment\n    },\n    [removeAttachment]: (notes, action) => {\n        let note = notes[action.payload.noteId]\n        note.attachments = note.attachments.filter((att) => att.id !== action.payload.attId)\n    },\n    [setAttachments]: (state, action) => {\n        let note = state[action.payload.contribId]\n        note.attachments = action.payload.attachments.map((att)=> att._id)\n        action.payload.attachments.forEach((att) => {\n            state.attachments[att._id] = att\n        })\n    },\n    [setWordCount]: (state, action) => {\n        let note = state[action.payload.contribId]\n        note.wordCount = action.payload.wc\n    },\n    [setLinks]: (state, action) => {\n        let contrib = state[action.payload.contribId]\n        if (action.payload.direction === 'from'){\n            contrib.fromLinks = action.payload.links\n        }else{\n            contrib.toLinks = action.payload.links\n        }\n    },\n    [setRecords]: (state, action) => {\n        let note = state[action.payload.contribId]\n        note.records = action.payload.records\n    },\n    [addContribAuthor]: (state, action) => {\n        let contrib = state[action.payload.contribId]\n        contrib.authors = [...contrib.authors, action.payload.author]\n    },\n    [removeContribAuthor]: (state, action) => {\n        let contrib = state[action.payload.contribId]\n        contrib.authors = contrib.authors.filter((auth) => auth !== action.payload.author)\n    },\n    [setAnnotation]: (state, action) => {\n        let contrib = state[action.payload.contribId]\n        contrib.annos[action.payload.annotation._id] = action.payload.annotation\n    },\n    [setAnnotationsLoaded]: (state, action) => {\n        let contrib = state[action.payload.contribId]\n        contrib['annotsFetched'] = action.payload.value\n    },\n    [removeAnnotation]: (state, action) => {\n        let contrib = state[action.payload.contribId]\n        delete contrib.annos[action.payload.annoId]\n    },\n});\n\nconst createNote = (communityId, authorId, contextMode, fromId, content) => {\n    if (!content){ content = ''}\n    if (contextMode && !contextMode.permission){\n        window.alert('invalid mode object')\n        return\n    }\n    let mode = {}\n    if (contextMode && contextMode.permission === 'private'){\n        mode.permission = contextMode.permission;\n        mode.group = contextMode.group;\n        mode._groupMembers = contextMode._groupMembers;\n    } else {\n        mode.permission = 'protected';\n        mode.group = undefined;\n        mode._groupMembers = [];\n    }\n    let title = contextMode && contextMode.title ? contextMode.title : '';\n    let status = contextMode && contextMode.status ? contextMode.status : 'unsaved';\n\n    const newobj = {\n        communityId: communityId,\n        type: 'Note',\n        title: title,\n        /* 6.6 the default title was changed to blank by Christian */\n        authors: [authorId],\n        status: status,\n        permission: mode.permission,\n        group: mode.group,\n        _groupMembers: mode._groupMembers,\n        data: {\n            body: contextMode && contextMode.body ? contextMode.body : ''\n        },\n        buildson: fromId,\n        langInNote: []\n\n    }\n\n    //save google document id, createdBy and coauthors, current doc permission granted\n    if (contextMode && contextMode.docId) {\n        newobj.docId = contextMode.docId;\n        var myself = newobj.authors[0];\n        if (contextMode.coauthors) {\n            var ca = contextMode.coauthors.split(',');\n            for (var i = 0; i < ca.length; i++) {\n                if (ca[i] !== myself) {\n                    newobj.authors.push(ca[i]);\n                }\n            }\n        }\n        if (contextMode.createdBy) {\n            newobj.createdBy = contextMode.createdBy;\n        }\n        newobj.docShared = [myself];\n        newobj.text4search = contextMode.text4search;\n    }\n\n    return newobj\n}\n\nexport const newNote = (view, communityId, authorId) => dispatch => {\n    const mode = {permission: view.permission, group: view.group, _groupMembers: view._groupMembers }\n\n    const newN = sessionStorage.getItem(\"buildOn\") === null ? createNote(communityId, authorId, mode) : // IF IT'S A BUILDON, THEN CREATE BUILDON LINK\n    {\n            \"authors\" : authorId,\n            \"buildson\" : sessionStorage.getItem(\"buildOn\"),\n            \"communityId\" : communityId,\n            data : {\n                \"body\" : \"\",\n            },\n            \"permission\" : view.permission,\n            \"status\": \"unsaved\",\n            \"title\": \"\",\n            \"type\": \"Note\",\n            \"_groupMembers\": [],\n    };\n    if(newN){sessionStorage.removeItem(\"buildOn\")};\n\n    return api.postContribution(communityId, newN).then((res) => {\n        const note = {attachments: [],\n                      fromLinks:[],\n                      toLinks:[],\n                      records: [],\n                      annos: {},\n                      group: null,\n                      ...res.data}\n        const pos = {x: 100, y:100}\n        api.postLink(view._id, note._id, 'contains', pos)\n\n        //TODO saveContainsLinktoITM x2\n\n        dispatch(addNote(note))\n\n        dispatch(openDialog({title: 'New Note',\n                             confirmButton: 'create',\n                             noteId: note._id,\n                            }))\n    })\n\n}\n\nexport const editSvgDialog = (noteId, svg) => dispatch => {\n    dispatch(editSvg({noteId, svg}))\n    dispatch(openDrawDialog(noteId))\n}\n\nexport const attachmentUploaded = (noteId, attachment, inline, x, y) => dispatch => {\n\n    return api.postLink(noteId, attachment._id, 'attach').then((res) => {\n\n        // TODO dispatch(getLinksFrom(noteId))\n        dispatch(addAttachment({noteId, attachment}))\n\n    });\n}\n\nexport const fetchAttachments = (contribId) => async dispatch => {\n    const link_atts = await api.getLinks(contribId, 'from', 'attach')\n    const attachments = await Promise.all(link_atts.map((attach) => api.getObject(attach.to)))\n    dispatch(setAttachments({contribId, attachments}))\n}\n\nexport const postContribution = (contribId, dialogId) => async (dispatch, getState) => {\n    const state = getState()\n    let contrib = state.notes[contribId]\n    contrib = Object.assign({}, contrib)\n    contrib.data = Object.assign({}, contrib.data)\n    if (!contrib.title){\n        addNotification({title: 'Error Saving Note!', type:'danger', message:'Title is required'})\n        return\n    }\n    //TODO sync checking?\n    //TODO status.contribution = 'saving'\n    if (contrib.type === 'Note') {\n        // TODO if isGoogleDoc\n        // const isNewNote = contrib.status === 'unsaved'\n        contrib.status = 'active'\n        const jq = await postProcess(contrib.data.body, contrib._id, contrib.toLinks, contrib.fromLinks)\n        dispatch(fetchLinks(contribId, 'from'))\n        dispatch(fetchLinks(contribId, 'to'))\n\n        const text = jq.html()\n        contrib.data.body = text\n        const newNote = await api.putObject(contrib, contrib.communityId, contrib._id)\n        dispatch(editNote(newNote))\n\n        if (dialogId !== undefined)\n            dispatch(closeDialog(dialogId))\n        addNotification({title: 'Saved!', type:'success', message:'Contribution created!'})\n    }\n}\n\nexport const fetchLinks = (contribId, direction) => async (dispatch) => {\n    const links = await api.getLinks(contribId, direction)\n    dispatch(setLinks({contribId, direction, links}))\n}\n\nexport const fetchRecords = (contribId) => async (dispatch, getState) => {\n    const authors = getState().users\n    const records = await api.getRecords(contribId)\n    const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\n    records.forEach((record) => {\n        if (authors[record.authorId]){\n            const author =  authors[record.authorId]\n            record['author'] = `${author.firstName} ${author.lastName}`\n        }else{\n            record['author'] = 'NA'\n        }\n        record['date'] = formatter.format(new Date(record.timestamp))\n    })\n    dispatch(setRecords({contribId, records}))\n}\n\nexport const openContribution = (contribId) => async (dispatch, getState) => {\n\n    const [contrib, fromLinks, toLinks] = await Promise.all([api.getObject(contribId),\n                                                            api.getLinks(contribId, 'from'),\n                                                            api.getLinks(contribId, 'to')])\n\n    const note = {attachments: [], fromLinks, toLinks, records: [], annos: {}, ...contrib}\n    const noteBody = preProcess(note.data.body, toLinks, fromLinks)\n    note.data.body = noteBody\n    dispatch(addNote(note))\n    dispatch(fetchAttachments(contribId))\n    dispatch(openDialog({title: 'Edit Note',\n                         confirmButton: 'edit',\n                         noteId: note._id,\n                        }))\n    //annotations\n    const annoLinks = toLinks.filter((link) => link.type === 'annotates')\n\n    const annotations = await Promise.all(\n        annoLinks.map((annLink) =>\n            api.getObject(annLink.from).then(anno => {\n                anno.data.linkId = annLink._id\n                anno.data.modelId = anno._id\n                return anno\n            })\n        )\n    )\n\n    annotations.forEach((annot) => dispatch(setAnnotation({annotation: annot, contribId})) )\n    dispatch(setAnnotationsLoaded({contribId, value: 1}))\n\n    if (note.status === 'active'){\n         api.read(note.communityId, note._id)\n    }\n}\n\nexport const createAnnotation = (communityId, contribId, authorId, annotation) => async (dispatch) => {\n    const newobj = {\n        communityId: communityId,\n        type: 'Annotation',\n        title: 'an Annotation',\n        authors: [authorId],\n        status: 'active',\n        permission: 'private',\n        data: annotation\n    };\n    const ann = await api.postContribObject(communityId, newobj)\n\n    const link = await api.postLink(ann._id, contribId, 'annotates')\n\n    annotation.linkId = link._id;\n    annotation.modelId = ann._id;\n    dispatch(setAnnotation({contribId, annotation: ann}))\n    // TODO save in store link\n    // $scope.annoLinks[link._id] = link;\n}\n\nexport const deleteAnnotation = (linkId, contribId, annoId) => async (dispatch) => {\n    await api.deleteLink(linkId)\n    return dispatch(removeAnnotation({contribId, annoId}))\n}\n\nexport const modifyAnnotation = (annotation, communityId, contribId) => async (dispatch) => {\n    const anno_updated = await api.putObject(annotation, communityId, annotation._id )\n    return dispatch(setAnnotation({contribId, annotation: anno_updated}))\n}\n\n","import React from 'react';\nimport {Rnd} from 'react-rnd';\nimport {Card, Button} from 'react-bootstrap';\nimport './dialog.css';\nconst dialog_style = {\n    zIndex: 999,\n    display: 'flex'\n}\n\nconst Dialog = props => {\n    return (\n            <Rnd\n                id={`contrib-dialog-${props.id}`}\n                className={\"contrib-dialog\"}\n                style={{...dialog_style, ...props.style}}\n                default={{\n                    x: 400 + window.pageXOffset,\n                    y: 50 + window.pageYOffset,\n                    width: 920,\n                    height: 500,\n                }}\n                onClick={props.onClick}\n                onMouseDown={props.onMouseDown}\n                dragHandleClassName='dlg-card-header'\n                bounds='window'\n            >\n                <Card className='dlg-card'>\n                    <Card.Header className='dlg-card-header py-0' style={{alignItems: 'center', display: 'flex'}}>\n                        <span>{props.title}</span>\n                        <Button onClick={props.onClose} variant='link' size='sm' style={{marginLeft:'auto'}}>x</Button>\n                    </Card.Header>\n                    <Card.Body className='dlg-card-body'>\n                        {props.children}\n                    </Card.Body>\n                    <Card.Footer className=\"dlg-card-footer py-0\">\n                        <Button size='sm' className=\"dlg-confirm-button\"\n                            onClick={props.onConfirm}\n                        >\n                            {props.confirmButton}\n                        </Button>\n                    </Card.Footer>\n                </Card>\n            </Rnd>\n    )\n}\n\nexport default Dialog;\n","import React from 'react';\nimport { Editor } from '@tinymce/tinymce-react';\n/* import './editor.css' */\n\nclass MCEditor extends React.Component {\n\n    render() {\n        return (\n            <div>\n                <Editor\n                    value={this.props.value}\n                    apiKey=\"arg05azt52qbujpnf831szuswhmyhoqute0q48btk5bqigoj\"\n                    init={{\n                        setup: (editor) => {this.props.onEditorSetup(editor)},\n                        content_css: './editor.css',\n                        height: 300,\n                        menubar: false,\n                        statusbar: false,\n                        media_live_embeds: true,\n                        plugins: [\n                            'advlist autolink lists link image charmap print preview anchor',\n                            'searchreplace visualblocks code fullscreen',\n                            'insertdatetime media table paste code wordcount media help'\n                        ],\n                        external_plugins: {\n                            'drawingTool': '/drawing-tool/plugin.min.js'\n                        },\n                        toolbar: 'styleselect | bold italic underline strikethrough | forecolor backcolor bullist numlist | link code | ltr rtl | charmap | drawingTool media'\n                    }}\n                    onEditorChange={this.props.onEditorChange}\n                />\n            </div>\n        );\n    }\n}\n\nexport default MCEditor;\n","import React, {useState} from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Modal, Button, Form, ProgressBar} from 'react-bootstrap'\nimport { fetchAttachments } from '../../store/noteReducer.js'\nimport { FileDrop } from 'react-file-drop';\nimport {url as serverUrl} from '../../store/api.js'\nimport './AttachPanel.css'\n\nimport {postAttachment, uploadFile, putObject, postLink} from '../../store/api.js'\n\n//TODO if dropping files is not supported\nconst AttachPanel = props => {\n    const author = useSelector(state => state.globals.author);\n    const dispatch = useDispatch();\n    const [progress, setProgress] = useState(0);\n\n    const  handleClose= (e) => {\n        props.onClose();\n    }\n    const onFileChange = (e) => {\n        onFileSelect(e.target.files);\n        // TODO After upload, clear input\n        /* e.target.value = null; */\n\n    }\n    const onFileSelect = (fileList) => {\n        const files = Array.from(fileList)\n        setProgress(0)\n        /* const hasVideo = files.some((file) => file.type.indexOf('video') === 0); */\n        // TODO googleOauth, googledrive\n        files.forEach((file) => {\n            if (file.type.indexOf(\"image/\") >= 0){\n                const _URL = window.URL || window.webkitURL;\n                const img = document.createElement(\"img\");\n                img.onload = function() {\n                    var width  = img.naturalWidth  || img.width;\n                    var height = img.naturalHeight || img.height;\n                    file.width = width;\n                    file.height = height;\n                    createAttachment(file, 'image');\n                };\n                img.src = _URL.createObjectURL(file);\n            }else if (file.type.startsWith('video')){\n                createAttachment(file, 'video')\n            }else{\n                createAttachment(file, 'link')\n            }\n        });\n    }\n\n    const createAttachment = async (file, type) => {\n        try {\n            const attachRes = await postAttachment(author.communityId, author._id)\n            const uploadRes = await uploadFile(file, onUploadProgress)\n            const attachment = attachRes.data\n            const data = uploadRes.data\n            attachment.title = data.filename;\n            attachment.status = 'active';\n            data.version = attachment.data.version + 1;\n            attachment.data = data;\n            attachment.tmpFilename = data.tmpFilename;\n            const newAttachment = await putObject(attachment, author.communityId, attachment._id)\n\n            newAttachment.data.width = file.width;\n            newAttachment.data.height = file.height;\n\n\n            await postLink(props.noteId, attachment._id, 'attach')\n            //TODO updateFromConnections\n            if (props.inlineAttach){\n                const data_mce_src = `${serverUrl}${newAttachment.data.url}`;\n                const title = newAttachment.title;\n                let html = '';\n                if (type==='image') {\n                    html = '<img class=\"inline-attachment ' + attachment._id + '\" src=\"' + data_mce_src +'\" width=\"100px\" alt=\"' + title + '\" data-mce-src=\"' + data_mce_src + '\">';\n                } else if (type==='video') {\n                    html = `<video controls=\"controls\" width=\"300\" height=\"150\"> <source src=\"${data_mce_src}\" type=\"video/mp4\" /></video>`\n                } else {\n                    html ='<a class=\"inline-attachment ' + attachment._id + '\" href=\"' + data_mce_src + '\" target=\"_blank\" download>';\n                    html += `<img src=\"${serverUrl}/manual_assets/kf6images/03-toolbar-attachment.png\" alt=\"` + title + '\">' + title + '</a>';\n                }\n                props.onNewInlineAttach(html)\n            } else {\n                dispatch(fetchAttachments(props.noteId))\n            }\n\n            //TODO googledrive\n            /* if(newAttachment.data.type.indexOf('video') === 0 && $community.isPluginEnabled('googledrive')){\n             *     $scope.save2GoogleDrive(userName, newAttachment);\n             * } */\n        } catch (err) {\n            console.log(err)\n        } finally {\n\n        }\n\n    }\n\n    const onUploadProgress = (progressEvent) => {\n        const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total)\n        setProgress(percentCompleted)\n    }\n\n    const styles = { width: '100%', color: 'black' };\n    return (\n        <Modal show={props.attachPanel} onHide={handleClose}>\n            <Modal.Header closeButton>\n                <Modal.Title>Insert Attachment File</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n                <Form.File id=\"custom-file\">\n                    <Form.File.Input onChange={onFileChange}/>\n                </Form.File>\n                <div style={styles}>\n                    <FileDrop\n                        onFrameDragEnter={(event) => console.log('onFrameDragEnter', event)}\n                        onFrameDragLeave={(event) => console.log('onFrameDragLeave', event)}\n                        onFrameDrop={(event) => console.log('onFrameDrop', event)}\n                        onDragOver={(event) => console.log('onDragOver', event)}\n                        onDragLeave={(event) => console.log('onDragLeave', event)}\n                        onDrop={(files, event) => onFileSelect(files)}\n                    >\n                        or drop some files here!\n                    </FileDrop>\n                </div>\n                <ProgressBar now={progress} />\n            </Modal.Body>\n            <Modal.Footer>\n                <Button variant=\"primary\" onClick={handleClose}>\n                    Close\n                </Button>\n            </Modal.Footer>\n        </Modal>\n    )\n\n};\n\nexport default AttachPanel;\n","import { createAction, createReducer } from '@reduxjs/toolkit';\nimport * as api from './api.js'\n\nexport const requestScaffold = createAction('REQUEST_SCAFFOLD')\nexport const receiveScaffold= createAction('RECEIVE_SCAFFOLD')\n\nconst initState = {isFetching: false,\n                   items: [],\n                   fetched: false,\n                  }\n\nexport const scaffoldReducer = createReducer(initState, {\n    [receiveScaffold]: (state, action) => {\n        state.items = action.payload\n        state.isFetching = false\n        state.fetched = true\n    },\n    [requestScaffold]: (state, action) => {\n        state.isFetching = true\n    }\n});\n\nexport const fetchScaffolds = (communityId, contextId) => {\n    return dispatch => {\n        dispatch(requestScaffold)\n\n        let scaffold_promise = api.getCommunity(communityId).then( res => {\n            return Promise.all(res.data.scaffolds.map((scaffoldId) => {\n                return api.getObject(scaffoldId);\n            }));\n        });\n\n        return Promise.all([scaffold_promise, api.getLinks(contextId, 'from', 'uses')]).then(async res =>{\n            let links = res[1].map((link) => link.to);\n            let scaffolds = res[0].filter((el) => links.includes(el._id));\n            /* const scaffolds = this.state.scaffolds; */\n            let supports = await Promise.all(scaffolds.map((el) => api.getLinks(el._id, 'from')));\n            scaffolds = scaffolds.map((scaffold, i) => {\n                scaffold.supports = supports[i];\n                return scaffold;\n            })\n\n            dispatch(receiveScaffold(scaffolds))\n        });\n    }\n}\n","\nconst newScaffoldTag = (supportId, title, isTemplate, addHyphen) => (initText) => {\n\n    let supportContentId = new Date().getTime().toString();\n    var contentTagStr = '<span id=\"' + supportContentId + '\"></span>';\n    var text = contentTagStr + initText;\n    if (addHyphen) {\n        text = ' -&nbsp;' + text + '&nbsp;- ';\n    }\n\n    var tag = '';\n    tag = tag + '<br>';\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart mceNonEditable\">';\n    } else {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart KFTemplateStart mceNonEditable\">';\n    }\n    tag = tag + createScaffoldStartTag(title, isTemplate);\n    tag = tag + '</span>';\n    if (isTemplate) {\n        tag = tag + '<p class=\"kfTemplateContent\">';\n        tag = tag + '<br><br><br><br>';\n    }\n    tag = tag + text;\n    if (isTemplate) {\n        tag = tag + '</p>';\n    }\n    if (!isTemplate) {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd mceNonEditable\">';\n    } else {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd KFTemplateEnd mceNonEditable\">';\n    }\n    tag = tag + createScaffoldEndTag(isTemplate);\n    tag = tag + '</span>';\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\n    tag = tag + '<br>';\n    return {tag, supportContentId};\n};\n\nconst createNewScaffoldTag = function(supportId, title, text, isTemplate) {\n    var tag = '';\n    tag = tag + '<br>';\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart mceNonEditable\">';\n    } else {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportStart KFTemplateStart mceNonEditable\">';\n    }\n    tag = tag + createScaffoldStartTag(title, isTemplate);\n    tag = tag + '</span>';\n    if (isTemplate) {\n        tag = tag + '<p class=\"kfTemplateContent\">';\n        tag = tag + '<br><br><br><br>';\n    }\n    tag = tag + text;\n    if (isTemplate) {\n        tag = tag + '</p>';\n    }\n    if (!isTemplate) {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd mceNonEditable\">';\n    } else {\n        tag = tag + '<span id=\"' + supportId + '\" class=\"KFSupportEnd KFTemplateEnd mceNonEditable\">';\n    }\n    tag = tag + createScaffoldEndTag(isTemplate);\n    tag = tag + '</span>';\n    tag = tag + '&nbsp;&nbsp;'; //important for mce\n    tag = tag + '<br>';\n    return tag;\n};\n\n\nconst createScaffoldStartTag = function(title, isTemplate) {\n    var tag = '';\n    tag = tag + ' '; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span class=\"kfSupportStartMark\"> &nbsp; </span>';\n    } else {\n        tag = tag + '<span class=\"kfSupportStartMark kfTemplateStartMark\"> &nbsp; </span>';\n    }\n    tag = tag + ' '; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span class=\"kfSupportStartLabel\">' + title + '</span>';\n    } else {\n        tag = tag + '<span class=\"kfSupportStartLabel kfTemplateStartLabel\">' + title + '</span>';\n    }\n    tag = tag + ' '; //important for mce\n    return tag;\n};\n\nconst createScaffoldEndTag = function(isTemplate) {\n    var tag = '';\n    tag = tag + ' '; //important for mce\n    if (!isTemplate) {\n        tag = tag + '<span class=\"kfSupportEndMark\"> &nbsp; </span>';\n    } else {\n        tag = tag + '<span class=\"kfSupportEndMark kfTemplateEndMark\"> &nbsp; </span>';\n    }\n    tag = tag + ' '; //important for mce\n    return tag;\n};\n\nexport default { createNewScaffoldTag, newScaffoldTag }\n","import React from 'react';\nimport {Form, Container, Row, Col} from 'react-bootstrap';\nimport { connect } from 'react-redux'\nimport {fetchScaffolds} from '../../store/scaffoldReducer.js'\nimport scaffoldService from './scaffold.service'\nimport './scaffold.css'\n\nclass ScaffoldSelect extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {selected: props.initVal};\n        this.onSelectChange = this.onSelectChange.bind(this);\n    }\n\n\n    componentDidMount() {\n        if (!this.props.fetched){\n            const {communityId, contextId} = this.props;\n            this.props.fetchScaffolds(communityId, contextId);\n        }\n    }\n\n    onSelectChange(event) {\n        this.setState({selected: event.target.value});\n    }\n\n    scaffoldSelected = (scaffoldId, support) => {\n        const scaffold = this.props.items[scaffoldId];\n        let addhyphen = true;\n        let initialText = '';\n        const isTemplate = scaffold.data && scaffold.data.isTemplate\n        if (isTemplate) {\n            addhyphen = false;\n            initialText = '<br><br>'\n        }\n\n        const scaffold_text = support._to.title\n        const tagCreator = scaffoldService.newScaffoldTag(support.to, scaffold_text, isTemplate, addhyphen);\n        this.props.onScaffoldSelected(tagCreator, initialText)\n    }\n\n    render() {\n        const scaffolds = this.props.items;\n        const options = scaffolds.map((scaffold, i) =>\n            <option key={i} value={i}>{scaffold.title}</option>\n        );\n        let supports = '';\n        if (scaffolds.length && scaffolds[this.state.selected].supports) {\n            supports = scaffolds[this.state.selected].supports.map((support, i) =>\n                <Col className=\"mt-1 p-0\" key={i} md={12}>\n                    <div className='KFSupportButton' size='sm' onClick={() => this.scaffoldSelected(this.state.selected, support) }>\n                        {support._to.title}\n                    </div>\n                </Col>\n            );\n        }\n\n        return (\n            <Container>\n                <Row>\n                    <Col className='p-0'>\n                        <Form>\n                            <Form.Group className='mb-1' controlId=\"exampleForm.ControlSelect2\">\n                                <Form.Control size='sm' as=\"select\" onChange={this.onSelectChange}>\n                                    {options}\n                                </Form.Control>\n                            </Form.Group>\n                        </Form>\n                    </Col>\n                </Row>\n                <Row>\n                    {supports}\n                </Row>\n            </Container>\n\n        );\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n        communityId: state.globals.communityId,\n        contextId: state.globals.contextId,\n        ...state.scaffolds\n    }\n}\n\nconst mapDispatchToProps = { fetchScaffolds }\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(ScaffoldSelect)\n","import React, {useState} from 'react';\nimport {useSelector} from 'react-redux'\nimport { Row, Col, Button} from 'react-bootstrap'\nimport {url as serverUrl} from '../../store/api'\nimport './attachArea.css'\n\nconst AttachArea = props => {\n\n    const attachments = useSelector(state => {\n        return props.attachments.map((attId) => state.notes.attachments[attId])\n    })\n    const [selectedImgs, setSelectedImgs] = useState([])\n    const getFileNameString = (name) => {\n       return name\n    }\n\n    const getFileSizeString = (size) => {\n        return size\n    }\n\n    const addImages = () => {\n        console.log(\"Add images\")\n        const  selectedImgs = Array.from(document.getElementById(`attachbox-${props.noteId}`).getElementsByClassName(\"selected\"))\n        if (selectedImgs.length === 0) {\n            return;\n        }\n        let html = \"\";\n        const maxWidth = 200;\n        console.log(selectedImgs)\n        selectedImgs.forEach((img) => {\n            const tagName = img.tagName;\n            let width = img.naturalWidth;\n            if(width > maxWidth){\n                width = maxWidth;\n            }\n            if (tagName === 'IMG') {\n                const data_mce_src = img.getAttribute(\"src\");\n                let className = '';\n                img.classList.forEach(cls_name => {\n                    if (cls_name.length === 24) { //Find 24 char long classes, one of them might be MongoDB id\n                        className += cls_name + ' ';\n                    }\n                })\n                html += '<img class=\"inline-attachment ' + className + '\" src=\"' + data_mce_src + '\" width=\"' + width + 'px\" alt=\"\" data-mce-src=\"' + data_mce_src + '\">';\n            }\n\n        })\n        props.onNewInlineAttach(html)\n\n    }\n    const selectedImg = (attId, e) => {\n        if (selectedImgs.includes(attId)){\n            setSelectedImgs((imgs) => imgs.filter( img => img !== attId))\n        }else{\n            setSelectedImgs((imgs) => [...imgs, attId])\n        }\n    }\n    const deleteAttachment = () => {}\n    return (\n        <Col>\n            <Row>\n                <Col>\n                    <span className=''>Insert image or file: </span>\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={()=> props.onNewAttachClick(true)}>Inline</Button>\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={()=>props.onNewAttachClick(false)}>As an attachment</Button>\n                    <Button className='attach-button mx-2' size='sm' variant='outline-dark' onClick={addImages} disabled={selectedImgs.length === 0}>Insert</Button>\n                </Col>\n            </Row>\n            <Row id={`attachbox-${props.noteId}`} className='attachment-box'>\n                {\n                    attachments.map((attachment) => (\n                            <div key={attachment._id} className=\"attachment-inner-box col-auto\">\n                                <div className=\"attachment-thumbnail\">\n                                    {\n                                        attachment.data.type.indexOf('image/') === 0 ?\n                                        <img className={attachment._id + \" \" + (selectedImgs.includes(attachment._id) ? 'selected' : '')} src={`${serverUrl}${attachment.data.url}`} onClick={(e) => selectedImg(attachment._id, e)} alt='attachment'/>\n                                        :\n                                        <a href={`${serverUrl}${(attachment.data.downloadUrl || attachment.data.url)}`} title={attachment.title} download>\n                                            <img className={attachment._id} src={`${serverUrl}/manual_assets/kf6images/03-toolbar-attachment.png`}\n                                                 title=\"{attachment.title}\" alt='attachment' />\n                                        </a>\n                                    }\n                                </div>\n                                <div className=\"attachment-buttons\">\n                                    <p>\n                                        <a href={`${serverUrl}${(attachment.data.downloadUrl || attachment.data.url)}`}\n                                           title={attachment.title} download>\n                                            <img className=\"download-attachment\" src={`${serverUrl}/manual_assets/kf6images/cloud-download-2x.png`}\n                                                 alt=\"Download\" height=\"15px\" />\n                                        </a>\n                                    </p>\n                                    <p>\n                                        <button className=\"delete-attachment\" onClick={deleteAttachment}>\n                                            <img src={`${serverUrl}/manual_assets/kf6images/trash.png`} alt='Delete attachment' width=\"10px\" height=\"15px\"/>\n                                        </button>\n                                    </p>\n                                </div>\n                                <div className=\"attachment-info\">\n                                    <p title=\"{attachment.title}\">{getFileNameString(attachment.title)}</p>\n                                    <p>{getFileSizeString(attachment.data.size)}</p>\n                                </div>\n                            </div>\n                ))\n                }\n            </Row>\n        </Col>\n    )\n\n};\n\nexport default AttachArea;\n","import React from 'react';\nimport MCEditor from '../editor/MCEditor'\nimport AttachPanel from '../attachmentCollapse/AttachPanel.js'\nimport {Container, Row, Col, Form} from 'react-bootstrap'\nimport ScaffoldSelect from '../scaffold/ScaffoldSelect'\nimport AttachArea from '../attachmentArea/AttachArea.js'\n\nimport './WriteTab.css';\nclass WriteTab extends React.Component {\n\n    constructor(props){\n        super(props)\n        this.state = {inlineAttach: true, attachPanel: false}\n        this.onScaffoldSelected = this.onScaffoldSelected.bind(this);\n        this.onNewAttachmentClick = this.onNewAttachmentClick.bind(this);\n        this.closeAttachPanel = this.closeAttachPanel.bind(this);\n        this.onNewInlineAttach = this.onNewInlineAttach.bind(this);\n    }\n\n    onScaffoldSelected(tagCreator, initialText){\n        this.props.onChange({scaffold: {tagCreator, initialText}})\n    }\n\n    onNewAttachmentClick(inline){\n        this.setState({inlineAttach: inline, attachPanel: true})\n    }\n    onNewInlineAttach(inlineAttach) {\n        this.props.onChange({attach: inlineAttach})\n    }\n    closeAttachPanel()  {\n        this.setState({attachPanel: false})\n    }\n    render() {\n        const {note, onChange, onEditorSetup} = this.props;\n        return (\n            <Container className='write-container p-0'>\n                    <Row>\n                        <Col>\n                            <Form.Group controlId=\"note-title\">\n                                <Form.Control type=\"text\"\n                                              size=\"sm\"\n                                              placeholder=\"Enter title\"\n                                              value={note.title}\n                                              onChange={(val) => {onChange({title: val.target.value})}}/>\n                            </Form.Group>\n                        </Col>\n                    </Row>\n                    <Row>\n                        <Col md={2} className='pr-0'>\n                            <ScaffoldSelect initVal={0} onScaffoldSelected={this.onScaffoldSelected}/>\n                        </Col>\n                        <Col md={10}>\n                            <MCEditor value={note.data.body}\n                                      onEditorSetup={onEditorSetup}\n                                      onEditorChange={(content, editor) => onChange({ data: {body: content}})}/>\n                            <div className='wordcount-bar text-right'>{note.wordCount} words</div>\n\n                        </Col>\n                    </Row>\n                    <Row className='mt-2'>\n                        <AttachPanel noteId={note._id} onClose={this.closeAttachPanel} onNewInlineAttach={this.onNewInlineAttach} {...this.state}></AttachPanel>\n                        <AttachArea\n                            noteId={note._id}\n                            attachments={note.attachments}\n                            onNewAttachClick={this.onNewAttachmentClick}\n                            onNewInlineAttach={this.onNewInlineAttach}\n                        >\n                        </AttachArea>\n                    </Row>\n            </Container>\n        )\n    }\n}\n\nexport default WriteTab;\n","import React from 'react';\n\nconst History = props => {\n\n    const [read, edit] = props.records.reduce(\n        (acc, el) => {\n            if (el.type === 'read') {\n                acc[0].push(el)\n            }else{\n                acc[1].push(el)\n            }\n            return acc\n        }, [[],[]])\n    return (\n        <div>\n            <h5>Edit logs:</h5>\n            <p className='mb-0'>{edit.length} edits</p>\n            <ul>\n                {edit.map((record) =>\n                    <li key={record._id}>{record.date}: {record.author}</li>\n                )}\n            </ul>\n            <h5>Read logs:</h5>\n            <p className='mb-0'>{read.length} reads</p>\n            <ul>\n                {read.map((record) =>\n                    <li key={record._id}>{record.date}: {record.author}</li>\n                )}\n            </ul>\n        </div>\n    )\n\n}\n\nexport default History\n","import React from 'react';\n\nconst Properties = props => {\n\n    const onPermissionChange = (evt) => {\n        props.onChange({permission: evt.target.value})\n    }\n    //TODO\n    const isTemplateChange = (evt) => {\n        props.onChange({data: {isTemplate: evt.target.checked}})\n    }\n\n    return (\n        <div className=\"m-2\">\n            <div>\n                <label className='mt-1 font-weight-bold'>Permission:</label>\n                <div>\n                    <table className=\"KFPermission table table-sm\">\n                        <thead>\n                            <tr>\n                                <th>&nbsp;</th>\n                                <th>Authors</th>\n                                <th>Group Members</th>\n                                <th>Others</th>\n                            </tr>\n                        </thead>\n                                <tbody>\n                                    <tr>\n                                        <td>\n                                            <form action=\"\">\n                                                <div className=\"form-check form-check-inline\">\n                                                    <input className=\"form-check-input\" type=\"radio\" name='permission' value=\"private\" id=\"contrib-permission1\"\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'private'}\n                                                    />\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission1\">\n        &nbsp;private\n                                                        </label>\n                                                </div>\n                                            </form>\n                                        </td>\n                                        <td>rw</td>\n                                        <td>rw</td>\n                                        <td>-</td>\n                                    </tr>\n                                    <tr>\n                                        <td>\n                                            <form action=\"\">\n                                                <div className=\"form-check form-check-inline\">\n                                                    <input className=\"form-check-input\" type=\"radio\" value=\"protected\" id=\"contrib-permission2\" name='permission'\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'protected'}\n                                                    />\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission2\">\n        &nbsp;protected\n                                                        </label>\n                                                </div>\n                                            </form>\n                                        </td>\n                                        <td>rw</td>\n                                        <td>rw</td>\n                                        <td>r</td>\n                                    </tr>\n                                    <tr>\n                                        <td>\n                                            <form action=\"\">\n                                                <div className=\"form-check form-check-inline\">\n                                                    <input className=\"form-check-input\" type=\"radio\" value=\"public\" id=\"contrib-permission3\" name='public'\n                                                           onChange={onPermissionChange} checked={props.contribution.permission === 'public'}\n                                                    />\n                                                        <label className=\"form-check-label font-weight-normal\" htmlFor=\"contrib-permission3\">\n        &nbsp;public\n                                                        </label>\n                                                </div>\n                                            </form>\n                                        </td>\n                                        <td>rw</td>\n                                        <td>rw</td>\n                                        <td>rw</td>\n                                    </tr>\n                                </tbody>\n                    </table>\n                </div>\n                <label className=\"mt-1 font-weight-bold\">Status:</label>\n                <div className=\"ml-2\">\n                    {props.contribution.status}\n                </div>\n                <label className=\"mt-2 font-weight-bold\">Template:</label>\n                <form className=\"ml-2\" action=\"\">\n                    <div className=\"form-check  form-check-inline\">\n                        <input className=\"form-check-input\" type=\"checkbox\" id=\"c-isTemplate\" checked={props.contribution.data.isTemplate} onChange={isTemplateChange}/>\n\n                            <label className=\"form-check-label font-weight-normal\" htmlFor=\"c-isTemplate\">\n                                isTemplate\n                            </label>\n                    </div>\n                </form>\n            </div>\n            {/* { props.contribution.type === 'Note' &&\n                (<div>\n                <label className=\"mt-1 mr-1 font-weight-bold\">Riseabove:</label>\n                {\n                (props.contribution.type === 'Note' && props.contribution.data && props.contribution.data.riseabove && props.contribution.data.riseabove.viewId) ?\n\n                \"This note has riseabove view. Please look it at 'Read' tab.\"\n                :\n\n                <button type=\"submit\" className=\"btn btn-primary btn-sm\" onClick={makeRiseAbove()}>MakeRiseabove</button>\n                }\n                </div>)\n                } */}\n        </div>\n\n    )\n}\n\nexport default Properties\n","import React, {useState} from 'react';\nimport {Button, Row, Col} from 'react-bootstrap'\nimport Select from 'react-select'\nconst AuthorSelect = props => {\n    const select_options = Object.entries(props.authors).map(\n        (auth) => { return {value: auth[1]._id, label: `${auth[1].firstName} ${auth[1].lastName}`} })\n\n    const [selectedOption, setSelectedOption] = useState(null);\n    const handleChange = selected => {\n        setSelectedOption(selected)\n    };\n\n    return (\n        <div>\n            <Row>\n                <Col>\n                    <Select options={select_options} onChange={handleChange} isClearable={true}/>\n                </Col>\n                <Col md='auto'>\n                    <Button disabled={!selectedOption}\n                        onClick={() => props.onAuthorSelected(selectedOption)}>Add</Button>\n                </Col>\n            </Row>\n            <p>{select_options.length} possible author(s) in this community.</p>\n        </div>\n    )\n}\n\nexport default AuthorSelect\n","import React, {useState} from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Button, Col, Row } from 'react-bootstrap'\nimport {addContribAuthor, removeContribAuthor, editNote} from '../../store/noteReducer.js'\nimport { addNotification } from '../../store/notifier.js'\nimport AuthorSelect from '../authorSelect/AuthorSelect'\nimport Select from 'react-select'\n\nconst AuthorTab = props => {\n    const contribution = useSelector((state) => state.notes[props.contribId])\n    const authors = useSelector((state) => contribution.authors.map((auth) => state.users[auth]))\n    const communityAuthors = useSelector((state) => state.users)\n    const groups = useSelector((state) => state.globals.community.groups)\n    const group_options = groups.map((g) => ({value: g.title, label: g.title}))\n\n    const [g, setG] = useState(contribution.group)\n    const dispatch = useDispatch()\n    const removeAuthor = (author, idx) => {\n        if (idx === 0) {\n            addNotification({title: 'Error!', type:'danger', message:'cannot remove the Primary Author'})\n            return;\n        }else if (idx >= 0) {\n            dispatch(removeContribAuthor({contribId: props.contribId, author: author._id}))\n        }\n    }\n\n    const addAuthor = (author) => {\n        console.log(author)\n        if (!contribution.authors.includes(author.value)){\n            dispatch(addContribAuthor({contribId: props.contribId, author: author.value}))\n        }\n    }\n\n    const selectGroup = (selected) => {\n        setG(selected)\n        dispatch(editNote({_id: contribution._id, group: selected}))\n    }\n\n    //TODO\n    const isEditable = () => {\n        return true\n    }\n    return (\n                <div className=\"authorTab mt-2\" style={{height: '100%'}}>\n                    <Row>\n                        <Col>\n                            <h5>Authors:</h5>\n                            <ul>\n                                {\n                                    authors.map((author, idx) => (\n\n                                        <li key={author._id} style={{cursor: 'move'}}>\n                                            {author.firstName} {author.lastName}\n                                            <Button size='sm' className='ml-1'\n                                                    onClick={() => removeAuthor(author, idx)}>x</Button>\n                                        </li>\n\n                                    ))\n                                }\n                            </ul>\n                        </Col>\n                        <Col>\n                            <div>\n                                <h5>Add author:</h5>\n                                <AuthorSelect authors={communityAuthors} onAuthorSelected={addAuthor}/>\n                            </div>\n                        </Col>\n                    </Row>\n                    <Row>\n                        <Col>\n                            <h5>Group:</h5>\n                            <div>\n                                {\n                                    isEditable()?\n                                    <form method=\"\" id=\"\" action=\"\">\n                                        <Select value={g} options={group_options} onChange={selectGroup} isClearable={true}/>\n                                    </form>\n                                    :\n                                    <div>{contribution.group.title}</div>\n                                }\n                            </div>\n                        </Col>\n                    </Row>\n                </div>\n\n    )\n}\n\nexport default AuthorTab\n","/*global Annotator*/\n/*global $*/\nimport tinymce from 'tinymce/tinymce';\nimport ReactDOM from 'react-dom';\n// Default icons are required for TinyMCE 5.3 or above\nimport 'tinymce/icons/default';\n\n// A theme is also required\nimport 'tinymce/themes/silver';\n// Any plugins you want to use has to be imported\nimport 'tinymce/plugins/media';\nimport 'tinymce/plugins/image';\nimport 'tinymce/plugins/insertdatetime';\nimport 'tinymce/plugins/link';\nimport 'tinymce/plugins/code';\n\nexport const setKFPlugin = (elem, annotatorHandler, uname, scaffoldElement) => {\n    Annotator.Plugin.KFPlugin = function( /*element*/ ) {\n        return {\n            pluginInit: function() {\n                this.annotator\n                    .subscribe('annotationCreated', function(annotation) {\n                        if (annotatorHandler) {\n                            annotatorHandler.annotationCreated(annotation);\n                        }\n                    })\n                    .subscribe('annotationUpdated', function(annotation) {\n                        if (annotatorHandler) {\n                            annotatorHandler.annotationUpdated(annotation);\n                        }\n                    })\n                    .subscribe('annotationDeleted', function(annotation) {\n                        if (annotatorHandler) {\n                            annotatorHandler.annotationDeleted(annotation);\n                        }\n                    })\n                    .subscribe('annotationEditorShown', function(editor, annotation){\n                        if (annotatorHandler) {\n                            annotatorHandler.displayEditor(editor, annotation);\n                        }\n                    })\n                    .subscribe('annotationViewerShown', function(viewer, annotations) {\n                        if (annotatorHandler) {\n                            annotatorHandler.displayViewer(viewer, annotations);\n                        }\n                    })\n                    .subscribe('annotationEditorHidden', function(editor, annotation){\n                        if (annotatorHandler) {\n                            annotatorHandler.editorHidden(editor, annotation);\n                        }\n                    })\n\n                ;\n\n                if (annotatorHandler) {\n                    annotatorHandler.annotatorInitialized(this.annotator);\n                }\n            }\n        };\n    };\n\n\n    //----------------------------Rich Text Annotator Plugin: START -----------------------------\n    /*\n      Rich Text Annotator Plugin v1.0 (https://github.com/danielcebrian/richText-annotator)\n      Copyright (C) 2014 Daniel Cebrin Robles\n      License: https://github.com/danielcebrian/richText-annotator/blob/master/License.rst\n      This program is free software; you can redistribute it and/or\n      modify it under the terms of the GNU General Public License\n      as published by the Free Software Foundation; either version 2\n      of the License, or (at your option) any later version.\n      This program is distributed in the hope that it will be useful,\n      but WITHOUT ANY WARRANTY; without even the implied warranty of\n      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n      GNU General Public License for more details.\n      You should have received a copy of the GNU General Public License\n      along with this program; if not, write to the Free Software\n      Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n    */\n    // Generated by CoffeeScript 1.6.3\n    /* jshint ignore:start */\n    var _ref,\n        // __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n        __hasProp = {}.hasOwnProperty,\n        __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\n\n    Annotator.Plugin.RichText = (function(_super) {\n        __extends(RichText, _super);\n\n\n        // FILE - GLOBALS -----\n        var editorId =\"\";\n\n        //----------------------\n        //Default tinymce configuration\n        RichText.prototype.options = {\n            tinymce:{\n                selector: \"li.annotator-item textarea\",\n                content_css: '/editor.css',\n                height:\"170px\",\n                statusbar: false,\n                plugins: \"media image insertdatetime link code\",\n                menubar: false,\n                toolbar_items_size: 'small',\n                extended_valid_elements : \"iframe[src|frameborder|style|scrolling|class|width|height|name|align|id]\",\n                toolbar: \"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | code | mysidebar\",\n            }\n        };\n\n        function RichText(element,options) {\n            _ref = RichText.__super__.constructor.apply(this, arguments);\n            return _ref;\n        }\n\n\n        RichText.prototype.pluginInit = function() {\n            var annotator = this.annotator,\n                editor = this.annotator.editor;\n            //Check that annotator is working\n            if (!Annotator.supported()) {\n                return;\n            }\n\n            //Editor Setup\n            annotator.editor.addField({\n                type: 'input',\n                load: this.updateEditor,\n            });\n\n            //Viewer setup\n            annotator.viewer.addField({\n                load: this.updateViewer,\n            });\n\n\n            annotator.subscribe(\"annotationEditorShown\", function(){\n                // $(annotator.editor.element).find('.mce-tinymce')[0].style.display='block';\n                // $(annotator.editor.element).find('.mce-container').css('z-index',3000000000);\n                // annotator.editor.checkOrientation();\n            });\n            annotator.subscribe(\"annotationEditorHidden\", function(){\n                // $(annotator.editor.element).find('.mce-tinymce')[0].style.display='none';\n                // $(annotator.editor.element).find(\"#annoSide\").remove();\n            });\n\n            //set listener for tinymce;\n            this.options.tinymce.setup = function(ed) {\n                RichText.prototype.mceditor = ed\n                ed.on('change', function(e) {\n                    //set the modification in the textarea of annotator\n                    $(editor.element).find('textarea')[0].value = tinymce.activeEditor.getContent();\n                });\n                ed.on('Init', function(ed){\n                    $('.mce-container').css('z-index','3090000000000000000');\n\n                });\n                ed.ui.registry.addSidebar('mysidebar', {\n                    tooltip: 'View Scaffold',\n                    icon: 'settings',\n                    onSetup: function (api) {\n                        const sidebar = api.element()\n                        document.sidebar = sidebar\n                        sidebar.style.width = \"200px\"\n                        sidebar.style.overflow = \"scroll\"\n                        sidebar.style.fontSize = \"0.7rem\"\n                        ReactDOM.render(scaffoldElement, api.element(), null)\n                    },\n                    onShow: function (api) {\n                        // var str = \"\\\"\\'components/kfutils/scaffold/scaffold.html\\'\\\"\";\n                        // api.element().innerHTML = \"<div id='annoSide'><div ng-include=\"+str+\"></div></div>\";\n                        // var scope = angular.element(document.getElementById(\"scaffoldContainer\")).scope();\n                        // scope.$apply(function () {\n                        //     scope.annotatorScaffoldInit(editorId);\n                        // });\n                    },\n                    onHide: function (api) {\n                        // api.element().innerHTML = \"\";\n                        // var scope = angular.element(document.getElementById(\"scaffoldContainer\")).scope();\n                        // scope.$apply(function () {\n                        //     scope.annotatorScaffoldClose();\n                        // });\n                        //console.log('Hide panel', api.element());\n                    }\n                });\n\n            };\n            tinymce.init(this.options.tinymce);\n        };\n\n        RichText.prototype.updateEditor = function(field, annotation) {\n            var text = typeof annotation.text!=='undefined'?annotation.text:'';\n            var count = tinymce.editors.length;\n            editorId = tinymce.editors[count-2].id;\n            tinymce.get(editorId).setContent(text);\n            //tinymce.activeEditor.setContent(text);\n            $(field).remove(); //this is the auto create field by annotator and it is not necessary\n        };\n\n        RichText.prototype.updateViewer = function(field, annotation) {\n            var textDiv = $(field.parentNode).find('div:first-of-type')[0];\n            textDiv.innerHTML =annotation.text;\n            $(textDiv).addClass('richText-annotation');\n            $(field).remove(); //this is the auto create field by annotator and it is not necessary\n        };\n\n        return RichText;\n\n    })(Annotator.Plugin);\n\n            /* jshint ignore:end */\n\n\n            //----------------------------Rich Text Annotator Plugin: END -----------------------------\n\n    elem.annotator('addPlugin', 'KFPlugin');\n    elem.annotator('addPlugin', 'Tags');\n    elem.annotator('addPlugin', 'RichText');\n\n    if (uname) {\n        elem.annotator('addPlugin', 'Permissions', {\n            user: uname,\n            permissions: {\n                read: [uname],\n                update: [uname],\n                delete: [uname],\n                admin: [uname]\n            },\n            showEditPermissionsCheckbox: false\n        });\n    }\n}\n\nexport const vm2m = (anno) => {\n    const isPublic = anno.permissions.read.length === 0;\n    if (isPublic) {\n        anno.permission = 'protected';\n    } else {\n        anno.permission = 'private';\n    }\n    const loc = anno.ranges[0];\n    if (loc.start.indexOf('/div[1]') === 0) {\n        loc.start = loc.start.substring(7);\n    }\n    if (loc.end.indexOf('/div[1]') === 0) {\n        loc.end = loc.end.substring(7);\n    }\n    return anno;\n};\n\nexport const m2vm = (anno) => {\n    const loc = Object.assign({}, anno.ranges[0]);\n    loc.start = '/div[1]' + loc.start;\n    loc.end = '/div[1]' + loc.end;\n    anno.ranges[0] = loc\n    return anno;\n};\n","import { createAction, createReducer } from '@reduxjs/toolkit';\nimport * as api from './api.js'\n\nexport const addUser = createAction('ADD_USER')\nexport const addAuthors = createAction('ADD_AUTHORS')\nconst initState = {}\nexport const userReducer = createReducer(initState, {\n    [addUser]: (state, action) => {\n        state[action.payload._id] = action.payload\n    },\n    [addAuthors]: (state, action) => {\n        action.payload.forEach((author) => state[author._id] = author )\n    }\n\n})\n\nexport const fetchAuthors = (communityId) => async (dispatch) => {\n    const authors = await api.getCommunityAuthors(communityId)\n    dispatch(addAuthors(authors))\n}\n","import { configureStore } from '@reduxjs/toolkit';\r\nimport { globalsReducer } from './globalsReducer.js'\r\nimport { dialogReducer } from './dialogReducer.js'\r\nimport { noteReducer } from './noteReducer.js'\r\nimport { scaffoldReducer } from './scaffoldReducer.js'\r\nimport { userReducer } from './userReducer.js'\r\n\r\nexport default configureStore({\r\n  reducer: {\r\n      dialogs: dialogReducer,\r\n      notes: noteReducer,\r\n      scaffolds: scaffoldReducer,\r\n      globals: globalsReducer,\r\n      users: userReducer\r\n  },\r\n    devTools: true\r\n});\r\n","import React from 'react';\nimport ScaffoldSelect from '../scaffold/ScaffoldSelect'\nimport * as annotPlugins from './annotator.service'\nimport './annotator.css'\nimport store from '../../store/store';\nimport { Provider } from 'react-redux';\n/*global $*/\nclass Annotator extends React.Component {\n\n    constructor(props) {\n        super(props)\n        this.contentRef = React.createRef();\n        this.annotatorInitialized = this.annotatorInitialized.bind(this)\n        this.annotationCreated = this.annotationCreated.bind(this)\n        this.annotationUpdated = this.annotationUpdated.bind(this)\n        this.annotator = null\n\n        this.displayEditor = this.displayEditor.bind(this)\n        this.displayViewer = this.displayViewer.bind(this)\n        this.fixPopupLocation = this.fixPopupLocation.bind(this)\n        this.editorHidden = this.editorHidden.bind(this)\n        this.loadAnnotations = this.loadAnnotations.bind(this)\n        this.onScaffoldSelected = this.onScaffoldSelected.bind(this)\n        this.dlg = null\n    }\n\n    componentDidMount() {\n        const annotatedElem = $(this.contentRef.current)\n        annotatedElem.annotator()\n        this.scaffoldElem = (\n            <Provider store={store}>\n                <ScaffoldSelect initVal={0} onScaffoldSelected={this.onScaffoldSelected}/>\n            </Provider>)\n\n        annotPlugins.setKFPlugin(annotatedElem, {\n            annotationCreated: this.annotationCreated,\n            annotationUpdated: this.annotationUpdated,\n            annotationDeleted: this.props.onDelete,\n            displayEditor: this.displayEditor,\n            displayViewer: this.displayViewer,\n            annotatorInitialized: this.annotatorInitialized,\n            editorHidden: this.editorHidden\n        }, this.props.author.userName, this.scaffoldElem)\n        this.dlg = $(`#contrib-dialog-${this.props.containerId}`)\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.annotsFetched === 1 && this.props.annotsFetched !== prevProps.annotsFetched) {\n            this.loadAnnotations()\n        }\n    }\n\n    componentWillUnmount() {\n        //Need to remove editor when closing dialog\n        if (this.annotator && this.annotator.plugins.RichText.mceditor)\n            this.annotator.plugins.RichText.mceditor.remove()\n    }\n    editorHidden(editor, annotation){\n        $(editor.element.find(\".annotator-controls\")).off()\n    }\n    loadAnnotations(){\n        const annotations = Object.values(this.props.annots).map((annot) => {\n            const anno = Object.assign({}, annot.data)\n            anno.ranges = [...anno.ranges]\n            anno.highlights = [...anno.highlights]\n            annotPlugins.m2vm(anno)\n            return anno\n        })\n        this.annotator.loadAnnotations(annotations)\n        this.props.onAnnotsLoaded()\n    }\n    annotatorInitialized(annotator){\n        this.annotator = annotator\n        this.loadAnnotations()\n\n        var $element = $('div.annotator-adder');\n        $element.attr('title', 'Annotation');\n        $element.addClass('tooltip1');\n        $element.append('<span class=\"tooltiptext\">Annotation</span>');\n\n        document.annotator = this.annotator\n        const adder = annotator.adder.get(0)\n        this.observer = new MutationObserver(function(mutationsList){\n            for(let mutation of mutationsList) {\n                if (mutation.type === 'attributes') {\n                    //mutation.oldValue.startsWith(\"display: none\") &&\n                    if( adder.style.display !== 'none'){\n                        this.fixPopupLocation(annotator.adder)\n                        this.observer.takeRecords()\n                        return\n                    }\n                }\n            }\n        }.bind(this));\n        //TODO disconnect? when?\n        this.observer.observe(adder, { attributes: true, attributeOldValue: true });\n    }\n    annotationCreated(annotation){\n        this.props.onCreate(annotPlugins.vm2m(annotation))\n    }\n    annotationUpdated(annotation){\n        this.props.onUpdate(annotPlugins.vm2m(annotation))\n    }\n    displayEditor(editor, annotation){\n        /* $(editor.element.find(\".annotator-controls\")).off()*/\n        if (!editor.element.hasClass(editor.classes.invert.y)) {\n            editor.element.addClass(editor.classes.invert.y);\n        }\n    }\n    fixPopupLocation(popup){\n        const dlgOffset = this.dlg.offset()\n        const ppOffset = popup.offset()\n        popup.offset({top: ppOffset.top - dlgOffset.top, left: ppOffset.left - dlgOffset.left})\n    }\n    displayViewer(viewer, annotation){\n        this.fixPopupLocation(viewer.element)\n        viewer.element.addClass(viewer.classes.invert.y);\n    }\n\n    onScaffoldSelected(tagCreator, initialText) {\n        const mceditor = this.annotator.plugins.RichText.mceditor\n        const selected = mceditor.selection.getContent();\n        let text = selected.length ? selected : initialText;\n        const {tag, supportContentId} = tagCreator(text);\n        mceditor.insertContent(tag)\n        //select text after insert\n        const contentTag = mceditor.dom.get(supportContentId);\n        if (contentTag)\n            mceditor.selection.setCursorLocation(contentTag)\n    }\n\n    render() {\n        return (\n            <div ref={this.contentRef}>\n                <div dangerouslySetInnerHTML={{__html: this.props.content}}>\n                </div>\n            </div>\n        )\n    }\n\n}\n\nexport default Annotator\n","import React from 'react';\nimport { Tabs, Tab } from 'react-bootstrap';\nimport WriteTab from '../writeTab/WriteTab'\nimport History from '../historyTab/History'\nimport Properties from '../propertiesTab/Properties'\nimport AuthorTab from '../authorsTab/AuthorTab'\nimport Annotator from '../annotator/Annotator'\nimport { connect } from 'react-redux'\nimport {editNote, removeDrawing, editSvgDialog, setAnnotationsLoaded,\n        fetchAttachments, setWordCount, fetchRecords,\n        createAnnotation, deleteAnnotation, modifyAnnotation} from '../../store/noteReducer.js'\nimport {openDrawDialog} from '../../store/dialogReducer.js'\nimport { scaffoldWordCount } from '../../store/kftag.service.js'\nimport { dateFormatOptions, fetchCommGroups } from '../../store/globalsReducer.js'\nimport './Note.css'\n\nclass Note extends React.Component {\n    constructor(props) {\n        super(props)\n        this.onEditorSetup = this.onEditorSetup.bind(this)\n        this.onDrawingToolOpen = this.onDrawingToolOpen.bind(this)\n        this.addDrawing = this.addDrawing.bind(this)\n        this.onNoteChange = this.onNoteChange.bind(this)\n        this.wordCount = this.wordCount.bind(this)\n        this.onTabSelected = this.onTabSelected.bind(this)\n        this.onAnnotationCreated = this.onAnnotationCreated.bind(this)\n        this.onAnnotationDeleted = this.onAnnotationDeleted.bind(this)\n        this.onAnnotationUpdated = this.onAnnotationUpdated.bind(this)\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.props.drawing && prevProps.drawing !== this.props.drawing && this.props.drawTool === this.props.noteId) {\n            this.editor.insertContent(this.props.drawing)\n            this.props.removeDrawing()\n        }\n    }\n\n    onNoteChange(note) {\n        if (note.scaffold){\n            const {tagCreator, initialText} = note.scaffold;\n            this.addSupport(true, initialText, tagCreator)\n        }else if (note.attach){\n            this.editor.insertContent(note.attach)\n        }\n        else{\n            this.props.editNote({_id: this.props.noteId, ...note})\n            if (note.data && note.data.body) {\n                this.wordCount(note.data.body);\n            }\n        }\n    }\n\n    wordCount(text) {\n        const wordCount = this.editor.plugins.wordcount.getCount() - scaffoldWordCount(text);\n        this.props.setWordCount({contribId: this.props.noteId, wc: wordCount})\n    }\n\n    onEditorSetup(editor){\n        editor.onDrawButton = this.onDrawingToolOpen;\n        this.editor = editor;\n    }\n\n    onDrawingToolOpen(svg){\n        //Create dialog\n        if (svg) {\n            this.props.editSvgDialog(this.props.noteId, svg);\n        } else {\n            this.props.openDrawDialog(this.props.noteId);\n        }\n    }\n\n    addDrawing(drawing) {\n        // Add draw to editor\n        this.editor.insertContent(drawing);\n    }\n\n    addSupport(selection, initialText, tagCreator) {\n        const selected = this.editor.selection.getContent();\n        let text = selected.length ? selected : initialText;\n        const {tag, supportContentId} = tagCreator(text);\n        this.editor.insertContent(tag)\n        //select text after insert\n        if (selection) {\n            const contentTag = this.editor.dom.get(supportContentId);\n            if (contentTag)\n                this.editor.selection.setCursorLocation(contentTag)\n        }\n    }\n\n    onTabSelected(tab) {\n        if (tab === 'history'){ //Refresh records\n            this.props.fetchRecords(this.props.note._id)\n        }if (tab === 'author'){ //Refresh groups, and authors?\n            this.props.fetchCommGroups(this.props.note.communityId)\n        }\n    }\n\n    onAnnotationCreated(annotation) {\n        this.props.createAnnotation(this.props.note.communityId, this.props.note._id, this.props.author._id, annotation)\n    }\n\n    onAnnotationDeleted(annotation){\n        if (annotation.linkId && annotation.modelId) {\n            this.props.deleteAnnotation(annotation.linkId, this.props.note._id, annotation.modelId);\n        }\n    }\n\n    onAnnotationUpdated(annotation){\n        if (!annotation.linkId || !annotation.modelId) {\n            console.error('ERROR! annoVM doesn\\'t have id on update');\n            return;\n        }\n        const model = Object.assign({}, this.props.note.annos[annotation.modelId])\n        if (!model) {\n            console.error('ERROR! model couldn\\'t find');\n            return;\n        }\n        model.data = annotation;\n        this.props.modifyAnnotation(model, this.props.note.communityId, this.props.note._id)\n    }\n\n    render() {\n        const formatter = new Intl.DateTimeFormat('default', dateFormatOptions)\n        return (\n            <div>\n                <div className='contrib-info'>\n                    Created By: {this.props.author.firstName} {this.props.author.lastName} <br/>\n                    Last modified: {formatter.format(new Date(this.props.note.modified))}\n                </div>\n                <Tabs defaultActiveKey=\"write\" transition={false} onSelect={this.onTabSelected}>\n                    <Tab eventKey=\"read\" title=\"read\">\n                        <Annotator containerId={this.props.dlgId}\n                                   content={this.props.note.data.body}\n                                   annots={this.props.note.annos}\n                                   annotsFetched={this.props.note.annotsFetched}\n                                   author={this.props.author}\n                                   onCreate={this.onAnnotationCreated}\n                                   onUpdate={this.onAnnotationUpdated}\n                                   onDelete={this.onAnnotationDeleted}\n                                   onAnnotsLoaded={()=>this.props.setAnnotationsLoaded({contribId:this.props.note._id, value: 0})}\n                        >\n                        </Annotator>\n                    </Tab>\n                    <Tab eventKey=\"write\" title=\"write\">\n                        <WriteTab\n                            note={this.props.note}\n                            onScaffoldSelected={this.scaffoldSelected}\n                            onChange={this.onNoteChange}\n                            onEditorSetup={this.onEditorSetup}\n                        ></WriteTab>\n                    </Tab>\n                    <Tab eventKey=\"author\" title=\"author(s)\">\n                        <AuthorTab contribId={this.props.noteId}/>\n                    </Tab>\n                    <Tab eventKey='history' title='history'><History records={this.props.note.records}/></Tab>\n                    <Tab eventKey='properties' title='properties'><Properties contribution={this.props.note} onChange={this.onNoteChange}/></Tab>\n                </Tabs>\n\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n    const note = state.notes[ownProps.noteId]\n    return {\n        note: note,\n        drawing: state.notes.drawing,\n        drawTool: state.dialogs.drawTool,\n        author: note && (state.users[note.authors[0]] || 'NA')\n    }\n}\n\nconst mapDispatchToProps = { editNote, openDrawDialog, setWordCount,\n                             removeDrawing, editSvgDialog, fetchAttachments, fetchRecords,\n                             deleteAnnotation, fetchCommGroups, createAnnotation, modifyAnnotation, setAnnotationsLoaded}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(Note)\n\n","import React from 'react';\nimport Dialog from '../dialog/Dialog.js'\nimport { connect } from 'react-redux'\n\nclass DrawDialog extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.onConfirm = this.onConfirm.bind(this);\n        this.onLoad = this.onLoad.bind(this);\n        this.getIframeRef = this.getIframeRef.bind(this);\n    }\n\n    onConfirm(){\n        var wnd1 = this.iframe_ref.contentWindow;\n        var bg = wnd1.svgCanvas.current_drawing_.all_layers[0];\n        var wnd2 = wnd1.svgCanvas.current_drawing_.all_layers[1];\n\n        var widd = wnd2[1].getBBox().width;\n        var heig = wnd2[1].getBBox().height;\n\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"width\", widd);\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"height\", heig);\n        bg[1].childNodes[1].setAttribute(\"width\", widd);\n        bg[1].childNodes[1].setAttribute(\"height\", heig);\n\n        wnd1.svgCanvas.selectAllInCurrentLayer();\n        wnd1.svgCanvas.groupSelectedElements();\n        wnd1.svgCanvas.alignSelectedElements('l', 'page');\n        wnd1.svgCanvas.alignSelectedElements('t', 'page');\n        wnd1.svgCanvas.ungroupSelectedElement();\n        wnd1.svgCanvas.clearSelection();\n\n        wnd1.svgCanvas.current_drawing_.svgElem_.setAttribute(\"padding\", '2em');\n        wnd1.svgCanvas.setResolution('fit', 100);\n        var svg = wnd1.svgCanvas.getSvgString();\n\n        var canvas = document.createElement(\"canvas\");\n\n        canvas.width = widd + 4;\n        canvas.height = heig + 4;\n\n        var ctx = canvas.getContext(\"2d\");\n\n        var img = document.createElement(\"img\");\n\n        img.setAttribute(\"src\", \"data:image/svg+xml;base64,\" + btoa(svg));\n\n        img.onload = function () {\n            ctx.drawImage(img, 0, 0);\n            var p = canvas.toDataURL(\"image/png\");\n            const drawing = \"<img alt='\" + svg + \"' src='\" + p + \"'/>\";\n\n            this.props.onConfirm(drawing);\n        }.bind(this);\n    }\n\n    getIframeRef(frame) {\n        if(!frame) {\n            return\n        }\n        this.iframe_ref = frame\n    }\n\n    onLoad(e){\n        const svg = this.props.note.editSvg\n        if (svg){\n            e.target.contentWindow.svgCanvas.setSvgString(svg)\n        }\n    }\n\n    render() {\n        return (\n            <Dialog\n                title='DrawTool'\n                style={{zIndex: 3000}}\n                onClose={this.props.onClose}\n                onConfirm={this.onConfirm}\n                confirmButton='Add'>\n\n\n                <iframe onLoad={this.onLoad} title='DrawingTool' src='/drawing-tool/svg/index.html' ref={this.getIframeRef} width='100%' height='100%'></iframe>\n            </Dialog>\n        )\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n        note: state.notes[ownProps.noteId],\n    }\n}\n\n/* const mapDispatchToProps = { editNote, openDrawDialog, removeDrawing, editSvgDialog} */\n\nexport default connect(\n    mapStateToProps,\n)(DrawDialog)\n","import React, {useCallback} from 'react';\nimport Dialog from '../dialog/Dialog.js';\nimport Note from '../note/Note.js';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {closeDialog, closeDrawDialog, focusDialog } from '../../store/dialogReducer.js'\nimport {removeNote, addDrawing, postContribution} from '../../store/noteReducer.js'\nimport DrawDialog from '../drawDialog/DrawDialog.js'\n\nconst DialogHandler = props => {\n    const dialogs = useSelector(state => state.dialogs);\n    const dispatch = useDispatch();\n    // Close dialog and remove dialog AND note from state\n\n    const onDialogClose = useCallback(\n        (dlg) => {\n            dispatch(closeDialog(dlg.id));\n            dispatch(removeNote(dlg.noteId));\n        },\n        [dispatch]\n    )\n\n    const onDialogConfirm = useCallback(\n        (dlg) => {\n            dispatch(postContribution(dlg.noteId, dlg.id));\n            /* dispatch(closeDialog(dlg.id)); */\n        },\n        [dispatch]\n    );\n\n    const onFocusDialog = useCallback(\n        (dlgId) => dispatch(focusDialog(dlgId)),\n        [dispatch]\n    );\n\n    const onCloseDrawDialog = useCallback(\n        () => {\n            dispatch(closeDrawDialog())\n        },\n        [dispatch]\n    );\n\n    const onConfirmDrawDialog = useCallback(\n        (drawing) => {\n            dispatch(addDrawing(drawing))\n            dispatch(closeDrawDialog())\n        },\n        [dispatch]\n    );\n\n    return (\n        <div>{\n            dialogs.dialogs.map((elt, i) =>\n                <Dialog key={elt.id}\n                        id={elt.id}\n                        onMouseDown={() => onFocusDialog(elt.id)}\n                        title={elt.title}\n                        style={{zIndex: elt.zIndex}}\n                        onClose={()=>onDialogClose(elt)}\n                        onConfirm={()=> onDialogConfirm(elt)}\n                        confirmButton={elt.confirmButton}>\n\n                    <Note key={elt.noteId} dlgId={elt.id} noteId={elt.noteId} />\n                </Dialog>\n            )\n        }\n\n            {dialogs.drawTool!== null ?\n             <DrawDialog onClose={onCloseDrawDialog}\n                         onConfirm={onConfirmDrawDialog}\n                         noteId={dialogs.drawTool}\n             /> : null}\n\n        </div>\n    )\n\n}\nexport default DialogHandler;\n","import React, { Component } from 'react';\nimport { Button, Row, Col,} from 'react-bootstrap';\nimport {Form, FormGroup, Input, Alert} from 'reactstrap';\n\nimport Axios from 'axios';\n\nimport './NoteContent.css';\nimport {apiUrl} from '../../store/api.js';\n\nclass NoteContent extends Component{\n    noteList = [];\n    constructor(props) {\n        super(props);\n        this.state={\n        token : sessionStorage.getItem('token'),\n        myViews : [],\n        viewId : sessionStorage.getItem('viewId'),\n        viewTitle : sessionStorage.getItem(\"viewTitle\")? sessionStorage.getItem(\"viewTitle\") :'welcome',\n        addView : sessionStorage.getItem(\"viewTitle\")? sessionStorage.getItem(\"viewTitle\") :'welcome',\n        communityId : sessionStorage.getItem('communityId'),\n        visible : false,\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n        \n    }\n\n    componentDidMount(){\n\n        //SET HEADER WITH TOKEN BEARER\n        var config = {\n          headers: { Authorization: `Bearer ${this.state.token}` }\n        };\n    \n       //GET USER'S VIEWS\n        var viewUrl= `${apiUrl}/communities/${this.state.communityId}/views`;\n    \n        Axios.get(viewUrl, config)\n        .then(\n            result=>{\n              this.setState({\n                myViews: result.data\n              })\n            }).catch(\n                error=>{\n                    // alert(error);\n                });\n      }\n\n      handleChange(e) {\n        e.persist();\n        let target = e.target;\n        let id = target.value;\n        \n        this.setState({\n            addView : id,\n        });\n             \n    }\n  \n      handleSubmit(e) {\n        e.preventDefault();\n        console.log(\"State Handle Submit\", this.state.addView);\n\n        let url = `${apiUrl}/links`;\n        let config = {\n            headers: { Authorization: `Bearer ${this.state.token}` }\n          };\n        this.props.noteContnetList.forEach(note => {\n            let noteId = note._id;\n            let query = {\n                \"from\": this.state.addView,\n                \"to\" : noteId,\n                \"type\": \"contains\"\n            };\n            Axios.post(url, query, config).then(\n                res => {\n                    // console.log(\"AZIOX POST DONE\");\n                    this.setState({visible:true},()=>{\n                        window.setTimeout(()=>{\n                          this.setState({visible:false})\n                        },1000)\n                    });\n                    \n                }\n            );    \n        });\n        \n        \n        \n       // POST LINKS ALERT THEY'RE ADDED TO VIEW TITLE\n      \n      }\n\n    render(){\n        \n        return(\n            <>\n                <Form className=\"mrg-1-top\">\n                <Row>\n                    <Col md=\"8\">\n                    <FormGroup>\n                    {/* <Label>Select Community</Label> */}\n                        <Input type=\"select\" name=\"viewId\" value={this.state.addView} onChange={this.handleChange}>{\n                            this.state.myViews.map((obj, i) => {\n                                return <option key={i} value={obj._id}> {obj.title} </option>\n                            })\n                        }</Input>\n                    </FormGroup>\n                    </Col>\n\n                    <Col md=\"4\">\n                        <Button onClick={this.handleSubmit} >Add to View</Button>\n                    </Col>\n                </Row>\n                <Row>\n                    <Col>\n                    <Alert color=\"info\" isOpen={this.state.visible} >\n                    Notes added to View!\n                    </Alert>\n                    </Col>\n                </Row>\n                </Form>                \n            {this.props.noteContnetList.map(\n                (obj,i)=>{\n\n                    if(this.props.query && obj.data.English){\n                        let innerHTML = obj.data.English;\n                        let index = innerHTML.indexOf(this.props.query);\n                        if (index >= 0) { \n                            obj.data.English = innerHTML.substring(0,index) + \"<span class='highlight'>\" + innerHTML.substring(index,index+this.props.query.length) + \"</span>\" + innerHTML.substring(index + this.props.query.length);\n                        }\n                    }else if(this.props.query && obj.data.body){\n                        let innerHTML = obj.data.body;\n                        let index = innerHTML.indexOf(this.props.query);\n                        if (index >= 0) { \n                            obj.data.body = innerHTML.substring(0,index) + \"<span class='highlight'>\" + innerHTML.substring(index,index+this.props.query.length) + \"</span>\" + innerHTML.substring(index + this.props.query.length);\n                        }   \n                    }              \n\n                    return<>\n                        <Row className=\"min-height-2 mrg-05 border rounded mrg-1-bot pd-1\" key={i}>\n                            <Col>\n                                <Row>\n                                    <Col md=\"11\" className=\"pd-1 primary-800 font-weight-bold\">{obj.title }</Col>\n                                    <Col md=\"1\"><Button variant=\"secondary\" onClick={()=>this.props.closeNote(obj._id)}>X</Button></Col>\n                                </Row>\n                                <Row><span className=\"pd-1\" dangerouslySetInnerHTML={{ __html: obj.data.English ? (obj.data.English):(obj.data.body)}} /></Row>\n                            </Col>\n                        </Row>\n\n                    </>\n                }\n            )}\n            </>\n        )\n    }\n\n}\nexport default NoteContent;","import React, { Component } from 'react';\nimport Axios from 'axios';\nimport {apiUrl} from '../../store/api.js';\n\nclass Author extends Component{\n    token = sessionStorage.getItem('token');\n    constructor(props) {\n        super(props);\n        this.state={\n            communityId: sessionStorage.getItem('communityId'),\n            authors: [],\n            authorName:\"\",\n        }\n        \n    }\n\n    componentDidMount(){\n        var config = {\n            headers: { Authorization: `Bearer ${this.token}` }\n        }; \n\n        //GET AUTHORS\n        var authorUrl = `${apiUrl}/communities/${this.state.communityId}/authors`;\n        Axios.get(authorUrl, config)\n        .then(\n            result=>{\n                this.setState({\n                    authors : result.data,\n                });\n\n                this.state.authors.filter(obj => obj._id.includes(this.props.authorId)).map(filteredObj => {\n                    this.setState({\n                        authorName: filteredObj.firstName + \" \"+ filteredObj.lastName,\n                    });\n                    return null;\n                });\n\n            }).catch(\n                error=>{\n                    alert(error);\n                });\n\n    }\n\n    render(){\n        return(\n            <>\n            <span> {this.state.authorName}</span>\n            </>\n        )\n    }\n\n}\nexport default Author;","import React, { Component } from 'react';\nimport { Link } from \"react-router-dom\";\nimport { DropdownButton, Dropdown, Button, Row, Col, Modal } from 'react-bootstrap';\nimport { Form, FormGroup, Label, Input} from 'reactstrap';\nimport Axios from 'axios';\nimport {apiUrl} from '../store/api.js';\nimport * as api from '../store/api.js';\nimport {newNote, openContribution} from '../store/noteReducer.js'\nimport { connect } from 'react-redux'\nimport DialogHandler from '../components/dialogHandler/DialogHandler.js'\nimport NoteContent from '../components/NoteContent/NoteContent'\nimport { fetchAuthor, fetchView, fetchCommunity, setCommunityId, setViewId} from '../store/globalsReducer.js'\nimport { fetchAuthors } from '../store/userReducer.js';\nimport Author from '../components/Author/Author';\nimport './View.css';\nconst _ = require('lodash');\n\nclass View extends Component {\n\n    myRegistrations= [];\n    myViews = []; \n    myCommunityId = '';\n    show= false; \n    from = [];\n    to = []; \n    myTempTo = [];\n    hierarchyNote =[];\n    noteData1 = [];\n    noteContnetNew =[];\n\n    //TOKEN\n    token = sessionStorage.getItem('token');\n\n\n    constructor(props) {\n        super(props);\n        // GET communityId AND welcomeId IN myState\n        // this.myState= this.props.location.state;\n        \n        //COMMUNITY-ID\n        // this.myCommunityId = this.myState.communityId;\n\n        this.state={\n            communitites: [],\n            myCommunities: [],\n            views: [],\n            communityId: sessionStorage.getItem('communityId'),\n            viewId: sessionStorage.getItem('viewId'),\n            viewLinks : [],\n            showView: false,\n            showCommunity: false,\n            showContribution: false,\n            showNote: false,\n            hNotes: [],\n            addView: '',\n            showRiseAbove : false,\n            showModel : false,\n            showNoteContent: false,\n            noteContnetList : [],\n            query:\"\",\n            filteredData: [],\n            filter:'title',\n            authors: [],\n            scaffolds : [],\n            scaffoldsTitle : [],\n            noteData: [],\n\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n\n        this.handleSubmitView = this.handleSubmitView.bind(this);\n        this.handleChangeView = this.handleChangeView.bind(this);\n        \n        this.onCloseDialog = this.onCloseDialog.bind(this);\n        \n        this.onConfirmDrawDialog = this.onConfirmDrawDialog.bind(this);\n\n        this.handleInputChange = this.handleInputChange.bind(this);\n        \n        this.showContent = this.showContent.bind(this);\n    }\n\n\n    componentDidMount(){\n        /* this.props.setCommunityId(sessionStorage.getItem('communityId'))\n         * this.props.setViewId(sessionStorage.getItem('viewId')) */\n        this.props.fetchAuthor(this.props.communityId)\n        this.props.fetchView(this.props.viewId)\n        this.props.fetchCommunity(this.props.communityId)\n        this.props.fetchAuthors(this.props.communityId)\n\n        this.setState(this.props.location.state);\n        // console.log(\"state\",this.state);\n        \n\n        //GET LIST OF ALL COMMUNITIES\n        Axios.get(`${apiUrl}/communities`)\n        .then(\n            result=>{\n                this.setState({\n                    communitites: result.data\n                 })\n            }).catch(\n                error=>{\n                    console.log(\"GET Communities Failed\");\n                    alert(\"GET Communities Failed\");\n                }\n            );\n            \n            //SET HEADER WITH TOKEN BEARER\n            var config = {\n                headers: { Authorization: `Bearer ${this.token}` }\n            };\n\n            //GET USER'S VIEWS\n            var viewUrl= `${apiUrl}/communities/${this.state.communityId}/views`;\n            Axios.get(viewUrl, config)\n            .then(\n                result=>{\n                    this.setState({\n                        myViews: result.data\n                     })\n                    \n                }).catch(\n                    error=>{\n                        alert(error);\n                    });  \n                    \n\n            //GET USER'S REGISTERED COMMUNITIES\n            Axios.get(`${apiUrl}/users/myRegistrations`, config)\n            .then(\n                result=>{\n                    this.setState({\n                        myCommunities: result.data\n                     })\n                }).catch(\n                    error=>{\n                        alert(error);\n                    }\n                );\n\n\n            let viewNotesUrl= `${apiUrl}/links/from/${sessionStorage.getItem('viewId')}`;\n            let links;\n            let noteData=[];\n            // GET NOTES ID IN VIEW\n            Axios.get(viewNotesUrl, config)\n            .then(\n                result=>{\n                    // links = result.data;\n                    links = result.data.filter(obj=>(obj._to.type === \"Note\" && obj._to.title !== \"\" && obj._to.status === \"active\")).map(\n                        filteredObj=>{\n                            \n                            let noteUrl=`${apiUrl}/objects/${filteredObj.to}`;\n                            // GET NOTEDATA\n                            Axios.get(noteUrl, config)\n                            .then(\n                                result=>{\n                                    noteData.push(result.data);\n                                }).catch(\n                                    error=>{\n                                        console.log(\"Failed to get data for: \",filteredObj.to);                                        \n                                });\n                            return filteredObj;\n                    });\n\n                    const sortedLinks = _.sortBy(links, function(obj) { \n                        return obj._to.modified;\n                    }).reverse();\n\n                    this.setState({\n                        viewLinks: sortedLinks, \n                        noteData : noteData,\n                    });\n                    // console.log(\"state link and data\", this.state.viewLinks, this.state.noteData);\n                    this.noteData1 = noteData;\n        \n                }).catch(\n            error=>{\n                console.log(\"Failed to get Links for viewId\", sessionStorage.getItem('viewId'));\n            });\n\n            \n            //GET SEARCH - HIRARCHICAL NOTES\n            var searchUrl = `${apiUrl}/links/${this.state.communityId}/search`;\n            let query = {\"query\": {\"type\": \"buildson\"}};\n            let buildOnResult = [];\n            Axios.post(searchUrl, query, config)\n            .then(\n                result=>{\n                    buildOnResult = result.data.reverse();\n                    let filteredBuildOn = buildOnResult.filter(function (obj){\n                        if ((obj._to.type === \"Note\" && obj._to.status === \"active\") \n                            && (obj._from.type === \"Note\" && obj._from.status === \"active\")) {\n                                return obj;\n                        }\n                        else {\n                            return null;\n                        }\n                    });\n\n                    filteredBuildOn.map(obj=>{\n                        this.from.push(obj.from);\n                        this.to.push(obj.to);\n                        this.hierarchyNote.push(obj);\n                        return null;\n                    });\n\n                    try {\n                        for(var l in this.to){\n                            if(this.from.includes(this.to[l])){\n                                var index= this.from.indexOf(this.to[l]);\n                                var temporaryTo = [];\n                                if(this.hierarchyNote[index]){\n                                    temporaryTo.push(this.hierarchyNote[index]);\n                                }\n                                temporaryTo.push(this.hierarchyNote[l]);\n                                this.hierarchyNote[l] = temporaryTo;\n                                delete this.hierarchyNote[index];                                \n                            }\n                        }\n                        \n                    } catch (error) {\n                        console.log(\"Error in Hnotes\", error);\n                        \n                    }finally{\n                        this.setState({\n                            hNotes : this.hierarchyNote\n                        })\n                        // console.log(\"HNOTES\", this.state.hNotes);\n                        \n                    }                      \n                }).catch(\n                    error=>{\n                        console.log(\"Error occured for BuildsOn\", error);                        \n                })\n\n            \n            //GET AUTHORS\n            var authorUrl = `${apiUrl}/communities/${this.state.communityId}/authors`;\n            Axios.get(authorUrl, config)\n            .then(\n                result=>{\n                    this.setState({\n                        authors : result.data,\n                    });\n\n                    // console.log(\"this.state.authors\",this.state.authors);\n\n\n                }).catch(\n                    error=>{\n                        alert(error);\n                    });\n\n            //GET SCAFFOLDS\n            let scaffoldIds =[];\n            let scaffolds = [];\n            api.getCommunity(this.state.communityId).then(\n                res=>{\n                    scaffoldIds = res.data.scaffolds\n                    // console.log(\"res\", scaffoldIds);\n                    \n                    scaffoldIds.forEach(id => {\n                        // CALL COMMNITY LINK / VIEW LINK  ID THEN SEARCH IN CONTENT  \n                        let url = `${apiUrl}/links/from/` + id ;\n                        \n                        Axios.get(url, config)\n                        .then(\n                            result=>{\n                                scaffolds.push(result.data);\n                        });\n                    });\n\n                    this.setState({\n                        scaffolds : scaffolds,\n                    });                                    \n                });\n            }\n\n    handleChange = (e) => {\n        let target = e.target;\n        let name = target.name;\n        let value = target.value;\n        // console.log(name,value);        \n\n        this.setState({\n            [name]: value\n        });\n    }\n\n    handleSubmit(e) {\n        e.preventDefault();\n        // console.log('The form was submitted with:');\n        // console.log(this.state.communitySelect);\n        // console.log('ADD view:',this.state.addView);\n    }\n\n    handleChangeView = (e) => {\n        let target = e.target;\n        let name = target.name;\n        let value = target.value;\n\n        this.setState({\n            [name]: value\n        });\n    }\n\n    handleSubmitView(e) {\n        e.preventDefault();\n        var config = {\n            headers: { Authorization: `Bearer ${this.token}` }\n        };        \n        \n        var addViewUrl = `${apiUrl}/contributions/${this.state.communityId}`;\n        \n        var query= {\"authors\":[sessionStorage.getItem(\"userId\")],\n            \"communityId\":this.state.communityId, \n            \"permission\":\"public\",\n            \"status\":\"active\",\n            \"title\": this.state.addView,\n            \"type\": \"View\"}\n        Axios.post(addViewUrl,query,config)\n            .then(\n                result=>{\n                    // console.log(\"Successful\",result);\n                    \n                }\n            ).catch(\n                error=>{\n                    console.log(error);\n                    \n                }\n            );\n    }\n\n    logout(){\n        sessionStorage.removeItem('token');\n    }\n\n    newContribution(){\n        // console.log(\"New Contribution onclick works\");\n        this.setState({\n            showContribution: true,\n            showCommunity: false,\n            showView: false,\n            showRiseAbove: false,\n        })\n    }\n\n    newNote(){\n        // console.log(\"New Note onclick works\");\n        this.setState({\n            showNote: true,\n            showView: false,\n            showRiseAbove : false,\n        })\n    }\n\n    newView(){\n        // console.log(\"New View onclick works\"); \n        this.setState({\n            showView: true,\n            showRiseAbove : false,\n            showNote : false,\n            showModel: true, \n        })\n    }\n\n    newRiseAbove(){\n        // console.log(\"New RiseAbove onclick works\");\n        this.setState({\n            showView: false,\n            showNote : false,\n            showRiseAbove : true,\n            showModel: true,\n        }) \n    }\n    \n    //HANDLE MODEL\n    handleShow(value){\n        this.setState({\n            showModel: value,\n        });\n        \n    }\n\n    handleShowNoteContent(value){\n        this.setState({\n            showView: false,\n            showNote : false,\n            showRiseAbove : false,\n        });\n        \n    }\n\n    showContent(event, id){\n        let isChecked = event.target.checked;\n        this.setState({\n            showNoteContent : true,\n        });\n        \n        if (isChecked) {\n            var myArray = this.noteData1;\n            myArray.map((object)=>{\n                if(object._id && object._id===id){\n                    this.noteContnetNew.push(object);\n                    this.setState({\n                        noteContnetList : this.noteContnetNew,\n                    })\n                    // console.log(\"STATE DATA\", this.state.noteContnetList);\n                    \n                }\n                return null;\n            });\n            \n        } else {\n            this.noteContnetNew.filter(obj => obj._id.includes(id)).map(filteredObj => {\n                this.noteContnetNew.pop(filteredObj)\n                return null;\n            });\n            this.setState({\n                noteContnetList : this.noteContnetNew,\n            })\n        }\n               \n    }\n\n    //CLOSE NOTE\n    closeNote = (id) => {\n        if (this.state.noteContnetList){\n            let noteArray = [...this.state.noteContnetList];\n        \n            if(noteArray){             \n                noteArray.filter(obj => obj._id.includes(id)).map(filteredObj => {\n                    noteArray.pop(filteredObj);\n                    this.setState({\n                        noteContnetList : [...noteArray],\n                    });\n                    // this.refs[id]\n                    // console.log(\"Check refs\",this.refs[id]);\n                    return null;\n                    \n                });\n            }\n        }       \n        \n    }\n\n\n    filterNotes = (query) => {\n        // console.log(\"filterNotes\", query);\n        let filteredResults=[];\n        filteredResults = this.noteData1.filter(function (obj) {\n            if (obj.data && obj.data.English){                      \n                return obj.data.English.includes(query);\n            }\n            return null;\n        });\n        this.setState({\n            filteredData : filteredResults,\n        });\n        \n    }\n\n\n    changeView(viewObj){\n        // console.log(\"viewId\",viewObj.obj._id);\n        this.setState({\n            viewId: viewObj.obj._id,\n        })\n        sessionStorage.setItem(\"viewId\", viewObj.obj._id);\n        sessionStorage.setItem(\"viewTitle\", viewObj.obj.title);\n        this.handleShow(false);\n        window.location.reload();\n        \n    }\n\n    onConfirmDrawDialog(drawing){\n        this.props.addDrawing(drawing);\n        this.props.closeDrawDialog();\n    }\n\n    onCloseDialog(dlg){\n        this.props.removeNote(dlg.noteId);\n        this.props.closeDialog(dlg.id);\n    }\n\n    handleInputChange = (event) => {\n        this.setState({\n            query : event.target.value,\n        });\n\n        let filteredResults=[];\n        if(this.state.query || this.state.filter){\n            switch (this.state.filter) {\n                case \"title\":\n                    this.state.viewLinks.filter(obj => obj._to.title.includes(this.state.query)).map(filteredObj => {\n                        filteredResults.push(filteredObj);\n                        return null;\n                    })\n                    break;\n                \n                case \"content\":\n                    filteredResults = this.noteData1.filter(function (obj) {\n                        if (obj.data && obj.data.English){                      \n                            return obj.data.English.includes(event.target.value);\n                        }\n                        else if(obj.data && obj.data.body){\n                            return obj.data.body.includes(event.target.value);\n                        }\n                        else {\n                            return null;\n                        }\n                    });\n                    \n                    break;\n                \n                case \"author\":\n                    // console.log(\"Author\", this.state.query);\n                    // console.log(\"State authors\", this.state.authors);\n                    var authorId =[];\n\n                    this.state.authors.map(obj=>{\n                        if(obj.firstName.toLowerCase().includes(this.state.query.toLowerCase()) || obj.lastName.toLowerCase().includes(this.state.query.toLowerCase())){\n                            // console.log(\"Matched\", obj._id);\n                            authorId.push(obj._id);   \n                        }\n                        return null;\n                    });\n                    \n                    authorId.forEach(element => {\n                        filteredResults = this.noteData1.filter(obj => obj.authors.includes(element)).map(filteredObj=>{\n                            return filteredObj; \n                        });\n                    });\n                    \n\n                    break;\n                case \"scaffold\":\n                    //GET SCAFFOLD TITLES\n                    let scaffoldTitle = [];\n                    this.state.scaffolds.map(\n                        element => {\n                            element.map(\n                                obj =>{\n                                    scaffoldTitle.push(obj._to.title);\n                                    return null;\n                                });\n                                return null;\n                        }\n                    );\n\n                    this.setState({\n                        scaffoldsTitle : scaffoldTitle,\n                    });\n                    \n                    \n                    \n                    break;\n            \n                default:\n                    break;\n            }\n        }\n        \n        this.setState({\n            filteredData : filteredResults,\n        })\n      };\n\n\n    handleFilter = (e) => {\n        let value = e.target.value;\n        this.setState({\n            filter: value,\n        });\n    }\n\n    buildOn = (buildOn) => {\n        sessionStorage.setItem(\"buildOn\", buildOn);\n        this.props.newNote(this.props.view, this.props.communityId, this.props.author._id) ;       \n    }\n\n    openNote = (contribId) => {\n        this.props.openContribution(contribId)\n    }\n\n    render() {\n\n        return (\n            <>\n                <DialogHandler/>\n\n                    <div className=\"row min-width\">\n                        {/* LEFT NAVBAR */}\n                        <Col md=\"1\" sm=\"12\" className=\"pd-6-top\">\n                            \n                            <Row className=\"mrg-025\">\n                                <Col md=\"12\"sm=\"2\" xs=\"2\">\n                                    <DropdownButton drop=\"right\" variant=\"outline-info\" title={<i className=\"fas fa-plus-circle\"></i>}>\n                                        \n                                        <Dropdown.Item onClick={()=>this.props.newNote(this.props.view, this.props.communityId, this.props.author._id)}>\n                                                New Note\n                                        </Dropdown.Item>\n\n                                        <Dropdown.Item onClick={()=>this.newView()}>\n                                                new View\n                                        </Dropdown.Item>\n                                        \n                                        <Dropdown.Item onClick={()=>this.newRiseAbove()}>\n                                                New RiseAbove\n                                        </Dropdown.Item>\n                                    </DropdownButton>\n                                </Col>\n                            \n                            \n                            {/* <Toolbar></Toolbar>*/}\n                            <Col md=\"12\"sm=\"2\" xs=\"2\">\n                                <DropdownButton drop=\"right\" variant=\"outline-info\" title={<i className=\"fa fa-pencil\"></i>}>\n                    \n                                </DropdownButton>\n                            </Col>\n                            <Col md=\"12\"sm=\"2\" xs=\"2\">\n                                <DropdownButton drop=\"right\" variant=\"outline-info\" title={<i className=\"fas fa-file\"></i>}>\n                    \n                                </DropdownButton>\n                            </Col>\n                            <Col md=\"12\"sm=\"2\" xs=\"2\">\n                                <DropdownButton drop=\"right\" variant=\"outline-info\" title={<i className=\"fas fa-hammer\"></i>}>\n                    \n                                </DropdownButton>\n                            </Col>\n                            \n                            <Col md=\"12\"sm=\"2\" xs=\"2\">\n                                <DropdownButton drop=\"right\" variant=\"outline-info\" title={<i className=\"fas fa-edit\"></i>}>\n                    \n                                </DropdownButton>\n                            </Col>\n\n                            </Row>\n                        </Col> \n                 \n                        \n                        {/* NOTES */}\n                        <Col md=\"5\" sm=\"12\" className=\"mrg-6-top pd-2-right v-scroll\">\n                        <Form className=\"mrg-1-bot\">\n                            <Row>\n                                <Col md=\"8\">\n                                    <FormGroup>\n                                    <Input\n                                        placeholder=\"Search Your Note\"\n                                        onChange={this.handleInputChange}\n                                    />\n                                    </FormGroup>\n                                </Col>\n                                <Col md=\"4\">\n                                    <FormGroup>\n                                        <Input type=\"select\" name=\"filter\" id=\"filter\" onChange={this.handleFilter}>\n                                            <option key=\"title\" value=\"title\">Search By Title</option>\n                                            <option key=\"scaffold\" value=\"scaffold\">Search By Scaffold</option>\n                                            <option key=\"content\" value=\"content\">Search By Content</option>\n                                            <option key=\"author\" value=\"author\">Search By Author</option>\n                                        </Input>\n                                    </FormGroup>\n                                </Col>\n                            </Row>\n                        </Form> \n                        {this.state.query === \"\"? \n                        (<>\n                            {this.state.hNotes.map((obj, i) => {\n                            return <Row key={i} className=\"mrg-05-top\">\n                                <Col className=\"mr-auto primary-bg-200 rounded mrg-1-bot\">\n                                    {obj._to && obj._to.title && obj._to.created ?(<>\n                                        <Row className=\"pd-05\">\n                                            <Col md=\"10\" className=\"primary-800 font-weight-bold\">{obj._to.title}</Col>\n                                            <Col md=\"2\">\n                                            <Form className=\"mrg-1-min pd-2-right\">\n                                                <FormGroup>\n                                                    <Input type=\"checkbox\" ref= {obj.to} onChange={e => this.showContent(e, obj.to)}/>\n                                                </FormGroup>\n                                            </Form>\n                                            </Col>\n                                        </Row>\n                                    <Row className=\"primary-600 sz-075 pd-05\">\n                                        <Col><Author authorId ={obj._to.authors}/>&nbsp; {obj._to.created}</Col>\n                                        <Col md=\"2\">\n                                            <Button onClick={()=>this.buildOn(obj.to)}>BuildOn</Button>\n                                        </Col>\n                                    </Row>\n                                        </>)\n                                        :\n                                        (<>\n                                            {obj[0]? \n                                            (<>\n                                                <Row className=\"\">\n                                                <Col>\n                                                    <Row>\n                                                    {obj[0]._to && obj[0]._to.title && obj[0]._to.created ?\n                                                    (<>\n                                                        <Col>\n                                                            <Row className=\"pd-05\">\n                                                                <Col md=\"10\" className=\"primary-800 font-weight-bold\"> {obj[0]._to.title}</Col>\n                                                                <Col md=\"2\">\n                                                                    <Form className=\"mrg-1-min pd-2-right\">\n                                                                        <FormGroup>\n                                                                            <Input type=\"checkbox\" ref= {obj[0].to} onChange={e => this.showContent(e, obj[0].to)}/>\n                                                                        </FormGroup>\n                                                                    </Form>\n                                                                </Col>\n                                                                </Row>\n                                                            <Row className=\"primary-600 sz-075 pd-05\">\n                                                                <Col><Author authorId ={obj[0]._to.authors}/>&nbsp; {obj[0]._to.created}</Col>\n                                                                <Col md=\"2\">\n                                                                    <Button onClick={()=>this.buildOn(obj[0].to)}>BuildOn</Button>\n                                                                </Col>\n                                                                </Row>\n                                                        </Col>\n                                                    </>)\n                                                    :\n                                                    null}\n                                                    </Row>\n                                                \n                                                {obj.map((subObj,j)=>{\n                                                    return <Row key={j}>\n                                                        <Col md=\"1\">\n                                                        </Col>\n                                                        <Col>\n                                                            {obj[0] && obj[0]._to && obj[0]._to.title && subObj && subObj._from && subObj._from.created ?(<>\n                                                            <Row className=\"pd-05 border-left border-primary\">\n                                                                <Col className=\"primary-800 font-weight-bold\">{subObj._from.title}</Col>\n                                                                <Col md=\"2\">\n                                                                    <Form className=\"mrg-1-min\">\n                                                                        <FormGroup>\n                                                                            <Input className=\"pd-left\" type=\"checkbox\" ref= {subObj.from} onChange={e => this.showContent(e, subObj.from)}/>\n                                                                        </FormGroup>\n                                                                    </Form>\n                                                                </Col>\n                                                                </Row>\n                                                            <Row className=\"primary-600 sz-075 pd-05 border-left border-primary\">\n                                                                <Col><Author authorId ={subObj._from.authors}/>&nbsp; {subObj._from.created}\n                                                                </Col>\n                                                                <Col md=\"2\">\n                                                                    <Button onClick={()=>this.buildOn(subObj.from)}>BuildOn</Button>\n                                                                </Col>\n                                                            </Row></>):(<></>)}\n                                                        </Col>\n                                                    </Row>\n                                                            \n                                                })}\n                                                </Col>\n                                                </Row>\n                                            </>)\n                                            :\n                                            (<></>) }\n                                        </>)}                                    \n                                    \n                                    { obj._from && obj._from.title && obj._to.created ? \n                                        (<>\n                                            <Row>\n                                            <Col md=\"1\"></Col>\n                                            <Col>\n                                                <Row className=\"pd-05 border-left border-primary\"> \n                                                <Col className=\"primary-800 font-weight-bold\">{obj._from.title}</Col>\n                                                <Col md=\"2\">\n                                                <Form className=\"mrg-1-min\">\n                                                    <FormGroup>\n                                                        <Input className=\"pd-left\" type=\"checkbox\" ref= {obj.from} onChange={e => this.showContent(e, obj.from)}/>\n                                                    </FormGroup>\n                                                </Form>\n                                                </Col>\n                                                </Row>\n                                                <Row className=\"primary-600 sz-075 pd-05 border-left border-primary\">\n                                                    <Col><Author authorId ={obj._from.authors}/>&nbsp; {obj._from.created}</Col>\n                                                    <Col md=\"2\">\n                                                        <Button onClick={()=>this.buildOn(obj.from)}>BuildOn</Button>\n                                                    </Col>\n                                                </Row>\n                                            </Col>\n                                            </Row>\n                                        </>)\n                                        :(<>\n                                        </>)}                                     \n                                    \n                                </Col>\n                            </Row>\n                            }\n                            \n                            )}                            \n                        {this.state.viewLinks.map((obj, i) => {\n                            return <>\n                            {obj && obj._to.title?    \n                                (<>\n                                <Row key={i} value={obj.to} className=\"mrg-05-top\">\n                                    <Col className=\"primary-bg-200 rounded mrg-1-bot\">\n                                    <Row className=\"pd-05\">\n                                        <Col className=\"primary-800 font-weight-bold\"> {obj._to.title}</Col>\n                                        <Col md=\"2\">\n                                            <Form className=\"mrg-1-min pd-2-right\">\n                                                <FormGroup>\n                                                    <Input type=\"checkbox\" ref= {obj.to} onChange={e => this.showContent(e, obj.to)}/>\n                                                </FormGroup>\n                                            </Form>\n                                        </Col>\n                                        </Row>\n                                    <Row className=\"primary-600 sz-075 pd-05\">\n                                        <Col><Author authorId ={obj._to.authors}/>&nbsp; {obj._to.created}\n                                        </Col>\n                                        <Col md=\"3\">\n                                            <Button size='sm' onClick={()=>this.buildOn(obj.to)}>BuildOn</Button>\n                                            <Button size='sm' className='ml-1' onClick={() => this.openNote(obj.to)}><i className=\"fa fa-pencil\"></i></Button>\n                                        </Col>\n                                    </Row>\n                                    </Col>\n                                </Row>\n                                </>)\n                                :(<></>)\n                            }\n                            \n                            </>\n                            })}\n                        </>)\n                        :(<>\n\n                        <Row>\n                            {this.state.scaffoldsTitle &&  this.state.filter === \"scaffold\"? (\n                                <Col>\n                                    {this.state.scaffoldsTitle.map((obj, i) => {\n                                        return <Row key={i} className=\"scaffold-title\">\n                                            <Link onClick={()=>this.filterNotes(obj)} className=\"white\">{obj}</Link>\n                                        </Row>})}                                    \n                                </Col>\n                            ):null\n                            }\n                        </Row>\n\n                        {this.state.filteredData.map((obj, i) => {\n                            return <>\n                            {obj._to && obj._to.title?    \n                                (<>\n                                <Row key={i} value={obj.to} className=\"mrg-05-top\">\n                                    <Col className=\"primary-bg-200 rounded mrg-1-bot\">\n                                    <Row className=\"pd-05\">\n                                        <Col className=\"primary-800 font-weight-bold\"> {obj._to.title}</Col>\n                                        <Col md=\"2\">\n                                            <Form className=\"mrg-1-min pd-2-right\">\n                                                <FormGroup>\n                                                    <Input type=\"checkbox\" ref= {obj.to} onChange={e => this.showContent(e, obj.to)}/>\n                                                </FormGroup>\n                                            </Form>\n                                            </Col>\n                                        </Row>\n                                    <Row className=\"primary-600 sz-075 pd-05\">\n                                        <Col><Author authorId ={obj._to.authors}/>&nbsp; {obj._to.created}\n                                        </Col>\n                                        <Col md=\"2\">\n                                            <Button onClick={()=>this.buildOn(obj.to)}>BuildOn</Button>\n                                        </Col>\n                                        </Row>\n                                    </Col>\n                                </Row>\n                                </>)\n                                :(<>\n                                    {obj._id ? (<>\n                                        <Row key={i} value={obj._id} className=\"mrg-05-top\">\n                                        <Col className=\"primary-bg-200 rounded mrg-1-bot\">\n                                        <Row className=\"pd-05\">\n                                            <Col className=\"primary-800 font-weight-bold\"> {obj.title}</Col>\n                                            <Col md=\"2\">\n                                            <Form className=\"mrg-1-min pd-2-right\">\n                                                <FormGroup>\n                                                    <Input type=\"checkbox\" ref= {obj._id} onChange={e => this.showContent(e, obj._id)}/>\n                                                </FormGroup>\n                                            </Form>\n                                            </Col>\n                                            </Row>\n                                        <Row className=\"primary-600 sz-075 pd-05\">\n                                            <Col><Author authorId ={obj.authors}/>&nbsp; {obj.created}</Col>\n                                            <Col md=\"2\">\n                                                <Button onClick={()=>this.buildOn(obj._id)}>BuildOn</Button>\n                                            </Col>\n                                        </Row>\n                                        </Col>\n                                </Row>   \n                                    </>)\n                                :(<></>)}\n                                </>)\n                            }\n                            \n                            </>\n                            })}     \n\n                        </>)}                    \n                            \n                        </Col>\n                        \n                        {/* NOTE CONTENT */}\n                        {this.state.showNoteContent ? \n                        (<>\n                            <Col md=\"5\" sm=\"12\" className=\"mrg-6-top v-scroll\">\n                                <NoteContent noteContnetList = {this.state.noteContnetList} closeNote = {this.closeNote} query = {this.state.query} filter={this.state.filter}/>\n                            </Col>\n                        </>)\n                        :null\n                        }\n                        \n                    </div>\n                        \n                \n            \n            \n            {/* MODEL */}\n            <Modal show={this.state.showModel} onHide={()=>this.handleShow(false)}>\n                    {this.state.showContribution ?(\n                    <>\n                        <Modal.Header closeButton>\n                        <Modal.Title>Contributions</Modal.Title>\n                        </Modal.Header>\n                        <Modal.Body style={{'max-height': 'calc(100vh - 300px)', 'overflow-y': 'auto'}}>\n                            {this.state.hNotes.map((obj, i) => {\n                                return <Row key={i} value={obj.to} className=\"mrg-05-top\">\n                                    <Col className=\"mr-auto\">\n                                        <Row className=\"indigo\"> {obj._to.title}</Row>\n                                        <Row> {obj.to}</Row>\n                                        <Row className=\"pd-2-left blue\"> {obj._from.title}</Row>\n                                        <Row className=\"pd-2-left\"> {obj.from}</Row>\n                                        <hr/>\n                                    </Col>\n                                </Row>\n                            })}                            \n\n                            {this.state.viewLinks.map((obj, i) => {\n                            return <Row key={i} value={obj.to} className=\"mrg-05-top\">\n                                <Col>\n                                    <Row className=\"indigo\"> {obj._to.title}</Row>\n                                    <Row> {obj.to}</Row>\n                                    <hr/>\n                                </Col>\n                            </Row>\n                            })}\n                        </Modal.Body>\n                    </>) : null }\n\n                    {this.state.showView ?(\n                    <>\n                        <Modal.Header closeButton>\n                        <Modal.Title>\n                            <Row>\n                            <Col>Views</Col>\n                            </Row>\n                            <Row>\n                            <Col>\n                                <Row>\n                                <Form onSubmit={this.handleSubmitView} className=\"form\">\n                                    <Col>\n                                    <FormGroup>\n                                        <Label htmlFor=\"addView\" style={{fontSize:\"1rem\"}}>Add View</Label>\n                                        <Input type=\"text\" id=\"addView\" placeholder=\"Enter View Name\" name=\"addView\" value={this.state.addView} onChange={this.handleChangeView} />\n                                    </FormGroup>\n                                    </Col>\n                                    <Col>\n                                        <Button varient=\"secondary\" onClick={this.handleSubmitView}>Add</Button>\n                                    </Col>\n                                </Form>\n                                </Row>\n                            </Col>\n                            </Row>\n                        </Modal.Title>\n                        </Modal.Header>\n                        <Modal.Body style={{'max-height': 'calc(100vh - 210px)', 'overflow-y': 'auto'}}>\n                            {this.state.myViews.map((obj, i) => {\n                            return <Row key={i} value={obj.title} className=\"mrg-05-top\">\n                                <Col><Link onClick={()=>this.changeView({obj})}> {obj.title} </Link></Col>\n                            </Row>\n                            })}\n                        </Modal.Body>\n                    </>) : null }\n\n                    {this.state.showRiseAbove ?(\n                    <>\n                        <Modal.Header closeButton>\n                        <Modal.Title>\n                            <Row>\n                            <Col>New RiseAbove</Col>\n                            </Row>\n                        </Modal.Title>\n                        </Modal.Header>\n                        <Modal.Body style={{'max-height': 'calc(100vh - 210px)', 'overflow-y': 'auto'}}>\n                            <Form onSubmit={this.handleSubmit}>\n                                <Label htmlFor=\"riseAboveTitle\" style={{fontSize:\"1rem\"}}>RiseAbove Title</Label>\n                                <Input type=\"text\" id=\"riseAboveTitle\" placeholder=\"Enter RiseAbove Title\" name=\"riseAboveTitle\" value={this.state.riseAboveTitle} onChange={this.handleChange} />\n                                \n                                <Button className=\"mrg-1-top\" onClick={this.handleSubmit}>Submit</Button>\n                            </Form>\n                        </Modal.Body>\n                    </>) : null }\n\n                    {this.state.showNote ?(\n                    <>\n                        <Modal.Header closeButton>\n                        <Modal.Title>\n                            <Row>\n                            <Col>New Note</Col>\n                            </Row>\n                        </Modal.Title>\n                        </Modal.Header>\n                        <Modal.Body style={{'max-height': 'calc(100vh - 210px)', 'overflow-y': 'auto'}}>\n                            New Note\n                        </Modal.Body>\n                    </>) : null }\n\n\n                    <Modal.Footer>\n                    <Button variant=\"secondary\" onClick={()=>this.handleShow(false)}>\n                        Close\n                    </Button>\n                    </Modal.Footer>\n                </Modal>\n\n\n\n        </>\n        );\n    }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n    return {\n        communityId: state.globals.communityId,\n        viewId: state.globals.viewId,\n        view: state.globals.view,\n        author: state.globals.author\n    }\n}\n\nconst mapDispatchToProps = {\n    fetchAuthor,\n    fetchView,\n    fetchCommunity,\n    fetchAuthors,\n    setCommunityId,\n    setViewId,\n    newNote,\n    openContribution\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(View)\n","import React, {useEffect} from 'react';\nimport DialogHandler from '../dialogHandler/DialogHandler.js'\nimport {Button} from 'react-bootstrap'\nimport { useSelector, useDispatch } from 'react-redux';\nimport {newNote, openContribution} from '../../store/noteReducer.js'\nimport { fetchAuthor, fetchView, fetchCommunity} from '../../store/globalsReducer.js'\nimport { fetchAuthors } from '../../store/userReducer.js'\nconst NewNote = props => {\n\n    const communityId = useSelector((state) => state.globals.communityId)\n    const viewId = useSelector((state) => state.globals.viewId)\n    const view = useSelector((state) => state.globals.view)\n    const author = useSelector(state => state.globals.author);\n    const dispatch = useDispatch();\n    const createNewNote = () => {\n        dispatch(newNote(view, communityId, author._id))\n    };\n\n    const openNote = (contribId) => {\n        dispatch(openContribution('5ee2aefee028a1d4cfb07252'))\n    }\n\n    useEffect(() => {\n        dispatch(fetchAuthor(communityId));\n        dispatch(fetchView(viewId))\n        dispatch(fetchCommunity(communityId));\n        dispatch(fetchAuthors(communityId))\n    }, [dispatch, communityId, viewId]);\n\n    return (\n        <div style={{marginTop: '100px'}} >\n            <Button onClick={createNewNote}>New Note</Button>\n            <br />\n            <Button onClick={openNote}>Open Note</Button>\n            <DialogHandler/>\n        </div>\n    );\n}\n\nexport default NewNote;\n","import React, { Component } from 'react';\nimport Axios from 'axios';\nimport {Container, Col, Form, FormGroup, Label, Input, Button} from 'reactstrap';\nimport {apiUrl} from '../store/api.js';\n\nclass ChangePassword extends Component {\n    token= sessionStorage.getItem(\"token\");\n    constructor() {\n        super();\n\n        this.state = {\n            oldPassword: '',\n            newPassword: ''\n        };\n\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n    }\n\n    handleChange(e) {\n        let target = e.target;\n        let name = target.name;\n        let value = target.value;\n\n        this.setState({\n          [name]: value\n        });\n    }\n\n    handleSubmit(e) {\n        e.preventDefault();\n        \n        console.log('The form was submitted with:');\n        console.log(this.state);\n\n        var config = {\n            headers: { Authorization: `Bearer ${this.token}` }\n        };\n\n        var changePasswdUrl= `${apiUrl}/users/${sessionStorage.getItem(\"userId\")}/password`;\n\n        //LOGIN RETURNS TOKEN\n        Axios.put(changePasswdUrl,this.state,config)\n        .then(\n            result=>{\n                alert(\"Password is Successfully changed\");\n            }).catch(\n            error=>{\n                alert(error);\n            })\n    }\n\n    render() {\n        return (\n            <Container>\n            <div className=\"mrg-8-top\">\n                <Col>\n                    <h3>Change Password</h3>\n                </Col>\n                <Form onSubmit={this.handleSubmit} className=\"form\">\n                <Col>\n                <FormGroup>\n                    <Label htmlFor=\"oldPassword\">Current Password</Label>\n                    <Input type=\"password\" id=\"oldPassword\" placeholder=\"Enter Current Password\" name=\"oldPassword\" value={this.state.oldPassword} onChange={this.handleChange} />\n                </FormGroup>\n                </Col>\n                <Col>\n                <FormGroup>\n                    <Label htmlFor=\"newPassword\">New Password</Label>\n                    <Input type=\"password\" id=\"password\" placeholder=\"Enter New Password\" name=\"newPassword\" value={this.state.newPassword} onChange={this.handleChange} />\n                </FormGroup>\n                </Col>\n                <Col className=\"mrg-1-top\">\n                    <Button>Save</Button>\n                </Col>\n                </Form>\n            </div>    \n          </Container>\n        );\n    }\n}\n\nexport default ChangePassword;","import React, {useEffect} from 'react';\nimport AttachArea from '../attachmentArea/AttachArea.js'\nimport AttachPanel from '../attachmentCollapse/AttachPanel.js'\nimport { useSelector, useDispatch } from 'react-redux';\nimport { fetchAuthor } from '../../store/globalsReducer.js'\nimport { fetchAuthors } from '../../store/userReducer.js'\n\nconst TestComponent= props => {\n    const note = {id: 1, title:'hola', content: 'asdf', attachments: []}\n    const communityId = useSelector((state) => state.globals.communityId)\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n        console.log('use effect')\n        dispatch(fetchAuthors(communityId))\n        dispatch(fetchAuthor(communityId));\n    }, [dispatch, communityId]);\n\n    return (\n        <div style={{marginTop: '100px'}}>\n            <AttachArea note={note}></AttachArea>\n            <AttachPanel></AttachPanel>\n        </div>\n    )\n\n};\n\nexport default TestComponent;\n","import React, {useEffect} from 'react';\nimport { HashRouter as Router, Route} from 'react-router-dom';\nimport ReactNotification from 'react-notifications-component';\n\nimport Login from './Account/Login';\nimport SignUp from './Account/SignUp';\nimport CommunityManager from './CommunityManager/CommunityManager';\nimport TopNavbar from './TopNavBar/TopNavbar';\nimport View from './View/View';\nimport NewNote from './components/newNote/NewNote'\nimport ChangePassword from './Account/ChangePassword';\nimport TestComponent from './components/test/TestComponent';\nimport { setToken } from './store/api.js';\n\nimport 'react-notifications-component/dist/theme.css'\nimport './App.css';\n\nfunction App() {\n    \n    useEffect(()=> {\n        const token = sessionStorage.getItem('token');\n        if (token){\n            setToken(token)\n        }\n    })\n\n    return (\n        <div>\n            <ReactNotification />\n            <TopNavbar></TopNavbar>\n            <Router>\n                <Route exact path=\"/\" component={Login}>\n                </Route>\n                <Route path=\"/signup\" component={SignUp}>\n                </Route>\n                <Route path=\"/community-manager\" component={CommunityManager}>\n                </Route>\n                <Route path=\"/view\" component={View}>      \n                </Route>\n                <Route path=\"/new-note\" component={NewNote}>\n                </Route>\n                <Route path=\"/change-password\" component={ChangePassword}>      \n                </Route>\n                <Route path=\"/test\" component={TestComponent}>\n                </Route>\n            </Router>\n        </div>\n    );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './index.css';\nimport App from './App';\nimport store from './store/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\n\n/* ReactDOM.render(\n *   <React.StrictMode>\n *     <App />\n *   </React.StrictMode>,\n *   document.getElementById('root')\n * ); */\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>,\n    document.getElementById('root')\n);\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}