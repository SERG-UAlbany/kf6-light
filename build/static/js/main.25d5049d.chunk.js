(this["webpackJsonpkf6-light"]=this["webpackJsonpkf6-light"]||[]).push([[0],{132:function(e,t,a){e.exports=a(185)},138:function(e,t,a){},166:function(e,t,a){},167:function(e,t,a){},168:function(e,t,a){},169:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},180:function(e,t,a){},184:function(e,t,a){},185:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(24),c=a.n(o),l=(a(137),a(138),a(47)),i=a(51),s=a(63),u=a.n(s),m=a(7),d=a(15),h=a(16),p=a(8),f=a(17),g=a(18),b=a(9),E=a.n(b),v=a(190),y=a(191),w=a(192),k=a(193),C=a(194),N=a(195),O=a(196),S=a(12),I=a.n(S),j=a(23),_="https://kf6-stage.ikit.org",T="".concat(_,"/api");function x(e){E.a.defaults.headers.common.Authorization="Bearer ".concat(e)}var A=sessionStorage.getItem("token");A&&x(A);var D,F,L,R,V,M=function(e){return E.a.get("".concat(T,"/communities/").concat(e))},B=function(){var e=Object(j.a)(I.a.mark((function e(t,a,n){var r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(T,"/links/").concat(a,"/").concat(t));case 2:return r=(r=e.sent).data,n&&(r=r.filter((function(e){return e.type===n}))),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),P=function(){var e=Object(j.a)(I.a.mark((function e(t,a,n,r){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("".concat(T,"/links"),{from:t,to:a,type:n,data:r});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.delete("".concat(T,"/links/").concat(t)).data;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(e){return E.a.get("".concat(T,"/objects/").concat(e))},K=function(){var e=Object(j.a)(I.a.mark((function e(t,a,n){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.put("".concat(T,"/objects/").concat(a,"/").concat(n),t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),U=function(e,t){var a={communityId:e,type:"Attachment",title:"an Attachment",authors:[t],status:"unsaved",permission:"protected",data:{version:0}};return E.a.post("".concat(T,"/contributions/").concat(e),a)},q=function(){var e=Object(j.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(T,"/communities/").concat(t,"/authors"));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(j.a)(I.a.mark((function e(t){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(T,"/records/object/").concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e,t){var a=new FormData;return a.append("file",e),E.a.post("".concat(T,"/upload"),a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t})},Y=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).state={userName:"",password:""},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(m.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state),E.a.post("".concat(_,"/auth/local"),this.state).then((function(e){console.log(e.data.token),t.token=e.data.token,sessionStorage.setItem("token",t.token),x(t.token),t.props.history.push("/community-manager")})).catch((function(e){}))}},{key:"render",value:function(){return r.a.createElement(v.a,null,r.a.createElement("div",{className:"mrg-4-top"},r.a.createElement(y.a,null,r.a.createElement("h3",null,"Login")),r.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"form"},r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"userName"},"Username"),r.a.createElement(N.a,{type:"text",id:"userName",placeholder:"Enter Username",name:"userName",value:this.state.userName,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"password"},"Password"),r.a.createElement(N.a,{type:"password",id:"password",placeholder:"Enter Password",name:"password",value:this.state.password,onChange:this.handleChange}))),r.a.createElement(y.a,{className:"mrg-1-top"},r.a.createElement(O.a,null,"Login")),r.a.createElement(y.a,{className:"mrg-1-top"},r.a.createElement(l.b,{to:"/signup"},"If you don't have an account, please SignUp")))))}}]),a}(n.Component),J=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).state={firstName:"",lastName:"",email:"",userName:"",password:"",registrationKey:""},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(m.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state),E.a.post("".concat(T,"/users"),this.state).then((function(e){console.log(e.data.token),t.token=e.data.token,sessionStorage.setItem("token",t.token),t.props.history.push("/community-manager")})).catch((function(e){e.message&&(console.log(e.message),alert("Enter Valid Username and Password"))}))}},{key:"render",value:function(){return r.a.createElement(v.a,null,r.a.createElement("div",{className:"mrg-4-top"},r.a.createElement(y.a,null,r.a.createElement("h3",null,"SignUp")),r.a.createElement(w.a,{onSubmit:this.handleSubmit,class:"form"},r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"firstName"},"First Name"),r.a.createElement(N.a,{type:"text",id:"firstName",placeholder:"Enter First Name",name:"firstName",value:this.state.firstName,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"lastName"},"Last Name"),r.a.createElement(N.a,{type:"text",id:"lastName",placeholder:"Enter Last Name",name:"lastName",value:this.state.lastName,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"email"},"Email"),r.a.createElement(N.a,{type:"email",id:"email",placeholder:"Enter Email",name:"email",value:this.state.email,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"userName"},"Username"),r.a.createElement(N.a,{type:"text",id:"userName",placeholder:"Enter Username",name:"userName",value:this.state.userName,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"password"},"Password"),r.a.createElement(N.a,{type:"password",id:"password",placeholder:"Enter Password",name:"password",value:this.state.password,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(O.a,{className:""},"New Account")),r.a.createElement(y.a,{className:"mrg-1-top"},r.a.createElement(l.b,{to:"/",className:"FormField__Link"},"If you already have an account, please Signin")))))}}]),a}(n.Component),Q=a(197),X=a(114),$=a(13),Z=a(11),ee=Object(Z.b)("SET_COMMUNITY"),te=Object(Z.b)("SET_COMMUNITY_ID"),ae=Object(Z.b)("SET_VIEW_ID"),ne=Object(Z.b)("SET_AUTHOR"),re=Object(Z.b)("SET_VIEW"),oe={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0},ce={communityId:sessionStorage.getItem("communityId"),viewId:sessionStorage.getItem("viewId"),contextId:"",author:{},view:null,community:null},le=Object(Z.c)(ce,(D={},Object(m.a)(D,te,(function(e,t){e.communityId=t.payload})),Object(m.a)(D,ae,(function(e,t){e.viewId=t.payload})),Object(m.a)(D,ne,(function(e,t){e.author=t.payload})),Object(m.a)(D,re,(function(e,t){e.view=t.payload})),Object(m.a)(D,ee,(function(e,t){e.community=t.payload,e.contextId=t.payload.rootContextId})),D)),ie=function(e){return function(t){return function(e){return E.a.get("".concat(T,"/authors/").concat(e,"/me"))}(e).then((function(e){t(ne(e.data))}))}},se=function(e){return function(t){return H(e).then((function(e){t(re(e.data))}))}},ue=function(e){return function(t){return M(e).then((function(e){t(ee(e.data))}))}},me=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).token=sessionStorage.getItem("token"),n.myRegistrations=[],n.config={headers:{Authorization:"Bearer ".concat(n.token)}},n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;console.log(a,r),n.setState(Object(m.a)({},a,r))},n.state={communitites:[],password:"",communityId:"",welcomeId:"",userId:sessionStorage.getItem("userId"),token:sessionStorage.getItem("token"),registrations:[]},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("FORM",this.state);var t="".concat(T,"/authors"),a={communityId:this.state.communityId,registrationKey:this.state.password,userId:this.state.userId},n={headers:{Authorization:"Bearer ".concat(this.state.token)}};E.a.post(t,a,n).then((function(e){console.log("AUTHOR",e.data),window.location.reload()})).catch((function(e){}))}},{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat(T,"/communities")).then((function(t){e.communityData=t.data,console.log(e.communityData),e.setState({communitites:t.data})})).catch((function(e){console.log("GET Communities Failed"),alert("GET Communities Failed")})),E.a.get("".concat(T,"/users/myRegistrations"),this.config).then((function(t){console.log("registrations"),console.log(t.data),e.myRegistrations=t.data,e.setState({registrations:t.data})})).catch((function(e){alert(e)}))}},{key:"enterCommunity",value:function(e){var t=this,a=e.obj.communityId;sessionStorage.setItem("communityId",e.obj.communityId),this.props.setCommunityId(a);var n={communityId:a,welcomeId:""},r={headers:{Authorization:"Bearer ".concat(this.token)}},o="".concat(T,"/communities/").concat(a,"/views");console.log(o),E.a.get(o,r).then((function(e){n.welcomeId=e.data[0]._id,sessionStorage.setItem("viewId",e.data[0]._id),t.props.setViewId(e.data[0]._id),t.props.history.push({pathname:"/view",state:n})})).catch((function(e){alert(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,null,r.a.createElement("div",{className:"mrg-4-top"},r.a.createElement(v.a,{className:"mrg-2-top"},r.a.createElement("h6",null,"My Knowledge Building Communities"),this.state.registrations.map((function(t,a){return r.a.createElement(Q.a,{key:a,value:t.communityId,className:"mrg-05-top"},r.a.createElement(y.a,null,t._community.title),r.a.createElement(y.a,null,r.a.createElement(X.a,{variant:"outline-secondary",onClick:function(){return e.enterCommunity({obj:t})}},"Enter Community")))}))),r.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"form"},r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,null,"Register Community"),r.a.createElement(N.a,{type:"select",name:"communityId",id:"communityId",value:this.state.communityId,onChange:this.handleChange},this.state.communitites.map((function(e){return r.a.createElement("option",{key:e._id,value:e._id},e.title)})))),r.a.createElement(k.a,null,r.a.createElement(C.a,null,"Registration Key"),r.a.createElement(N.a,{type:"password",name:"password",placeholder:"Enter Registration Key",id:"password",value:this.state.password,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(X.a,{variant:"secondary",onClick:this.handleSubmit},"Submit")))))}}]),a}(n.Component),de={setCommunityId:te,setViewId:ae},he=Object($.b)((function(e,t){return{}}),de)(me),pe=a(207),fe=a(130),ge=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).state={loggedIn:!!sessionStorage.getItem("token"),userName:null,token:sessionStorage.getItem("token"),myViews:[],viewId:sessionStorage.getItem("viewId")?sessionStorage.getItem("viewId"):"",viewTitle:sessionStorage.getItem("viewTitle")?sessionStorage.getItem("viewTitle"):"welcome",communityId:sessionStorage.getItem("communityId")},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t={headers:{Authorization:"Bearer ".concat(this.state.token)}};if(E.a.get("".concat(T,"/users/me"),t).then((function(t){e.setState({userName:t.data.firstName+" "+t.data.lastName}),sessionStorage.setItem("userId",t.data._id)})).catch((function(e){})),this.state.communityId){var a="".concat(T,"/communities/").concat(this.state.communityId,"/views");E.a.get(a,t).then((function(t){e.setState({myViews:t.data})})).catch((function(e){}))}}},{key:"logout",value:function(){sessionStorage.removeItem("token"),delete E.a.defaults.headers.common.Authorization;for(var e=sessionStorage.length;e--;){var t=sessionStorage.key(e);/foo/.test(t)&&sessionStorage.removeItem(t)}}},{key:"handleChange",value:function(e){var t=this;e.persist();var a=e.target,n=a.value;sessionStorage.setItem("viewId",n),this.setState({viewId:n});var r={headers:{Authorization:"Bearer ".concat(this.state.token)}},o="".concat(T,"/objects/").concat(a.value);E.a.get(o,r).then((function(e){console.log(e.data),t.setState({viewTitle:e.data.title}),sessionStorage.setItem("viewTitle",e.data.title)})).catch((function(e){alert(e)}))}},{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state)}},{key:"render",value:function(){return r.a.createElement(pe.a,{bg:"dark",variant:"dark",fixed:"top"},r.a.createElement(pe.a.Brand,{href:"#community-manager"},"KF6 Light"),this.state.loggedIn?r.a.createElement(fe.a,{className:"mr-auto"},r.a.createElement("span",{className:"mrg-105-top white"},this.state.viewTitle),r.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"mrg-1-top"},r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"select",name:"viewId",value:this.state.viewId,onChange:this.handleChange},this.state.myViews.map((function(e){return r.a.createElement("option",{key:e._id,value:e._id}," ",e.title," ")}))))))):r.a.createElement(fe.a,{className:"mr-auto"},r.a.createElement(fe.a.Link,{href:"#signup"},"Signup"),r.a.createElement(fe.a.Link,{href:"/"},"Login")),this.state.loggedIn?r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a.Link,{href:"#change-password"},r.a.createElement("i",{className:"fas fa-cog white"})),r.a.createElement("span",{className:"white"}," ",this.state.userName," "),r.a.createElement(X.a,{variant:"outline-secondary",href:"/",onClick:this.logout},"Logout")):null)}}]),a}(n.Component),be=a(49),Ee=a(121),ve=a(200),ye=a(203),we=a(93),ke=a(205),Ce=a(44),Ne=a(29),Oe=Object(Z.b)("OPEN_DIALOG"),Se=Object(Z.b)("CLOSE_DIALOG"),Ie=Object(Z.b)("OPEN_DRAW_DIALOG"),je=Object(Z.b)("CLOSE_DRAW_DIALOG"),_e=Object(Z.b)("FOCUS_DIALOG"),Te=Object(Z.b)("OPEN_ATTACH_PANEL"),xe=Object(Z.b)("CLOSE_ATTACH_PANEL"),Ae=0,De=Object(Z.c)({dialogs:[],drawTool:null,focused:null,attachPanel:{}},(F={},Object(m.a)(F,Oe,(function(e,t){var a=e.dialogs.map((function(t){return t.id===e.focused&&(t.zIndex=1e3),t}));e.focused=Ae,e.dialogs=[].concat(Object(be.a)(a),[Object(Ne.a)({id:Ae++,zIndex:1100},t.payload)])})),Object(m.a)(F,Se,(function(e,t){e.dialogs=e.dialogs.filter((function(e){return e.id!==t.payload}))})),Object(m.a)(F,Ie,(function(e,t){e.drawTool=t.payload})),Object(m.a)(F,je,(function(e,t){e.drawTool=null})),Object(m.a)(F,Te,(function(e,t){e.attachPanel=t.payload})),Object(m.a)(F,xe,(function(e,t){e.attachPanel={}})),Object(m.a)(F,_e,(function(e,t){e.focused!==t.payload&&(e.dialogs=e.dialogs.map((function(a){return a.id===e.focused?a.zIndex=1e3:a.id===t.payload&&(a.zIndex=1100),a})),e.focused=t.payload)})),F)),Fe=a(54),Le=a.n(Fe),Re=function(e,t){var a="";return a+=" ",a+=t?'<span class="kfSupportStartMark kfTemplateStartMark"> &nbsp; </span>':'<span class="kfSupportStartMark"> &nbsp; </span>',a+=" ",a=t?a+'<span class="kfSupportStartLabel kfTemplateStartLabel">'+e+"</span>":a+'<span class="kfSupportStartLabel">'+e+"</span>",a+=" "},Ve=function(e){var t="";return t+=" ",t+=e?'<span class="kfSupportEndMark kfTemplateEndMark"> &nbsp; </span>':'<span class="kfSupportEndMark"> &nbsp; </span>',t+=" "},Me=function(e,t,a,n){var r="";return n&&n.length>0&&(r=r+'<span class="KFReferenceQuote"><span>"</span><span class="KFReferenceText">'+n+'</span><span>"</span></span>'),r=(r=r+'<span> (<a href="contribution/'+e+'" target="'+e+'">')+'<img src="/manual_assets/kf4images/icon-note-unread-othr-.gif">"'+t+'"</a>',r+='<span class="KFReferenceAuthor"> by (missing authors)</span>)</span>',r+="</span>"},Be=function(e,t,a){var n="<div>"+e+"</div>",r=Le()(n),o=r.find(".KFSupportStart");o.addClass("mceNonEditable");for(var c=function(e){var a=o[e];if(!a.id.startsWith("supportid_")){var n=Le()(a).hasClass("KFTemplateStart"),r=t.filter((function(e){return e._id===a.id}));r.length?a.innerHTML=Re(r[0]._from.title,n):"Annotation"!==t&&(a.innerHTML=Re("(missing link)",n))}},l=0;l<o.length;l++)c(l);var i=r.find(".KFSupportEnd");i.addClass("mceNonEditable");for(var s=0;s<i.length;s++){var u=i[s],m=Le()(u).hasClass("KFTemplateEnd");u.innerHTML=Ve(m)}var d=r.find(".KFReference");d.addClass("mceNonEditable");for(var h=function(e){var t=i[e],n=a.filter((function(e){return e._id===t.id}));if(n.length){var r="";(n=n[0]).data&&(r=n.data.text),t.innerHTML=Me(n.to,n._to.title,n._to.authors,r)}else t.innerHTML=Me("","(missing link)",0,"")},p=0;p<d.length;p++)h(p);return r.html()},Pe=function(){var e=Object(j.a)(I.a.mark((function e(t,a,n,r,o){var c,l,i,s,u,m,d,h,p,f,g,b,E,v,y,w,k,C,N,O;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c="<div>"+t+"</div>",l=Le()(c),i={},s=n.filter((function(e){return"supports"===e.type})).map((function(e){return e._id})),u=l.find(".KFSupportStart"),m=l.find(".KFSupportEnd"),d=[],h=[],p=0;p<m.length;p++)(f=m[p]).innerHTML="",g=f.id,i[g]=f;for(b=function(e){var t=u[e],n=t.id;t.innerHTML="",n.startsWith("supportid_")&&(n=n.split("_")[1]),h.push(n),s.includes(n)||d.push(P(n,a,"supports").then((function(e){var a=t.id,n=e._id;t.id=n,i[a]&&(i[a].id=n)})))},E=0;E<u.length;E++)b(E);for(v=s.filter((function(e){return!h.includes(e)})).map((function(e){return z(e)})),y=r.filter((function(e){return"references"===e.type})).map((function(e){return e._id})),w=l.find(".KFReferenceText"),k=[],C=function(){var e=w[N],t={text:Le()(e).find(".KFReferenceText").html()};e.innerHTML="";var n=e.id;k.push(n),y.includes(n)||d.push(P(a,n,"references",t).then((function(t){var a=e.id,n=t._id;e.id=n,i[a]&&(i[a].id=n)})))},N=0;N<w.length;N++)C();return O=y.filter((function(e){return!k.includes(e)})).map((function(e){return z(e)})),e.next=20,Promise.all(v);case 20:return e.next=22,Promise.all(O);case 22:return e.next=24,Promise.all(d);case 24:return e.abrupt("return",l);case 25:case"end":return e.stop()}}),e)})));return function(t,a,n,r,o){return e.apply(this,arguments)}}(),ze={type:"success",insert:"top",container:"top-right",animationIn:["animated","fadeIn"],animationOut:["animated","fadeOut"],dismiss:{duration:5e3}},He=function(e){return s.store.addNotification(Object(Ne.a)({},ze,{},e))},Ke=Object(Z.b)("ADD_NOTE"),Ue=Object(Z.b)("REMOVE_NOTE"),qe=Object(Z.b)("EDIT_NOTE"),We=Object(Z.b)("ADD_DRAWING"),Ge=Object(Z.b)("REMOVE_DRAWING"),Ye=Object(Z.b)("EDIT_SVG"),Je=Object(Z.b)("ADD_ATTACHMENT"),Qe=Object(Z.b)("REMOVE_ATTACHMENT"),Xe=Object(Z.b)("SET_ATTACHMENTS"),$e=Object(Z.b)("SET_WORDCOUNT"),Ze=Object(Z.b)("SET_CONNECTIONS"),et=Object(Z.b)("SET_RECORDS"),tt=Object(Z.b)("REMOVE_CONTRIB_AUTHOR"),at=Object(Z.b)("ADD_CONTRIB_AUTHOR"),nt=Object(Z.c)({drawing:"",attachments:{}},(L={},Object(m.a)(L,Ke,(function(e,t){e[t.payload._id]=t.payload})),Object(m.a)(L,Ue,(function(e,t){delete e[t.payload]})),Object(m.a)(L,qe,(function(e,t){var a=e[t.payload._id];e[t.payload._id]=Object.assign({},a,t.payload)})),Object(m.a)(L,We,(function(e,t){e.drawing=t.payload})),Object(m.a)(L,Ge,(function(e,t){e.drawing=""})),Object(m.a)(L,Ye,(function(e,t){e[t.payload.noteId].editSvg=t.payload.svg})),Object(m.a)(L,Je,(function(e,t){e[t.payload.noteId].attachments.push(t.payload.attachment._id),e.attachments[t.payload.attachment._id]=t.payload.attachment})),Object(m.a)(L,Qe,(function(e,t){var a=e[t.payload.noteId];a.attachments=a.attachments.filter((function(e){return e.id!==t.payload.attId}))})),Object(m.a)(L,Xe,(function(e,t){e[t.payload.contribId].attachments=t.payload.attachments.map((function(e){return e._id})),t.payload.attachments.forEach((function(t){e.attachments[t._id]=t}))})),Object(m.a)(L,$e,(function(e,t){e[t.payload.contribId].wordCount=t.payload.wc})),Object(m.a)(L,Ze,(function(e,t){var a=e[t.payload.contribId];"from"===t.payload.direction?a.fromLinks=t.payload.links:a.toLinks=t.payload.links})),Object(m.a)(L,et,(function(e,t){e[t.payload.contribId].records=t.payload.records})),Object(m.a)(L,at,(function(e,t){var a=e[t.payload.contribId];a.authors=[].concat(Object(be.a)(a.authors),[t.payload.author])})),Object(m.a)(L,tt,(function(e,t){var a=e[t.payload.contribId];a.authors=a.authors.filter((function(e){return e!==t.payload.author}))})),L)),rt=function(e,t,a){return function(n){var r={permission:e.permission,group:e.group,_groupMembers:e._groupMembers},o=null===sessionStorage.getItem("buildOn")?function(e,t,a,n,r){if(r||(r=""),!a||a.permission){var o={};a&&"private"===a.permission?(o.permission=a.permission,o.group=a.group,o._groupMembers=a._groupMembers):(o.permission="protected",o.group=void 0,o._groupMembers=[]);var c={communityId:e,type:"Note",title:a&&a.title?a.title:"",authors:[t],status:a&&a.status?a.status:"unsaved",permission:o.permission,group:o.group,_groupMembers:o._groupMembers,data:{body:a&&a.body?a.body:""},buildson:n,langInNote:[]};if(a&&a.docId){c.docId=a.docId;var l=c.authors[0];if(a.coauthors)for(var i=a.coauthors.split(","),s=0;s<i.length;s++)i[s]!==l&&c.authors.push(i[s]);a.createdBy&&(c.createdBy=a.createdBy),c.docShared=[l],c.text4search=a.text4search}return c}window.alert("invalid mode object")}(t,a,r):{authors:a,buildson:sessionStorage.getItem("buildOn"),communityId:t,data:{body:""},permission:e.permission,status:"unsaved",title:"",type:"Note",_groupMembers:[]};return o&&sessionStorage.removeItem("buildOn"),function(e,t){return E.a.post("".concat(T,"/contributions/").concat(e),t)}(t,o).then((function(t){var a=Object(Ne.a)({attachments:[],fromLinks:[],toLinks:[],records:[]},t.data);P(e._id,a._id,"contains",{x:100,y:100}),n(Ke(a)),n(Oe({title:"New Note",confirmButton:"create",noteId:a._id}))}))}},ot=function(e){return function(){var t=Object(j.a)(I.a.mark((function t(a){var n,r,o;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B(e,"from","attach");case 2:return n=t.sent,r=n.map((function(e){return H(e.to)})),t.next=6,Promise.all(r);case 6:o=(o=t.sent).map((function(e){return e.data})),a(Xe({contribId:e,attachments:o}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ct=function(e,t){return function(){var a=Object(j.a)(I.a.mark((function a(n){var r;return I.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,B(e,t);case 2:r=a.sent,n(Ze({contribId:e,direction:t,links:r}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},lt=function(e){return function(){var t=Object(j.a)(I.a.mark((function t(a,n){var r,o,c,l,i,s,u;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([H(e),B(e,"from"),B(e,"to")]);case 2:r=t.sent,o=Object(Ce.a)(r,3),c=o[0],l=o[1],i=o[2],s=Object(Ne.a)({attachments:[],fromLinks:l,toLinks:i,records:[]},c.data),u=Be(s.data.body,i,l),s.data.body=u,a(Ke(s)),a(ot(e)),a(Oe({title:"Edit Note",confirmButton:"edit",noteId:s._id})),"active"===s.status&&(n=s.communityId,m=s._id,E.a.post("".concat(T,"/records/read/").concat(n,"/").concat(m)));case 14:case"end":return t.stop()}var n,m}),t)})));return function(e,a){return t.apply(this,arguments)}}()},it=a(116),st=a(209),ut=(a(166),{zIndex:999,display:"flex"}),mt=function(e){return r.a.createElement(it.a,{className:"contrib-dialog",style:Object(Ne.a)({},ut,{},e.style),default:{x:400,y:50,width:920,height:500},onClick:e.onClick,onMouseDown:e.onMouseDown,dragHandleClassName:"dlg-card-header",bounds:"window"},r.a.createElement(st.a,{className:"dlg-card"},r.a.createElement(st.a.Header,{className:"dlg-card-header py-0",style:{alignItems:"center",display:"flex"}},r.a.createElement("span",null,e.title),r.a.createElement(X.a,{onClick:e.onClose,variant:"link",size:"sm",style:{marginLeft:"auto"}},"x")),r.a.createElement(st.a.Body,{className:"dlg-card-body",style:{overflow:"scroll"}},e.children),r.a.createElement(st.a.Footer,{className:"dlg-card-footer py-0"},r.a.createElement(X.a,{size:"sm",className:"dlg-confirm-button",onClick:e.onConfirm},e.confirmButton))))},dt=a(201),ht=a(202),pt=a(129),ft=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(pt.a,{value:this.props.value,apiKey:"arg05azt52qbujpnf831szuswhmyhoqute0q48btk5bqigoj",init:{setup:function(t){e.props.onEditorSetup(t)},content_css:"./editor.css",height:300,menubar:!1,statusbar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code wordcount help"],external_plugins:{drawingTool:"/drawing-tool/plugin.min.js"},toolbar:"styleselect | bold italic underline strikethrough | forecolor backcolor bullist numlist | link code | ltr rtl | charmap | drawingTool"},onEditorChange:this.props.onEditorChange}))}}]),a}(r.a.Component),gt=a(206),bt=a(198),Et=a(119),vt=(a(167),function(e){var t=Object($.d)((function(e){return e.globals.author})),a=Object($.c)(),o=Object(n.useState)(0),c=Object(Ce.a)(o,2),l=c[0],i=c[1],s=function(t){e.onClose()},u=function(e){var t=Array.from(e);i(0),t.forEach((function(e){if(e.type.indexOf("image/")>=0){var t=window.URL||window.webkitURL,a=document.createElement("img");a.onload=function(){var t=a.naturalWidth||a.width,n=a.naturalHeight||a.height;e.width=t,e.height=n,m(e,!0)},a.src=t.createObjectURL(e)}else m(e,!1)}))},m=function(){var n=Object(j.a)(I.a.mark((function n(r,o){var c,l,i,s,u,m,h,p;return I.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,U(t.communityId,t._id);case 3:return c=n.sent,n.next=6,G(r,d);case 6:return l=n.sent,i=c.data,s=l.data,i.title=s.filename,i.status="active",s.version=i.data.version+1,i.data=s,i.tmpFilename=s.tmpFilename,n.next=16,K(i,t.communityId,i._id);case 16:return(u=n.sent).data.width=r.width,u.data.height=r.height,n.next=21,P(e.noteId,i._id,"attach");case 21:e.inlineAttach?(m="http://localhost:8000"+u.data.url,h=u.title,p="",o?p='<img class="inline-attachment '+i._id+'" src="'+m+'" width="100px" alt="'+h+'" data-mce-src="'+m+'">':(p='<a class="inline-attachment '+i._id+'" href="'+m+'" target="_blank" download>',p+='<img src="http://localhost:8000/manual_assets/kf6images/03-toolbar-attachment.png" alt="'+h+'">'+h+"</a>"),e.onNewInlineAttach(p)):a(ot(e.noteId)),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(0),console.log(n.t0);case 27:return n.prev=27,n.finish(27);case 29:case"end":return n.stop()}}),n,null,[[0,24,27,29]])})));return function(e,t){return n.apply(this,arguments)}}(),d=function(e){var t=Math.round(100*e.loaded/e.total);i(t)};return r.a.createElement(ke.a,{show:e.attachPanel,onHide:s},r.a.createElement(ke.a.Header,{closeButton:!0},r.a.createElement(ke.a.Title,null,"Insert Attachment File")),r.a.createElement(ke.a.Body,null,r.a.createElement(gt.a.File,{id:"custom-file"},r.a.createElement(gt.a.File.Input,{onChange:function(e){u(e.target.files)}})),r.a.createElement("div",{style:{width:"100%",color:"black"}},r.a.createElement(Et.FileDrop,{onFrameDragEnter:function(e){return console.log("onFrameDragEnter",e)},onFrameDragLeave:function(e){return console.log("onFrameDragLeave",e)},onFrameDrop:function(e){return console.log("onFrameDrop",e)},onDragOver:function(e){return console.log("onDragOver",e)},onDragLeave:function(e){return console.log("onDragLeave",e)},onDrop:function(e,t){return u(e)}},"or drop some files here!")),r.a.createElement(bt.a,{now:l})),r.a.createElement(ke.a.Footer,null,r.a.createElement(X.a,{variant:"primary",onClick:s},"Close")))}),yt=a(199),wt=Object(Z.b)("REQUEST_SCAFFOLD"),kt=Object(Z.b)("RECEIVE_SCAFFOLD"),Ct=Object(Z.c)({isFetching:!1,items:[],fetched:!1},(R={},Object(m.a)(R,kt,(function(e,t){e.items=t.payload,e.isFetching=!1,e.fetched=!0})),Object(m.a)(R,wt,(function(e,t){e.isFetching=!0})),R)),Nt=function(e,t){var a="";return a+=" ",a+=t?'<span class="kfSupportStartMark kfTemplateStartMark"> &nbsp; </span>':'<span class="kfSupportStartMark"> &nbsp; </span>',a+=" ",a=t?a+'<span class="kfSupportStartLabel kfTemplateStartLabel">'+e+"</span>":a+'<span class="kfSupportStartLabel">'+e+"</span>",a+=" "},Ot=function(e){var t="";return t+=" ",t+=e?'<span class="kfSupportEndMark kfTemplateEndMark"> &nbsp; </span>':'<span class="kfSupportEndMark"> &nbsp; </span>',t+=" "},St=function(e,t,a,n){return function(r){var o=(new Date).getTime().toString(),c='<span id="'+o+'"></span>'+r;n&&(c=" -&nbsp;"+c+"&nbsp;- ");var l="";return l+="<br>",l+="&nbsp;&nbsp;",l=a?l+'<span id="'+e+'" class="KFSupportStart KFTemplateStart mceNonEditable">':l+'<span id="'+e+'" class="KFSupportStart mceNonEditable">',l+=Nt(t,a),l+="</span>",a&&(l+='<p class="kfTemplateContent">',l+="<br><br><br><br>"),l+=c,a&&(l+="</p>"),l=a?l+'<span id="'+e+'" class="KFSupportEnd KFTemplateEnd mceNonEditable">':l+'<span id="'+e+'" class="KFSupportEnd mceNonEditable">',l+=Ot(a),l+="</span>",l+="&nbsp;&nbsp;",{tag:l+="<br>",supportContentId:o}}},It=(a(168),function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).scaffoldSelected=function(e,t){var a=n.props.items[e],r=!0,o="",c=a.data&&a.data.isTemplate;c&&(r=!1,o="<br><br>");var l=t._to.title,i=St(t.to,l,c,r);n.props.onScaffoldSelected(i,o)},n.state={selected:e.initVal},n.onSelectChange=n.onSelectChange.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){if(!this.props.fetched){var e=this.props,t=e.communityId,a=e.contextId;this.props.fetchScaffolds(t,a)}}},{key:"onSelectChange",value:function(e){this.setState({selected:e.target.value})}},{key:"render",value:function(){var e=this,t=this.props.items,a=t.map((function(e,t){return r.a.createElement("option",{key:t,value:t},e.title)})),n="";return t.length&&t[this.state.selected].supports&&(n=t[this.state.selected].supports.map((function(t,a){return r.a.createElement(Ee.a,{className:"mt-1 p-0",key:a,md:12},r.a.createElement("div",{className:"KFSupportButton",size:"sm",onClick:function(){return e.scaffoldSelected(e.state.selected,t)}},t._to.title))}))),r.a.createElement(yt.a,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,{className:"p-0"},r.a.createElement(gt.a,null,r.a.createElement(gt.a.Group,{className:"mb-1",controlId:"exampleForm.ControlSelect2"},r.a.createElement(gt.a.Label,null,"Select Scaffold"),r.a.createElement(gt.a.Control,{size:"sm",as:"select",onChange:this.onSelectChange},a))))),r.a.createElement(ve.a,null,n))}}]),a}(r.a.Component)),jt={fetchScaffolds:function(e,t){return function(a){a(wt);var n=M(e).then((function(e){var t=e.data.scaffolds.map((function(e){return H(e)}));return Promise.all(t).then((function(e){return e.map((function(e){return e.data}))}))}));return Promise.all([n,B(t,"from","uses")]).then(function(){var e=Object(j.a)(I.a.mark((function e(t){var n,r,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t[1].map((function(e){return e.to})),r=t[0].filter((function(e){return n.includes(e._id)})),e.next=4,Promise.all(r.map((function(e){return B(e._id,"from")})));case 4:o=e.sent,r=r.map((function(e,t){return e.supports=o[t],e})),a(kt(r));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},_t=Object($.b)((function(e,t){return Object(Ne.a)({communityId:e.globals.communityId,contextId:e.globals.contextId},e.scaffolds)}),jt)(It),Tt=(a(169),function(e){var t=Object($.d)((function(t){return e.attachments.map((function(e){return t.notes.attachments[e]}))})),a=Object(n.useState)([]),o=Object(Ce.a)(a,2),c=o[0],l=o[1],i=function(){};return r.a.createElement(Ee.a,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,r.a.createElement("span",{className:""},"Insert image or file: "),r.a.createElement(X.a,{className:"attach-button mx-2",size:"sm",variant:"outline-dark",onClick:function(){return e.onNewAttachClick(!0)}},"Inline"),r.a.createElement(X.a,{className:"attach-button mx-2",size:"sm",variant:"outline-dark",onClick:function(){return e.onNewAttachClick(!1)}},"As an attachment"),r.a.createElement(X.a,{className:"attach-button mx-2",size:"sm",variant:"outline-dark",onClick:function(){console.log("Add images");var t=Array.from(document.getElementById("attachbox-".concat(e.noteId)).getElementsByClassName("selected"));if(0!==t.length){var a="";console.log(t),t.forEach((function(e){var t=e.tagName,n=e.naturalWidth;if(n>200&&(n=200),"IMG"===t){var r=e.getAttribute("src"),o="";e.classList.forEach((function(e){24===e.length&&(o+=e+" ")})),a+='<img class="inline-attachment '+o+'" src="'+r+'" width="'+n+'px" alt="" data-mce-src="'+r+'">'}})),e.onNewInlineAttach(a)}},disabled:0===c.length},"Insert"))),r.a.createElement(ve.a,{id:"attachbox-".concat(e.noteId),className:"attachment-box"},t.map((function(e){return r.a.createElement("div",{key:e._id,className:"attachment-inner-box col-auto"},r.a.createElement("div",{className:"attachment-thumbnail"},0===e.data.type.indexOf("image/")?r.a.createElement("img",{className:e._id+" "+(c.includes(e._id)?"selected":""),src:"".concat(_).concat(e.data.url),onClick:function(t){return a=e._id,void(c.includes(a)?l((function(e){return e.filter((function(e){return e!==a}))})):l((function(e){return[].concat(Object(be.a)(e),[a])})));var a},alt:"attachment"}):r.a.createElement("a",{href:"".concat(_).concat(e.data.downloadUrl||e.data.url),title:e.title,download:!0},r.a.createElement("img",{className:e._id,src:"".concat(_,"/manual_assets/kf6images/03-toolbar-attachment.png"),title:"{attachment.title}",alt:"attachment"}))),r.a.createElement("div",{className:"attachment-buttons"},r.a.createElement("p",null,r.a.createElement("a",{href:"".concat(_).concat(e.data.downloadUrl||e.data.url),title:e.title,download:!0},r.a.createElement("img",{className:"download-attachment",src:"".concat(_,"/manual_assets/kf6images/cloud-download-2x.png"),alt:"Download",height:"15px"}))),r.a.createElement("p",null,r.a.createElement("button",{className:"delete-attachment",onClick:i},r.a.createElement("img",{src:"".concat(_,"/manual_assets/kf6images/trash.png"),alt:"Delete attachment",width:"10px",height:"15px"})))),r.a.createElement("div",{className:"attachment-info"},r.a.createElement("p",{title:"{attachment.title}"},e.title),r.a.createElement("p",null,e.data.size)))}))))}),xt=(a(170),function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={inlineAttach:!0,attachPanel:!1},n.onScaffoldSelected=n.onScaffoldSelected.bind(Object(p.a)(n)),n.onNewAttachmentClick=n.onNewAttachmentClick.bind(Object(p.a)(n)),n.closeAttachPanel=n.closeAttachPanel.bind(Object(p.a)(n)),n.onNewInlineAttach=n.onNewInlineAttach.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"onScaffoldSelected",value:function(e,t){this.props.onChange({scaffold:{tagCreator:e,initialText:t}})}},{key:"onNewAttachmentClick",value:function(e){this.setState({inlineAttach:e,attachPanel:!0})}},{key:"onNewInlineAttach",value:function(e){this.props.onChange({attach:e})}},{key:"closeAttachPanel",value:function(){this.setState({attachPanel:!1})}},{key:"render",value:function(){var e=this.props,t=e.note,a=e.onChange,n=e.onEditorSetup;return r.a.createElement(yt.a,{className:"write-container p-0"},r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,r.a.createElement(gt.a.Group,{controlId:"note-title"},r.a.createElement(gt.a.Control,{type:"text",size:"sm",placeholder:"Enter title",value:t.title,onChange:function(e){a({title:e.target.value})}})))),r.a.createElement(ve.a,null,r.a.createElement(Ee.a,{md:2,className:"pr-0"},r.a.createElement(_t,{initVal:0,onScaffoldSelected:this.onScaffoldSelected})),r.a.createElement(Ee.a,{md:10},r.a.createElement(ft,{value:t.data.body,onEditorSetup:n,onEditorChange:function(e,t){return a({data:{body:e}})}}),r.a.createElement("div",{className:"wordcount-bar text-right"},t.wordCount," words"))),r.a.createElement(ve.a,{className:"mt-2"},r.a.createElement(vt,Object.assign({noteId:t._id,onClose:this.closeAttachPanel,onNewInlineAttach:this.onNewInlineAttach},this.state)),r.a.createElement(Tt,{noteId:t._id,attachments:t.attachments,onNewAttachClick:this.onNewAttachmentClick,onNewInlineAttach:this.onNewInlineAttach})))}}]),a}(r.a.Component)),At=function(e){var t=e.records.reduce((function(e,t){return"read"===t.type?e[0].push(t):e[1].push(t),e}),[[],[]]),a=Object(Ce.a)(t,2),n=a[0],o=a[1];return r.a.createElement("div",null,r.a.createElement("h5",null,"Edit logs:"),r.a.createElement("p",{className:"mb-0"},o.length," edits"),r.a.createElement("ul",null,o.map((function(e){return r.a.createElement("li",{key:e._id},e.date,": ",e.author)}))),r.a.createElement("h5",null,"Read logs:"),r.a.createElement("p",{className:"mb-0"},n.length," reads"),r.a.createElement("ul",null,n.map((function(e){return r.a.createElement("li",{key:e._id},e.date,": ",e.author)}))))},Dt=function(e){var t=function(t){e.onChange({permission:t.target.value})};return r.a.createElement("div",{className:"m-2"},r.a.createElement("div",null,r.a.createElement("label",{className:"mt-1 font-weight-bold"},"Permission:"),r.a.createElement("div",null,r.a.createElement("table",{className:"KFPermission table table-sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\xa0"),r.a.createElement("th",null,"Authors"),r.a.createElement("th",null,"Group Members"),r.a.createElement("th",null,"Others"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("form",{action:""},r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"radio",name:"permission",value:"private",id:"contrib-permission1",onChange:t,checked:"private"===e.contribution.permission}),r.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"contrib-permission1"},"\xa0private")))),r.a.createElement("td",null,"rw"),r.a.createElement("td",null,"rw"),r.a.createElement("td",null,"-")),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("form",{action:""},r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"radio",value:"protected",id:"contrib-permission2",name:"permission",onChange:t,checked:"protected"===e.contribution.permission}),r.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"contrib-permission2"},"\xa0protected")))),r.a.createElement("td",null,"rw"),r.a.createElement("td",null,"rw"),r.a.createElement("td",null,"r")),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("form",{action:""},r.a.createElement("div",{className:"form-check form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"radio",value:"public",id:"contrib-permission3",name:"public",onChange:t,checked:"public"===e.contribution.permission}),r.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"contrib-permission3"},"\xa0public")))),r.a.createElement("td",null,"rw"),r.a.createElement("td",null,"rw"),r.a.createElement("td",null,"rw"))))),r.a.createElement("label",{className:"mt-1 font-weight-bold"},"Status:"),r.a.createElement("div",{className:"ml-2"},e.contribution.status),r.a.createElement("label",{className:"mt-2 font-weight-bold"},"Template:"),r.a.createElement("form",{className:"ml-2",action:""},r.a.createElement("div",{className:"form-check  form-check-inline"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"c-isTemplate",checked:e.contribution.data.isTemplate,onChange:function(t){e.onChange({data:{isTemplate:t.target.checked}})}}),r.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"c-isTemplate"},"isTemplate")))),"Note"===e.contribution.type&&r.a.createElement("div",null,r.a.createElement("label",{className:"mt-1 mr-1 font-weight-bold"},"Riseabove:"),"Note"===e.contribution.type&&e.contribution.data&&e.contribution.data.riseabove&&e.contribution.data.riseabove.viewId?"This note has riseabove view. Please look it at 'Read' tab.":r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-sm",onClick:void 0},"MakeRiseabove")))},Ft=a(128),Lt=function(e){var t=Object.entries(e.authors).map((function(e){return{value:e[1]._id,label:"".concat(e[1].firstName," ").concat(e[1].lastName)}})),a=Object(n.useState)(null),o=Object(Ce.a)(a,2),c=o[0],l=o[1];return r.a.createElement("div",null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,r.a.createElement(Ft.a,{options:t,onChange:function(e){l(e)},isClearable:!0})),r.a.createElement(Ee.a,{md:"auto"},r.a.createElement(X.a,{disabled:!c,onClick:function(){return e.onAuthorSelected(c)}},"Add"))),r.a.createElement("p",null,t.length," possible author(s) in this community."))},Rt=function(e){var t=Object($.d)((function(t){return t.notes[e.contribId]})),a=Object($.d)((function(e){return t.authors.map((function(t){return e.users[t]}))})),n=Object($.d)((function(e){return e.users})),o=Object($.c)();return r.a.createElement("div",{className:"authorTab mt-2",style:{height:"100%"}},r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,r.a.createElement("h5",null,"Authors:"),r.a.createElement("ul",null,a.map((function(t,a){return r.a.createElement("li",{key:t._id,style:{cursor:"move"}},t.firstName," ",t.lastName,r.a.createElement(X.a,{size:"sm",className:"ml-1",onClick:function(){return function(t,a){0!==a?a>=0&&o(tt({contribId:e.contribId,author:t._id})):He({title:"Error!",type:"danger",message:"cannot remove the Primary Author"})}(t,a)}},"x"))})))),r.a.createElement(Ee.a,null,r.a.createElement("div",null,r.a.createElement("h5",null,"Add author:"),r.a.createElement(Lt,{authors:n,onAuthorSelected:function(a){console.log(a),t.authors.includes(a.value)||o(at({contribId:e.contribId,author:a.value}))}})))),r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null)))},Vt=(a(171),function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).onEditorSetup=n.onEditorSetup.bind(Object(p.a)(n)),n.onDrawingToolOpen=n.onDrawingToolOpen.bind(Object(p.a)(n)),n.addDrawing=n.addDrawing.bind(Object(p.a)(n)),n.onNoteChange=n.onNoteChange.bind(Object(p.a)(n)),n.wordCount=n.wordCount.bind(Object(p.a)(n)),n.onTabSelected=n.onTabSelected.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){this.props.drawing&&e.drawing!==this.props.drawing&&this.props.drawTool===this.props.noteId&&(this.editor.insertContent(this.props.drawing),this.props.removeDrawing())}},{key:"onNoteChange",value:function(e){if(e.scaffold){var t=e.scaffold,a=t.tagCreator,n=t.initialText;this.addSupport(!0,n,a)}else e.attach?this.editor.insertContent(e.attach):(this.props.editNote(Object(Ne.a)({_id:this.props.noteId},e)),e.data&&e.data.body&&this.wordCount(e.data.body))}},{key:"wordCount",value:function(e){var t=this.editor.plugins.wordcount.getCount()-function(e){for(var t="<div>"+e+"</div>",a=Le()(t).find(".kfSupportStartLabel"),n=0,r=0;r<a.length;r++)n+=a[r].innerHTML.split(" ").length;return n}(e);this.props.setWordCount({contribId:this.props.noteId,wc:t})}},{key:"onEditorSetup",value:function(e){e.onDrawButton=this.onDrawingToolOpen,this.editor=e}},{key:"onDrawingToolOpen",value:function(e){e?this.props.editSvgDialog(this.props.noteId,e):this.props.openDrawDialog(this.props.noteId)}},{key:"addDrawing",value:function(e){this.editor.insertContent(e)}},{key:"addSupport",value:function(e,t,a){var n=this.editor.selection.getContent(),r=a(n.length?n:t),o=r.tag,c=r.supportContentId;if(this.editor.insertContent(o),e){var l=this.editor.dom.get(c);l&&this.editor.selection.setCursorLocation(l)}}},{key:"onTabSelected",value:function(e){"history"===e&&this.props.fetchRecords(this.props.note._id)}},{key:"render",value:function(){var e=new Intl.DateTimeFormat("default",oe);return r.a.createElement("div",null,r.a.createElement("div",{className:"contrib-info"},"Created By: ",this.props.author.firstName," ",this.props.author.lastName," ",r.a.createElement("br",null),"Last modified: ",e.format(new Date(this.props.note.modified))),r.a.createElement(dt.a,{defaultActiveKey:"write",transition:!1,onSelect:this.onTabSelected},r.a.createElement(ht.a,{eventKey:"home",title:"read"},r.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.note.data.body}})),r.a.createElement(ht.a,{eventKey:"write",title:"write"},r.a.createElement(xt,{note:this.props.note,onScaffoldSelected:this.scaffoldSelected,onChange:this.onNoteChange,onEditorSetup:this.onEditorSetup})),r.a.createElement(ht.a,{eventKey:"contact",title:"author(s)"},r.a.createElement(Rt,{contribId:this.props.noteId})),r.a.createElement(ht.a,{eventKey:"history",title:"history"},r.a.createElement(At,{records:this.props.note.records})),r.a.createElement(ht.a,{eventKey:"properties",title:"properties"},r.a.createElement(Dt,{contribution:this.props.note,onChange:this.onNoteChange}))))}}]),a}(r.a.Component)),Mt={editNote:qe,openDrawDialog:Ie,setWordCount:$e,removeDrawing:Ge,editSvgDialog:function(e,t){return function(a){a(Ye({noteId:e,svg:t})),a(Ie(e))}},fetchAttachments:ot,fetchRecords:function(e){return function(){var t=Object(j.a)(I.a.mark((function t(a,n){var r,o,c;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n().users,t.next=3,W(e);case 3:o=t.sent,c=new Intl.DateTimeFormat("default",oe),o.forEach((function(e){if(r[e.authorId]){var t=r[e.authorId];e.author="".concat(t.firstName," ").concat(t.lastName)}else e.author="NA";e.date=c.format(new Date(e.timestamp))})),a(et({contribId:e,records:o}));case 7:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()}},Bt=Object($.b)((function(e,t){var a=e.notes[t.noteId];return{note:a,drawing:e.notes.drawing,drawTool:e.dialogs.drawTool,author:a&&(e.users[a.authors[0]]||"NA")}}),Mt)(Vt),Pt=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).onConfirm=n.onConfirm.bind(Object(p.a)(n)),n.onLoad=n.onLoad.bind(Object(p.a)(n)),n.getIframeRef=n.getIframeRef.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"onConfirm",value:function(){var e=this.iframe_ref.contentWindow,t=e.svgCanvas.current_drawing_.all_layers[0],a=e.svgCanvas.current_drawing_.all_layers[1],n=a[1].getBBox().width,r=a[1].getBBox().height;e.svgCanvas.current_drawing_.svgElem_.setAttribute("width",n),e.svgCanvas.current_drawing_.svgElem_.setAttribute("height",r),t[1].childNodes[1].setAttribute("width",n),t[1].childNodes[1].setAttribute("height",r),e.svgCanvas.selectAllInCurrentLayer(),e.svgCanvas.groupSelectedElements(),e.svgCanvas.alignSelectedElements("l","page"),e.svgCanvas.alignSelectedElements("t","page"),e.svgCanvas.ungroupSelectedElement(),e.svgCanvas.clearSelection(),e.svgCanvas.current_drawing_.svgElem_.setAttribute("padding","2em"),e.svgCanvas.setResolution("fit",100);var o=e.svgCanvas.getSvgString(),c=document.createElement("canvas");c.width=n+4,c.height=r+4;var l=c.getContext("2d"),i=document.createElement("img");i.setAttribute("src","data:image/svg+xml;base64,"+btoa(o)),i.onload=function(){l.drawImage(i,0,0);var e=c.toDataURL("image/png"),t="<img alt='"+o+"' src='"+e+"'/>";this.props.onConfirm(t)}.bind(this)}},{key:"getIframeRef",value:function(e){e&&(this.iframe_ref=e)}},{key:"onLoad",value:function(e){var t=this.props.note.editSvg;t&&e.target.contentWindow.svgCanvas.setSvgString(t)}},{key:"render",value:function(){return r.a.createElement(mt,{title:"DrawTool",style:{zIndex:3e3},onClose:this.props.onClose,onConfirm:this.onConfirm,confirmButton:"Add"},r.a.createElement("iframe",{onLoad:this.onLoad,title:"DrawingTool",src:"/drawing-tool/svg/index.html",ref:this.getIframeRef,width:"100%",height:"100%"}))}}]),a}(r.a.Component),zt=Object($.b)((function(e,t){return{note:e.notes[t.noteId]}}))(Pt),Ht=function(e){var t=Object($.d)((function(e){return e.dialogs})),a=Object($.c)(),o=Object(n.useCallback)((function(e){a(Se(e.id)),a(Ue(e.noteId))}),[a]),c=Object(n.useCallback)((function(e){var t,n;a((t=e.noteId,n=e.id,function(){var e=Object(j.a)(I.a.mark((function e(a,r){var o,c,l,i,s;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r(),c=o.notes[t],(c=Object.assign({},c)).data=Object.assign({},c.data),c.title){e.next=7;break}return He({title:"Error Saving Note!",type:"danger",message:"Title is required"}),e.abrupt("return");case 7:if("Note"!==c.type){e.next=22;break}return c.status="active",e.next=11,Pe(c.data.body,c._id,[],[]);case 11:return l=e.sent,a(ct(t,"from")),a(ct(t,"to")),i=l.html(),c.data.body=i,e.next=18,K(c,c.communityId,c._id);case 18:s=e.sent,a(qe(s)),void 0!==n&&a(Se(n)),He({title:"Saved!",type:"success",message:"Contribution created!"});case 22:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()))}),[a]),l=Object(n.useCallback)((function(e){return a(_e(e))}),[a]),i=Object(n.useCallback)((function(){a(je())}),[a]),s=Object(n.useCallback)((function(e){a(We(e)),a(je())}),[a]);return r.a.createElement("div",null,t.dialogs.map((function(e,t){return r.a.createElement(mt,{key:e.id,onMouseDown:function(){return l(e.id)},title:e.title,style:{zIndex:e.zIndex},onClose:function(){return o(e)},onConfirm:function(){return c(e)},confirmButton:e.confirmButton},r.a.createElement(Bt,{key:e.noteId,noteId:e.noteId}))})),null!==t.drawTool?r.a.createElement(zt,{onClose:i,onConfirm:s,noteId:t.drawTool}):null)},Kt=a(208),Ut=(a(172),function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).noteList=[],n.state={token:sessionStorage.getItem("token"),myViews:[],viewId:sessionStorage.getItem("viewId"),viewTitle:sessionStorage.getItem("viewTitle")?sessionStorage.getItem("viewTitle"):"welcome",addView:sessionStorage.getItem("viewTitle")?sessionStorage.getItem("viewTitle"):"welcome",communityId:sessionStorage.getItem("communityId"),visible:!1},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t={headers:{Authorization:"Bearer ".concat(this.state.token)}},a="".concat(T,"/communities/").concat(this.state.communityId,"/views");E.a.get(a,t).then((function(t){e.setState({myViews:t.data})})).catch((function(e){}))}},{key:"handleChange",value:function(e){e.persist();var t=e.target.value;this.setState({addView:t})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("State Handle Submit",this.state.addView);var a="".concat(T,"/links"),n={headers:{Authorization:"Bearer ".concat(this.state.token)}};this.props.noteContnetList.forEach((function(e){var r=e._id,o={from:t.state.addView,to:r,type:"contains"};E.a.post(a,o,n).then((function(e){t.setState({visible:!0},(function(){window.setTimeout((function(){t.setState({visible:!1})}),1e3)}))}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{className:"mrg-1-top"},r.a.createElement(ve.a,null,r.a.createElement(Ee.a,{md:"8"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"select",name:"viewId",value:this.state.addView,onChange:this.handleChange},this.state.myViews.map((function(e,t){return r.a.createElement("option",{key:t,value:e._id}," ",e.title," ")}))))),r.a.createElement(Ee.a,{md:"4"},r.a.createElement(X.a,{onClick:this.handleSubmit},"Add to View"))),r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,r.a.createElement(Kt.a,{color:"info",isOpen:this.state.visible},"Notes added to View!")))),this.props.noteContnetList.map((function(t,a){if(e.props.query&&t.data.English){var n=t.data.English,o=n.indexOf(e.props.query);o>=0&&(t.data.English=n.substring(0,o)+"<span class='highlight'>"+n.substring(o,o+e.props.query.length)+"</span>"+n.substring(o+e.props.query.length))}else if(e.props.query&&t.data.body){var c=t.data.body,l=c.indexOf(e.props.query);l>=0&&(t.data.body=c.substring(0,l)+"<span class='highlight'>"+c.substring(l,l+e.props.query.length)+"</span>"+c.substring(l+e.props.query.length))}return r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{className:"min-height-2 mrg-05 border rounded mrg-1-bot pd-1",key:a},r.a.createElement(Ee.a,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,{md:"11",className:"pd-1 primary-800 font-weight-bold"},t.title),r.a.createElement(Ee.a,{md:"1"},r.a.createElement(X.a,{variant:"secondary",onClick:function(){return e.props.closeNote(t._id)}},"X"))),r.a.createElement(ve.a,null,r.a.createElement("span",{className:"pd-1",dangerouslySetInnerHTML:{__html:t.data.English?t.data.English:t.data.body}})))))})))}}]),a}(n.Component)),qt=Object(Z.b)("ADD_USER"),Wt=Object(Z.b)("ADD_AUTHORS"),Gt=Object(Z.c)({},(V={},Object(m.a)(V,qt,(function(e,t){e[t.payload._id]=t.payload})),Object(m.a)(V,Wt,(function(e,t){t.payload.forEach((function(t){return e[t._id]=t}))})),V)),Yt=function(e){return function(){var t=Object(j.a)(I.a.mark((function t(a){var n;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q(e);case 2:n=t.sent,a(Wt(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Jt=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).token=sessionStorage.getItem("token"),n.state={communityId:sessionStorage.getItem("communityId"),authors:[],authorName:""},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(T,"/communities/").concat(this.state.communityId,"/authors");E.a.get(a,t).then((function(t){e.setState({authors:t.data}),e.state.authors.filter((function(t){return t._id.includes(e.props.authorId)})).map((function(t){return e.setState({authorName:t.firstName+" "+t.lastName}),null}))})).catch((function(e){alert(e)}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null," ",this.state.authorName))}}]),a}(n.Component),Qt=(a(180),a(181)),Xt=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).myRegistrations=[],n.myViews=[],n.myCommunityId="",n.show=!1,n.from=[],n.to=[],n.myTempTo=[],n.hierarchyNote=[],n.noteData1=[],n.noteContnetNew=[],n.token=sessionStorage.getItem("token"),n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(m.a)({},a,r))},n.handleChangeView=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(m.a)({},a,r))},n.closeNote=function(e){if(n.state.noteContnetList){var t=Object(be.a)(n.state.noteContnetList);t&&t.filter((function(t){return t._id.includes(e)})).map((function(e){return t.pop(e),n.setState({noteContnetList:Object(be.a)(t)}),null}))}},n.filterNotes=function(e){var t;t=n.noteData1.filter((function(t){return t.data&&t.data.English?t.data.English.includes(e):null})),n.setState({filteredData:t})},n.handleInputChange=function(e){n.setState({query:e.target.value});var t=[];if(n.state.query||n.state.filter)switch(n.state.filter){case"title":n.state.viewLinks.filter((function(e){return e._to.title.includes(n.state.query)})).map((function(e){return t.push(e),null}));break;case"content":t=n.noteData1.filter((function(t){return t.data&&t.data.English?t.data.English.includes(e.target.value):t.data&&t.data.body?t.data.body.includes(e.target.value):null}));break;case"author":var a=[];n.state.authors.map((function(e){return(e.firstName.toLowerCase().includes(n.state.query.toLowerCase())||e.lastName.toLowerCase().includes(n.state.query.toLowerCase()))&&a.push(e._id),null})),a.forEach((function(e){t=n.noteData1.filter((function(t){return t.authors.includes(e)})).map((function(e){return e}))}));break;case"scaffold":var r=[];n.state.scaffolds.map((function(e){return e.map((function(e){return r.push(e._to.title),null})),null})),n.setState({scaffoldsTitle:r})}n.setState({filteredData:t})},n.handleFilter=function(e){var t=e.target.value;n.setState({filter:t})},n.buildOn=function(e){sessionStorage.setItem("buildOn",e),n.props.newNote(n.props.view,n.props.communityId,n.props.author._id)},n.state={communitites:[],myCommunities:[],views:[],communityId:sessionStorage.getItem("communityId"),viewId:sessionStorage.getItem("viewId"),viewLinks:[],showView:!1,showCommunity:!1,showContribution:!1,showNote:!1,hNotes:[],addView:"",showRiseAbove:!1,showModel:!1,showNoteContent:!1,noteContnetList:[],query:"",filteredData:[],filter:"title",authors:[],scaffolds:[],scaffoldsTitle:[],noteData:[]},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n.handleSubmitView=n.handleSubmitView.bind(Object(p.a)(n)),n.handleChangeView=n.handleChangeView.bind(Object(p.a)(n)),n.onCloseDialog=n.onCloseDialog.bind(Object(p.a)(n)),n.onConfirmDrawDialog=n.onConfirmDrawDialog.bind(Object(p.a)(n)),n.handleInputChange=n.handleInputChange.bind(Object(p.a)(n)),n.showContent=n.showContent.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.fetchAuthor(this.props.communityId),this.props.fetchView(this.props.viewId),this.props.fetchCommunity(this.props.communityId),this.props.fetchAuthors(this.props.communityId),this.setState(this.props.location.state),E.a.get("".concat(T,"/communities")).then((function(t){e.setState({communitites:t.data})})).catch((function(e){console.log("GET Communities Failed"),alert("GET Communities Failed")}));var t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(T,"/communities/").concat(this.state.communityId,"/views");E.a.get(a,t).then((function(t){e.setState({myViews:t.data})})).catch((function(e){alert(e)})),E.a.get("".concat(T,"/users/myRegistrations"),t).then((function(t){e.setState({myCommunities:t.data})})).catch((function(e){alert(e)}));var n,r="".concat(T,"/links/from/").concat(sessionStorage.getItem("viewId")),o=[];E.a.get(r,t).then((function(a){n=a.data.filter((function(e){return"Note"===e._to.type&&""!==e._to.title&&"active"===e._to.status})).map((function(e){var a="".concat(T,"/objects/").concat(e.to);return E.a.get(a,t).then((function(e){o.push(e.data)})).catch((function(t){console.log("Failed to get data for: ",e.to)})),e}));var r=Qt.sortBy(n,(function(e){return e._to.modified})).reverse();e.setState({viewLinks:r,noteData:o}),e.noteData1=o})).catch((function(e){console.log("Failed to get Links for viewId",sessionStorage.getItem("viewId"))}));var c="".concat(T,"/links/").concat(this.state.communityId,"/search");E.a.post(c,{query:{type:"buildson"}},t).then((function(t){t.data.reverse().filter((function(e){return"Note"===e._to.type&&"active"===e._to.status&&"Note"===e._from.type&&"active"===e._from.status?e:null})).map((function(t){return e.from.push(t.from),e.to.push(t.to),e.hierarchyNote.push(t),null}));try{for(var a in e.to)if(e.from.includes(e.to[a])){var n=e.from.indexOf(e.to[a]),r=[];e.hierarchyNote[n]&&r.push(e.hierarchyNote[n]),r.push(e.hierarchyNote[a]),e.hierarchyNote[a]=r,delete e.hierarchyNote[n]}}catch(o){console.log("Error in Hnotes",o)}finally{e.setState({hNotes:e.hierarchyNote})}})).catch((function(e){console.log("Error occured for BuildsOn",e)}));var l="".concat(T,"/communities/").concat(this.state.communityId,"/authors");E.a.get(l,t).then((function(t){e.setState({authors:t.data})})).catch((function(e){alert(e)}));var i=[];M(this.state.communityId).then((function(a){a.data.scaffolds.forEach((function(e){var a="".concat(T,"/links/from/")+e;E.a.get(a,t).then((function(e){i.push(e.data)}))})),e.setState({scaffolds:i})}))}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"handleSubmitView",value:function(e){e.preventDefault();var t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(T,"/contributions/").concat(this.state.communityId),n={authors:[sessionStorage.getItem("userId")],communityId:this.state.communityId,permission:"public",status:"active",title:this.state.addView,type:"View"};E.a.post(a,n,t).then((function(e){})).catch((function(e){console.log(e)}))}},{key:"logout",value:function(){sessionStorage.removeItem("token")}},{key:"newContribution",value:function(){this.setState({showContribution:!0,showCommunity:!1,showView:!1,showRiseAbove:!1})}},{key:"newNote",value:function(){this.setState({showNote:!0,showView:!1,showRiseAbove:!1})}},{key:"newView",value:function(){this.setState({showView:!0,showRiseAbove:!1,showNote:!1,showModel:!0})}},{key:"newRiseAbove",value:function(){this.setState({showView:!1,showNote:!1,showRiseAbove:!0,showModel:!0})}},{key:"handleShow",value:function(e){this.setState({showModel:e})}},{key:"handleShowNoteContent",value:function(e){this.setState({showView:!1,showNote:!1,showRiseAbove:!1})}},{key:"showContent",value:function(e,t){var a=this,n=e.target.checked;(this.setState({showNoteContent:!0}),n)?this.noteData1.map((function(e){return e._id&&e._id===t&&(a.noteContnetNew.push(e),a.setState({noteContnetList:a.noteContnetNew})),null})):(this.noteContnetNew.filter((function(e){return e._id.includes(t)})).map((function(e){return a.noteContnetNew.pop(e),null})),this.setState({noteContnetList:this.noteContnetNew}))}},{key:"changeView",value:function(e){this.setState({viewId:e.obj._id}),sessionStorage.setItem("viewId",e.obj._id),sessionStorage.setItem("viewTitle",e.obj.title),this.handleShow(!1),window.location.reload()}},{key:"onConfirmDrawDialog",value:function(e){this.props.addDrawing(e),this.props.closeDrawDialog()}},{key:"onCloseDialog",value:function(e){this.props.removeNote(e.noteId),this.props.closeDialog(e.id)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ht,null),r.a.createElement("div",{className:"row min-width"},r.a.createElement(Ee.a,{md:"1",sm:"12",className:"pd-6-top"},r.a.createElement(ve.a,{className:"mrg-025"},r.a.createElement(Ee.a,{md:"12",sm:"2",xs:"2"},r.a.createElement(ye.a,{drop:"right",variant:"outline-info",title:r.a.createElement("i",{className:"fas fa-plus-circle"})},r.a.createElement(we.a.Item,{onClick:function(){return e.props.newNote(e.props.view,e.props.communityId,e.props.author._id)}},"New Note"),r.a.createElement(we.a.Item,{onClick:function(){return e.newView()}},"new View"),r.a.createElement(we.a.Item,{onClick:function(){return e.newRiseAbove()}},"New RiseAbove"))),r.a.createElement(Ee.a,{md:"12",sm:"2",xs:"2"},r.a.createElement(ye.a,{drop:"right",variant:"outline-info",title:r.a.createElement("i",{className:"fa fa-pencil"})})),r.a.createElement(Ee.a,{md:"12",sm:"2",xs:"2"},r.a.createElement(ye.a,{drop:"right",variant:"outline-info",title:r.a.createElement("i",{className:"fas fa-file"})})),r.a.createElement(Ee.a,{md:"12",sm:"2",xs:"2"},r.a.createElement(ye.a,{drop:"right",variant:"outline-info",title:r.a.createElement("i",{className:"fas fa-hammer"})})),r.a.createElement(Ee.a,{md:"12",sm:"2",xs:"2"},r.a.createElement(ye.a,{drop:"right",variant:"outline-info",title:r.a.createElement("i",{className:"fas fa-edit"})})))),r.a.createElement(Ee.a,{md:"5",sm:"12",className:"mrg-6-top pd-2-right v-scroll"},r.a.createElement(w.a,{className:"mrg-1-bot"},r.a.createElement(ve.a,null,r.a.createElement(Ee.a,{md:"8"},r.a.createElement(k.a,null,r.a.createElement(N.a,{placeholder:"Search Your Note",onChange:this.handleInputChange}))),r.a.createElement(Ee.a,{md:"4"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"select",name:"filter",id:"filter",onChange:this.handleFilter},r.a.createElement("option",{key:"title",value:"title"},"Search By Title"),r.a.createElement("option",{key:"scaffold",value:"scaffold"},"Search By Scaffold"),r.a.createElement("option",{key:"content",value:"content"},"Search By Content"),r.a.createElement("option",{key:"author",value:"author"},"Search By Author")))))),""===this.state.query?r.a.createElement(r.a.Fragment,null,this.state.hNotes.map((function(t,a){return r.a.createElement(ve.a,{key:a,className:"mrg-05-top"},r.a.createElement(Ee.a,{className:"mr-auto primary-bg-200 rounded mrg-1-bot"},t._to&&t._to.title&&t._to.created?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{className:"pd-05"},r.a.createElement(Ee.a,{md:"10",className:"primary-800 font-weight-bold"},t._to.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"checkbox",ref:t.to,onChange:function(a){return e.showContent(a,t.to)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:t._to.authors}),"\xa0 ",t._to.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(t.to)}},"BuildOn")))):r.a.createElement(r.a.Fragment,null,t[0]?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{className:""},r.a.createElement(Ee.a,null,r.a.createElement(ve.a,null,t[0]._to&&t[0]._to.title&&t[0]._to.created?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee.a,null,r.a.createElement(ve.a,{className:"pd-05"},r.a.createElement(Ee.a,{md:"10",className:"primary-800 font-weight-bold"}," ",t[0]._to.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"checkbox",ref:t[0].to,onChange:function(a){return e.showContent(a,t[0].to)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:t[0]._to.authors}),"\xa0 ",t[0]._to.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(t[0].to)}},"BuildOn"))))):null),t.map((function(a,n){return r.a.createElement(ve.a,{key:n},r.a.createElement(Ee.a,{md:"1"}),r.a.createElement(Ee.a,null,t[0]&&t[0]._to&&t[0]._to.title&&a&&a._from&&a._from.created?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{className:"pd-05 border-left border-primary"},r.a.createElement(Ee.a,{className:"primary-800 font-weight-bold"},a._from.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min"},r.a.createElement(k.a,null,r.a.createElement(N.a,{className:"pd-left",type:"checkbox",ref:a.from,onChange:function(t){return e.showContent(t,a.from)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05 border-left border-primary"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:a._from.authors}),"\xa0 ",a._from.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(a.from)}},"BuildOn")))):r.a.createElement(r.a.Fragment,null)))}))))):r.a.createElement(r.a.Fragment,null)),t._from&&t._from.title&&t._to.created?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,{md:"1"}),r.a.createElement(Ee.a,null,r.a.createElement(ve.a,{className:"pd-05 border-left border-primary"},r.a.createElement(Ee.a,{className:"primary-800 font-weight-bold"},t._from.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min"},r.a.createElement(k.a,null,r.a.createElement(N.a,{className:"pd-left",type:"checkbox",ref:t.from,onChange:function(a){return e.showContent(a,t.from)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05 border-left border-primary"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:t._from.authors}),"\xa0 ",t._from.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(t.from)}},"BuildOn")))))):r.a.createElement(r.a.Fragment,null)))})),this.state.viewLinks.map((function(t,a){return r.a.createElement(r.a.Fragment,null,t&&t._to.title?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{key:a,value:t.to,className:"mrg-05-top"},r.a.createElement(Ee.a,{className:"primary-bg-200 rounded mrg-1-bot"},r.a.createElement(ve.a,{className:"pd-05"},r.a.createElement(Ee.a,{className:"primary-800 font-weight-bold"}," ",t._to.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"checkbox",ref:t.to,onChange:function(a){return e.showContent(a,t.to)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:t._to.authors}),"\xa0 ",t._to.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(t.to)}},"BuildOn")))))):r.a.createElement(r.a.Fragment,null))}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,null,this.state.scaffoldsTitle&&"scaffold"===this.state.filter?r.a.createElement(Ee.a,null,this.state.scaffoldsTitle.map((function(t,a){return r.a.createElement(ve.a,{key:a,className:"scaffold-title"},r.a.createElement(l.b,{onClick:function(){return e.filterNotes(t)},className:"white"},t))}))):null),this.state.filteredData.map((function(t,a){return r.a.createElement(r.a.Fragment,null,t._to&&t._to.title?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{key:a,value:t.to,className:"mrg-05-top"},r.a.createElement(Ee.a,{className:"primary-bg-200 rounded mrg-1-bot"},r.a.createElement(ve.a,{className:"pd-05"},r.a.createElement(Ee.a,{className:"primary-800 font-weight-bold"}," ",t._to.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"checkbox",ref:t.to,onChange:function(a){return e.showContent(a,t.to)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:t._to.authors}),"\xa0 ",t._to.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(t.to)}},"BuildOn")))))):r.a.createElement(r.a.Fragment,null,t._id?r.a.createElement(r.a.Fragment,null,r.a.createElement(ve.a,{key:a,value:t._id,className:"mrg-05-top"},r.a.createElement(Ee.a,{className:"primary-bg-200 rounded mrg-1-bot"},r.a.createElement(ve.a,{className:"pd-05"},r.a.createElement(Ee.a,{className:"primary-800 font-weight-bold"}," ",t.title),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},r.a.createElement(k.a,null,r.a.createElement(N.a,{type:"checkbox",ref:t._id,onChange:function(a){return e.showContent(a,t._id)}}))))),r.a.createElement(ve.a,{className:"primary-600 sz-075 pd-05"},r.a.createElement(Ee.a,null,r.a.createElement(Jt,{authorId:t.authors}),"\xa0 ",t.created),r.a.createElement(Ee.a,{md:"2"},r.a.createElement(X.a,{onClick:function(){return e.buildOn(t._id)}},"BuildOn")))))):r.a.createElement(r.a.Fragment,null)))})))),this.state.showNoteContent?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee.a,{md:"5",sm:"12",className:"mrg-6-top v-scroll"},r.a.createElement(Ut,{noteContnetList:this.state.noteContnetList,closeNote:this.closeNote,query:this.state.query,filter:this.state.filter}))):null),r.a.createElement(ke.a,{show:this.state.showModel,onHide:function(){return e.handleShow(!1)}},this.state.showContribution?r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a.Header,{closeButton:!0},r.a.createElement(ke.a.Title,null,"Contributions")),r.a.createElement(ke.a.Body,{style:{"max-height":"calc(100vh - 300px)","overflow-y":"auto"}},this.state.hNotes.map((function(e,t){return r.a.createElement(ve.a,{key:t,value:e.to,className:"mrg-05-top"},r.a.createElement(Ee.a,{className:"mr-auto"},r.a.createElement(ve.a,{className:"indigo"}," ",e._to.title),r.a.createElement(ve.a,null," ",e.to),r.a.createElement(ve.a,{className:"pd-2-left blue"}," ",e._from.title),r.a.createElement(ve.a,{className:"pd-2-left"}," ",e.from),r.a.createElement("hr",null)))})),this.state.viewLinks.map((function(e,t){return r.a.createElement(ve.a,{key:t,value:e.to,className:"mrg-05-top"},r.a.createElement(Ee.a,null,r.a.createElement(ve.a,{className:"indigo"}," ",e._to.title),r.a.createElement(ve.a,null," ",e.to),r.a.createElement("hr",null)))})))):null,this.state.showView?r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a.Header,{closeButton:!0},r.a.createElement(ke.a.Title,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,"Views")),r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,r.a.createElement(ve.a,null,r.a.createElement(w.a,{onSubmit:this.handleSubmitView,className:"form"},r.a.createElement(Ee.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"addView",style:{fontSize:"1rem"}},"Add View"),r.a.createElement(N.a,{type:"text",id:"addView",placeholder:"Enter View Name",name:"addView",value:this.state.addView,onChange:this.handleChangeView}))),r.a.createElement(Ee.a,null,r.a.createElement(X.a,{varient:"secondary",onClick:this.handleSubmitView},"Add")))))))),r.a.createElement(ke.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},this.state.myViews.map((function(t,a){return r.a.createElement(ve.a,{key:a,value:t.title,className:"mrg-05-top"},r.a.createElement(Ee.a,null,r.a.createElement(l.b,{onClick:function(){return e.changeView({obj:t})}}," ",t.title," ")))})))):null,this.state.showRiseAbove?r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a.Header,{closeButton:!0},r.a.createElement(ke.a.Title,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,"New RiseAbove")))),r.a.createElement(ke.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},r.a.createElement(w.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a,{htmlFor:"riseAboveTitle",style:{fontSize:"1rem"}},"RiseAbove Title"),r.a.createElement(N.a,{type:"text",id:"riseAboveTitle",placeholder:"Enter RiseAbove Title",name:"riseAboveTitle",value:this.state.riseAboveTitle,onChange:this.handleChange}),r.a.createElement(X.a,{className:"mrg-1-top",onClick:this.handleSubmit},"Submit")))):null,this.state.showNote?r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a.Header,{closeButton:!0},r.a.createElement(ke.a.Title,null,r.a.createElement(ve.a,null,r.a.createElement(Ee.a,null,"New Note")))),r.a.createElement(ke.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},"New Note")):null,r.a.createElement(ke.a.Footer,null,r.a.createElement(X.a,{variant:"secondary",onClick:function(){return e.handleShow(!1)}},"Close"))))}}]),a}(n.Component),$t={fetchAuthor:ie,fetchView:se,fetchCommunity:ue,fetchAuthors:Yt,setCommunityId:te,setViewId:ae,newNote:rt,openContribution:lt},Zt=Object($.b)((function(e,t){return{communityId:e.globals.communityId,viewId:e.globals.viewId,view:e.globals.view,author:e.globals.author}}),$t)(Xt),ea=function(e){var t=Object($.d)((function(e){return e.globals.communityId})),a=Object($.d)((function(e){return e.globals.viewId})),o=Object($.d)((function(e){return e.globals.view})),c=Object($.d)((function(e){return e.globals.author})),l=Object($.c)();return Object(n.useEffect)((function(){l(ie(t)),l(se(a)),l(ue(t)),l(Yt(t))}),[l,t,a]),r.a.createElement("div",{style:{marginTop:"100px"}},r.a.createElement(X.a,{onClick:function(){l(rt(o,t,c._id))}},"New Note"),r.a.createElement("br",null),r.a.createElement(X.a,{onClick:function(e){l(lt("5ee2aefee028a1d4cfb07252"))}},"Open Note"),r.a.createElement(Ht,null))},ta=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).token=sessionStorage.getItem("token"),e.state={oldPassword:"",newPassword:""},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(m.a)({},a,n))}},{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state);var t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(T,"/users/").concat(sessionStorage.getItem("userId"),"/password");E.a.put(a,this.state,t).then((function(e){alert("Password is Successfully changed")})).catch((function(e){alert(e)}))}},{key:"render",value:function(){return r.a.createElement(v.a,null,r.a.createElement("div",{className:"mrg-8-top"},r.a.createElement(y.a,null,r.a.createElement("h3",null,"Change Password")),r.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"form"},r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"oldPassword"},"Current Password"),r.a.createElement(N.a,{type:"password",id:"oldPassword",placeholder:"Enter Current Password",name:"oldPassword",value:this.state.oldPassword,onChange:this.handleChange}))),r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{htmlFor:"newPassword"},"New Password"),r.a.createElement(N.a,{type:"password",id:"password",placeholder:"Enter New Password",name:"newPassword",value:this.state.newPassword,onChange:this.handleChange}))),r.a.createElement(y.a,{className:"mrg-1-top"},r.a.createElement(O.a,null,"Save")))))}}]),a}(n.Component),aa=function(e){var t=Object($.d)((function(e){return e.globals.communityId})),a=Object($.c)();return Object(n.useEffect)((function(){console.log("use effect"),a(Yt(t)),a(ie(t))}),[a,t]),r.a.createElement("div",{style:{marginTop:"100px"}},r.a.createElement(Tt,{note:{id:1,title:"hola",content:"asdf",attachments:[]}}),r.a.createElement(vt,null))};a(183),a(184);var na=function(){return Object(n.useEffect)((function(){var e=sessionStorage.getItem("token");e&&x(e)})),r.a.createElement("div",null,r.a.createElement(u.a,null),r.a.createElement(ge,null),r.a.createElement(l.a,null,r.a.createElement(i.a,{exact:!0,path:"/",component:Y}),r.a.createElement(i.a,{path:"/signup",component:J}),r.a.createElement(i.a,{path:"/community-manager",component:he}),r.a.createElement(i.a,{path:"/view",component:Zt}),r.a.createElement(i.a,{path:"/new-note",component:ea}),r.a.createElement(i.a,{path:"/change-password",component:ta}),r.a.createElement(i.a,{path:"/test",component:aa})))},ra=Object(Z.a)({reducer:{dialogs:De,notes:nt,scaffolds:Ct,globals:le,users:Gt},devTools:!0});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement($.a,{store:ra},r.a.createElement(na,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[132,1,2]]]);
//# sourceMappingURL=main.25d5049d.chunk.js.map