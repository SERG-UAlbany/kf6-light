(this["webpackJsonpkf6-light"]=this["webpackJsonpkf6-light"]||[]).push([[0],{134:function(e,t,a){e.exports=a(202)},140:function(e,t,a){},168:function(e,t,a){},169:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},189:function(e,t,a){},197:function(e,t,a){},201:function(e,t,a){},202:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(24),i=a.n(r),c=(a(139),a(140),a(48)),s=a(51),l=a(66),u=a.n(l),m=a(8),d=a(16),h=a(17),p=a(7),f=a(18),b=a(19),g=a(10),E=a.n(g),v=a(207),y=a(208),w=a(209),O=a(210),k=a(211),C=a(212),N=a(213),I=a(9),S=a.n(I),j=a(15),_="https://kf6-stage.ikit.org",x="".concat(_,"/api");function A(e){E.a.defaults.headers.common.Authorization="Bearer ".concat(e)}var T=sessionStorage.getItem("token");T&&A(T);var D,F,L,R,V,M=function(e){return E.a.get("".concat(x,"/communities/").concat(e))},P=function(){var e=Object(j.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(x,"/communities/").concat(t,"/groups"));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(j.a)(S.a.mark((function e(t,a,n){var o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(x,"/links/").concat(a,"/").concat(t));case 2:return o=(o=e.sent).data,n&&(o=o.filter((function(e){return e.type===n}))),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(j.a)(S.a.mark((function e(t,a,n,o){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("".concat(x,"/links"),{from:t,to:a,type:n,data:o});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t,a,n,o){return e.apply(this,arguments)}}(),H=function(){var e=Object(j.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.delete("".concat(x,"/links/").concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(j.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(x,"/objects/").concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(j.a)(S.a.mark((function e(t,a,n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.put("".concat(x,"/objects/").concat(a,"/").concat(n),t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),q=function(e,t){var a={communityId:e,type:"Attachment",title:"an Attachment",authors:[t],status:"unsaved",permission:"protected",data:{version:0}};return E.a.post("".concat(x,"/contributions/").concat(e),a)},G=function(){var e=Object(j.a)(S.a.mark((function e(t,a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("".concat(x,"/contributions/").concat(t),a);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=function(){var e=Object(j.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(x,"/communities/").concat(t,"/authors"));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(j.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(x,"/records/object/").concat(t));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(e,t){var a=new FormData;return a.append("file",e),E.a.post("".concat(x,"/upload"),a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:t})},Q=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).state={userName:"",password:""},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(m.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state),E.a.post("".concat(_,"/auth/local"),this.state).then((function(e){console.log(e.data.token),t.token=e.data.token,sessionStorage.setItem("token",t.token),A(t.token),t.props.history.push("/community-manager")})).catch((function(e){}))}},{key:"render",value:function(){return o.a.createElement(v.a,null,o.a.createElement("div",{className:"mrg-4-top"},o.a.createElement(y.a,null,o.a.createElement("h3",null,"Login")),o.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"form"},o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"userName"},"Username"),o.a.createElement(C.a,{type:"text",id:"userName",placeholder:"Enter Username",name:"userName",value:this.state.userName,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"password"},"Password"),o.a.createElement(C.a,{type:"password",id:"password",placeholder:"Enter Password",name:"password",value:this.state.password,onChange:this.handleChange}))),o.a.createElement(y.a,{className:"mrg-1-top"},o.a.createElement(N.a,null,"Login")),o.a.createElement(y.a,{className:"mrg-1-top"},o.a.createElement(c.b,{to:"/signup"},"If you don't have an account, please SignUp")))))}}]),a}(n.Component),X=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).state={firstName:"",lastName:"",email:"",userName:"",password:"",registrationKey:""},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(m.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state),E.a.post("".concat(x,"/users"),this.state).then((function(e){console.log(e.data.token),t.token=e.data.token,sessionStorage.setItem("token",t.token),t.props.history.push("/community-manager")})).catch((function(e){e.message&&(console.log(e.message),alert("Enter Valid Username and Password"))}))}},{key:"render",value:function(){return o.a.createElement(v.a,null,o.a.createElement("div",{className:"mrg-4-top"},o.a.createElement(y.a,null,o.a.createElement("h3",null,"SignUp")),o.a.createElement(w.a,{onSubmit:this.handleSubmit,class:"form"},o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"firstName"},"First Name"),o.a.createElement(C.a,{type:"text",id:"firstName",placeholder:"Enter First Name",name:"firstName",value:this.state.firstName,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"lastName"},"Last Name"),o.a.createElement(C.a,{type:"text",id:"lastName",placeholder:"Enter Last Name",name:"lastName",value:this.state.lastName,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"email"},"Email"),o.a.createElement(C.a,{type:"email",id:"email",placeholder:"Enter Email",name:"email",value:this.state.email,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"userName"},"Username"),o.a.createElement(C.a,{type:"text",id:"userName",placeholder:"Enter Username",name:"userName",value:this.state.userName,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"password"},"Password"),o.a.createElement(C.a,{type:"password",id:"password",placeholder:"Enter Password",name:"password",value:this.state.password,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(N.a,{className:""},"New Account")),o.a.createElement(y.a,{className:"mrg-1-top"},o.a.createElement(c.b,{to:"/",className:"FormField__Link"},"If you already have an account, please Signin")))))}}]),a}(n.Component),Z=a(214),ee=a(116),te=a(13),ae=a(26),ne=a(11),oe=Object(ne.b)("SET_COMMUNITY"),re=Object(ne.b)("SET_COMMUNITY_ID"),ie=Object(ne.b)("SET_VIEW_ID"),ce=Object(ne.b)("SET_AUTHOR"),se=Object(ne.b)("SET_VIEW"),le=Object(ne.b)("EDIT_COMMUNITY"),ue={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0},me={communityId:sessionStorage.getItem("communityId"),viewId:sessionStorage.getItem("viewId"),contextId:"",author:{},view:null,community:null},de=Object(ne.c)(me,(D={},Object(m.a)(D,re,(function(e,t){e.communityId=t.payload})),Object(m.a)(D,ie,(function(e,t){e.viewId=t.payload})),Object(m.a)(D,ce,(function(e,t){e.author=t.payload})),Object(m.a)(D,se,(function(e,t){e.view=t.payload})),Object(m.a)(D,oe,(function(e,t){e.community=t.payload,e.contextId=t.payload.rootContextId})),Object(m.a)(D,le,(function(e,t){e.community=Object(ae.a)({},e.community,{},t.payload)})),D)),he=function(e){return function(t){return function(e){return E.a.get("".concat(x,"/authors/").concat(e,"/me"))}(e).then((function(e){t(ce(e.data))}))}},pe=function(e){return function(t){return U(e).then((function(e){t(se(e))}))}},fe=function(e){return function(t){return M(e).then((function(e){t(oe(Object(ae.a)({groups:[]},e.data)))}))}},be=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).token=sessionStorage.getItem("token"),n.myRegistrations=[],n.config={headers:{Authorization:"Bearer ".concat(n.token)}},n.handleChange=function(e){var t=e.target,a=t.name,o=t.value;console.log(a,o),n.setState(Object(m.a)({},a,o))},n.state={communitites:[],password:"",communityId:"",welcomeId:"",userId:sessionStorage.getItem("userId"),token:sessionStorage.getItem("token"),registrations:[]},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("FORM",this.state);var t="".concat(x,"/authors"),a={communityId:this.state.communityId,registrationKey:this.state.password,userId:this.state.userId},n={headers:{Authorization:"Bearer ".concat(this.state.token)}};E.a.post(t,a,n).then((function(e){console.log("AUTHOR",e.data),window.location.reload()})).catch((function(e){}))}},{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat(x,"/communities")).then((function(t){e.communityData=t.data,console.log(e.communityData),e.setState({communitites:t.data})})).catch((function(e){console.log("GET Communities Failed"),alert("GET Communities Failed")})),E.a.get("".concat(x,"/users/myRegistrations"),this.config).then((function(t){console.log("registrations"),console.log(t.data),e.myRegistrations=t.data,e.setState({registrations:t.data})})).catch((function(e){alert(e)}))}},{key:"enterCommunity",value:function(e){var t=this,a=e.obj.communityId;sessionStorage.setItem("communityId",e.obj.communityId),this.props.setCommunityId(a);var n={communityId:a,welcomeId:""},o={headers:{Authorization:"Bearer ".concat(this.token)}},r="".concat(x,"/communities/").concat(a,"/views");console.log(r),E.a.get(r,o).then((function(e){n.welcomeId=e.data[0]._id,sessionStorage.setItem("viewId",e.data[0]._id),t.props.setViewId(e.data[0]._id),t.props.history.push({pathname:"/view",state:n})})).catch((function(e){alert(e)}))}},{key:"render",value:function(){var e=this;return o.a.createElement(v.a,null,o.a.createElement("div",{className:"mrg-4-top"},o.a.createElement(v.a,{className:"mrg-2-top"},o.a.createElement("h6",null,"My Knowledge Building Communities"),this.state.registrations.map((function(t,a){return o.a.createElement(Z.a,{key:a,value:t.communityId,className:"mrg-05-top"},o.a.createElement(y.a,null,t._community.title),o.a.createElement(y.a,null,o.a.createElement(ee.a,{variant:"outline-secondary",onClick:function(){return e.enterCommunity({obj:t})}},"Enter Community")))}))),o.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"form"},o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,null,"Register Community"),o.a.createElement(C.a,{type:"select",name:"communityId",id:"communityId",value:this.state.communityId,onChange:this.handleChange},this.state.communitites.map((function(e){return o.a.createElement("option",{key:e._id,value:e._id},e.title)})))),o.a.createElement(O.a,null,o.a.createElement(k.a,null,"Registration Key"),o.a.createElement(C.a,{type:"password",name:"password",placeholder:"Enter Registration Key",id:"password",value:this.state.password,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(ee.a,{variant:"secondary",onClick:this.handleSubmit},"Submit")))))}}]),a}(n.Component),ge={setCommunityId:re,setViewId:ie},Ee=Object(te.b)((function(e,t){return{}}),ge)(be),ve=a(224),ye=a(132),we=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).state={loggedIn:!!sessionStorage.getItem("token"),userName:null,token:sessionStorage.getItem("token"),myViews:[],viewId:sessionStorage.getItem("viewId")?sessionStorage.getItem("viewId"):"",viewTitle:sessionStorage.getItem("viewTitle")?sessionStorage.getItem("viewTitle"):"welcome",communityId:sessionStorage.getItem("communityId")},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t={headers:{Authorization:"Bearer ".concat(this.state.token)}};if(E.a.get("".concat(x,"/users/me"),t).then((function(t){e.setState({userName:t.data.firstName+" "+t.data.lastName}),sessionStorage.setItem("userId",t.data._id)})).catch((function(e){})),this.state.communityId){var a="".concat(x,"/communities/").concat(this.state.communityId,"/views");E.a.get(a,t).then((function(t){e.setState({myViews:t.data})})).catch((function(e){}))}}},{key:"logout",value:function(){sessionStorage.removeItem("token"),delete E.a.defaults.headers.common.Authorization;for(var e=sessionStorage.length;e--;){var t=sessionStorage.key(e);/foo/.test(t)&&sessionStorage.removeItem(t)}}},{key:"handleChange",value:function(e){var t=this;e.persist();var a=e.target,n=a.value;sessionStorage.setItem("viewId",n),this.setState({viewId:n});var o={headers:{Authorization:"Bearer ".concat(this.state.token)}},r="".concat(x,"/objects/").concat(a.value);E.a.get(r,o).then((function(e){console.log(e.data),t.setState({viewTitle:e.data.title}),sessionStorage.setItem("viewTitle",e.data.title)})).catch((function(e){alert(e)}))}},{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state)}},{key:"render",value:function(){return o.a.createElement(ve.a,{bg:"dark",variant:"dark",fixed:"top"},o.a.createElement(ve.a.Brand,{href:"#community-manager"},"KF6 Light"),this.state.loggedIn?o.a.createElement(ye.a,{className:"mr-auto"},o.a.createElement("span",{className:"mrg-105-top white"},this.state.viewTitle),o.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"mrg-1-top"},o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"select",name:"viewId",value:this.state.viewId,onChange:this.handleChange},this.state.myViews.map((function(e){return o.a.createElement("option",{key:e._id,value:e._id}," ",e.title," ")}))))))):o.a.createElement(ye.a,{className:"mr-auto"},o.a.createElement(ye.a.Link,{href:"#signup"},"Signup"),o.a.createElement(ye.a.Link,{href:"/"},"Login")),this.state.loggedIn?o.a.createElement(o.a.Fragment,null,o.a.createElement(ye.a.Link,{href:"#change-password"},o.a.createElement("i",{className:"fas fa-cog white"})),o.a.createElement("span",{className:"white"}," ",this.state.userName," "),o.a.createElement(ee.a,{variant:"outline-secondary",href:"/",onClick:this.logout},"Logout")):null)}}]),a}(n.Component),Oe=a(36),ke=a(123),Ce=a(217),Ne=a(220),Ie=a(95),Se=a(222),je=a(34),_e=Object(ne.b)("OPEN_DIALOG"),xe=Object(ne.b)("CLOSE_DIALOG"),Ae=Object(ne.b)("OPEN_DRAW_DIALOG"),Te=Object(ne.b)("CLOSE_DRAW_DIALOG"),De=Object(ne.b)("FOCUS_DIALOG"),Fe=Object(ne.b)("OPEN_ATTACH_PANEL"),Le=Object(ne.b)("CLOSE_ATTACH_PANEL"),Re=0,Ve=Object(ne.c)({dialogs:[],drawTool:null,focused:null,attachPanel:{}},(F={},Object(m.a)(F,_e,(function(e,t){var a=e.dialogs.map((function(t){return t.id===e.focused&&(t.zIndex=1e3),t}));e.focused=Re,e.dialogs=[].concat(Object(Oe.a)(a),[Object(ae.a)({id:Re++,zIndex:1100},t.payload)])})),Object(m.a)(F,xe,(function(e,t){e.dialogs=e.dialogs.filter((function(e){return e.id!==t.payload}))})),Object(m.a)(F,Ae,(function(e,t){e.drawTool=t.payload})),Object(m.a)(F,Te,(function(e,t){e.drawTool=null})),Object(m.a)(F,Fe,(function(e,t){e.attachPanel=t.payload})),Object(m.a)(F,Le,(function(e,t){e.attachPanel={}})),Object(m.a)(F,De,(function(e,t){e.focused!==t.payload&&(e.dialogs=e.dialogs.map((function(a){return a.id===e.focused?a.zIndex=1e3:a.id===t.payload&&(a.zIndex=1100),a})),e.focused=t.payload)})),F)),Me=a(54),Pe=a.n(Me),Be=function(e,t){var a="";return a+=" ",a+=t?'<span class="kfSupportStartMark kfTemplateStartMark"> &nbsp; </span>':'<span class="kfSupportStartMark"> &nbsp; </span>',a+=" ",a=t?a+'<span class="kfSupportStartLabel kfTemplateStartLabel">'+e+"</span>":a+'<span class="kfSupportStartLabel">'+e+"</span>",a+=" "},ze=function(e){var t="";return t+=" ",t+=e?'<span class="kfSupportEndMark kfTemplateEndMark"> &nbsp; </span>':'<span class="kfSupportEndMark"> &nbsp; </span>',t+=" "},He=function(e,t,a,n){var o="";return n&&n.length>0&&(o=o+'<span class="KFReferenceQuote"><span>"</span><span class="KFReferenceText">'+n+'</span><span>"</span></span>'),o=(o=o+'<span> (<a href="contribution/'+e+'" target="'+e+'">')+'<img src="/manual_assets/kf4images/icon-note-unread-othr-.gif">"'+t+'"</a>',o+='<span class="KFReferenceAuthor"> by (missing authors)</span>)</span>',o+="</span>"},Ue=function(e,t,a){var n="<div>"+e+"</div>",o=Pe()(n),r=o.find(".KFSupportStart");r.addClass("mceNonEditable");for(var i=function(e){var a=r[e];if(!a.id.startsWith("supportid_")){var n=Pe()(a).hasClass("KFTemplateStart"),o=t.filter((function(e){return e._id===a.id}));o.length?a.innerHTML=Be(o[0]._from.title,n):"Annotation"!==t&&(a.innerHTML=Be("(missing link)",n))}},c=0;c<r.length;c++)i(c);var s=o.find(".KFSupportEnd");s.addClass("mceNonEditable");for(var l=0;l<s.length;l++){var u=s[l],m=Pe()(u).hasClass("KFTemplateEnd");u.innerHTML=ze(m)}var d=o.find(".KFReference");d.addClass("mceNonEditable");for(var h=function(e){var t=s[e],n=a.filter((function(e){return e._id===t.id}));if(n.length){var o="";(n=n[0]).data&&(o=n.data.text),t.innerHTML=He(n.to,n._to.title,n._to.authors,o)}else t.innerHTML=He("","(missing link)",0,"")},p=0;p<d.length;p++)h(p);return o.html()},Ke=function(){var e=Object(j.a)(S.a.mark((function e(t,a,n,o,r){var i,c,s,l,u,m,d,h,p,f,b,g,E,v,y,w,O,k,C,N;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i="<div>"+t+"</div>",c=Pe()(i),s={},l=n.filter((function(e){return"supports"===e.type})).map((function(e){return e._id})),u=c.find(".KFSupportStart"),m=c.find(".KFSupportEnd"),d=[],h=[],p=0;p<m.length;p++)(f=m[p]).innerHTML="",b=f.id,s[b]=f;for(g=function(e){var t=u[e],n=t.id;t.innerHTML="",n.startsWith("supportid_")&&(n=n.split("_")[1]),h.push(n),l.includes(n)||d.push(z(n,a,"supports").then((function(e){var a=t.id,n=e._id;t.id=n,s[a]&&(s[a].id=n)})))},E=0;E<u.length;E++)g(E);for(v=l.filter((function(e){return!h.includes(e)})).map((function(e){return H(e)})),y=o.filter((function(e){return"references"===e.type})).map((function(e){return e._id})),w=c.find(".KFReferenceText"),O=[],k=function(){var e=w[C],t={text:Pe()(e).find(".KFReferenceText").html()};e.innerHTML="";var n=e.id;O.push(n),y.includes(n)||d.push(z(a,n,"references",t).then((function(t){var a=e.id,n=t._id;e.id=n,s[a]&&(s[a].id=n)})))},C=0;C<w.length;C++)k();return N=y.filter((function(e){return!O.includes(e)})).map((function(e){return H(e)})),e.next=20,Promise.all(v);case 20:return e.next=22,Promise.all(N);case 22:return e.next=24,Promise.all(d);case 24:return e.abrupt("return",c);case 25:case"end":return e.stop()}}),e)})));return function(t,a,n,o,r){return e.apply(this,arguments)}}(),qe={type:"success",insert:"top",container:"top-right",animationIn:["animated","fadeIn"],animationOut:["animated","fadeOut"],dismiss:{duration:5e3}},Ge=function(e){return l.store.addNotification(Object(ae.a)({},qe,{},e))},We=Object(ne.b)("ADD_NOTE"),$e=Object(ne.b)("REMOVE_NOTE"),Ye=Object(ne.b)("EDIT_NOTE"),Je=Object(ne.b)("ADD_DRAWING"),Qe=Object(ne.b)("REMOVE_DRAWING"),Xe=Object(ne.b)("EDIT_SVG"),Ze=Object(ne.b)("ADD_ATTACHMENT"),et=Object(ne.b)("REMOVE_ATTACHMENT"),tt=Object(ne.b)("SET_ATTACHMENTS"),at=Object(ne.b)("SET_WORDCOUNT"),nt=Object(ne.b)("SET_CONNECTIONS"),ot=Object(ne.b)("SET_RECORDS"),rt=Object(ne.b)("REMOVE_CONTRIB_AUTHOR"),it=Object(ne.b)("ADD_CONTRIB_AUTHOR"),ct=Object(ne.b)("SET_ANNOTATION"),st=Object(ne.b)("SET_ANNOTATIONS_LOADED"),lt=Object(ne.b)("REMOVE_ANNOTATION"),ut=Object(ne.c)({drawing:"",attachments:{}},(L={},Object(m.a)(L,We,(function(e,t){e[t.payload._id]=t.payload})),Object(m.a)(L,$e,(function(e,t){delete e[t.payload]})),Object(m.a)(L,Ye,(function(e,t){var a=e[t.payload._id];e[t.payload._id]=Object.assign({},a,t.payload)})),Object(m.a)(L,Je,(function(e,t){e.drawing=t.payload})),Object(m.a)(L,Qe,(function(e,t){e.drawing=""})),Object(m.a)(L,Xe,(function(e,t){e[t.payload.noteId].editSvg=t.payload.svg})),Object(m.a)(L,Ze,(function(e,t){e[t.payload.noteId].attachments.push(t.payload.attachment._id),e.attachments[t.payload.attachment._id]=t.payload.attachment})),Object(m.a)(L,et,(function(e,t){var a=e[t.payload.noteId];a.attachments=a.attachments.filter((function(e){return e.id!==t.payload.attId}))})),Object(m.a)(L,tt,(function(e,t){e[t.payload.contribId].attachments=t.payload.attachments.map((function(e){return e._id})),t.payload.attachments.forEach((function(t){e.attachments[t._id]=t}))})),Object(m.a)(L,at,(function(e,t){e[t.payload.contribId].wordCount=t.payload.wc})),Object(m.a)(L,nt,(function(e,t){var a=e[t.payload.contribId];"from"===t.payload.direction?a.fromLinks=t.payload.links:a.toLinks=t.payload.links})),Object(m.a)(L,ot,(function(e,t){e[t.payload.contribId].records=t.payload.records})),Object(m.a)(L,it,(function(e,t){var a=e[t.payload.contribId];a.authors=[].concat(Object(Oe.a)(a.authors),[t.payload.author])})),Object(m.a)(L,rt,(function(e,t){var a=e[t.payload.contribId];a.authors=a.authors.filter((function(e){return e!==t.payload.author}))})),Object(m.a)(L,ct,(function(e,t){e[t.payload.contribId].annos[t.payload.annotation._id]=t.payload.annotation})),Object(m.a)(L,st,(function(e,t){e[t.payload.contribId].annotsFetched=t.payload.value})),Object(m.a)(L,lt,(function(e,t){delete e[t.payload.contribId].annos[t.payload.annoId]})),L)),mt=function(e,t,a){return function(n){var o={permission:e.permission,group:e.group,_groupMembers:e._groupMembers},r=null===sessionStorage.getItem("buildOn")?function(e,t,a,n,o){if(o||(o=""),!a||a.permission){var r={};a&&"private"===a.permission?(r.permission=a.permission,r.group=a.group,r._groupMembers=a._groupMembers):(r.permission="protected",r.group=void 0,r._groupMembers=[]);var i={communityId:e,type:"Note",title:a&&a.title?a.title:"",authors:[t],status:a&&a.status?a.status:"unsaved",permission:r.permission,group:r.group,_groupMembers:r._groupMembers,data:{body:a&&a.body?a.body:""},buildson:n,langInNote:[]};if(a&&a.docId){i.docId=a.docId;var c=i.authors[0];if(a.coauthors)for(var s=a.coauthors.split(","),l=0;l<s.length;l++)s[l]!==c&&i.authors.push(s[l]);a.createdBy&&(i.createdBy=a.createdBy),i.docShared=[c],i.text4search=a.text4search}return i}window.alert("invalid mode object")}(t,a,o):{authors:a,buildson:sessionStorage.getItem("buildOn"),communityId:t,data:{body:""},permission:e.permission,status:"unsaved",title:"",type:"Note",_groupMembers:[]};return r&&sessionStorage.removeItem("buildOn"),function(e,t){return E.a.post("".concat(x,"/contributions/").concat(e),t)}(t,r).then((function(t){var a=Object(ae.a)({attachments:[],fromLinks:[],toLinks:[],records:[],annos:{},group:null},t.data);z(e._id,a._id,"contains",{x:100,y:100}),n(We(a)),n(_e({title:"New Note",confirmButton:"create",noteId:a._id}))}))}},dt=function(e){return function(){var t=Object(j.a)(S.a.mark((function t(a){var n,o;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B(e,"from","attach");case 2:return n=t.sent,t.next=5,Promise.all(n.map((function(e){return U(e.to)})));case 5:o=t.sent,a(tt({contribId:e,attachments:o}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ht=function(e,t){return function(){var a=Object(j.a)(S.a.mark((function a(n){var o;return S.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,B(e,t);case 2:o=a.sent,n(nt({contribId:e,direction:t,links:o}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},pt=function(e){return function(){var t=Object(j.a)(S.a.mark((function t(a,n){var o,r,i,c,s,l,u,m;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([U(e),B(e,"from"),B(e,"to")]);case 2:return o=t.sent,r=Object(je.a)(o,3),i=r[0],c=r[1],s=r[2],l=Object(ae.a)({attachments:[],fromLinks:c,toLinks:s,records:[],annos:{}},i),u=Ue(l.data.body,s,c),l.data.body=u,a(We(l)),a(dt(e)),a(_e({title:"Edit Note",confirmButton:"edit",noteId:l._id})),m=s.filter((function(e){return"annotates"===e.type})),t.next=16,Promise.all(m.map((function(e){return U(e.from).then((function(t){return t.data.linkId=e._id,t.data.modelId=t._id,t}))})));case 16:t.sent.forEach((function(t){return a(ct({annotation:t,contribId:e}))})),a(st({contribId:e,value:1})),"active"===l.status&&(n=l.communityId,d=l._id,E.a.post("".concat(x,"/records/read/").concat(n,"/").concat(d)));case 20:case"end":return t.stop()}var n,d}),t)})));return function(e,a){return t.apply(this,arguments)}}()},ft=a(118),bt=a(226),gt=(a(168),{zIndex:999,display:"flex"}),Et=function(e){return o.a.createElement(ft.a,{id:"contrib-dialog-".concat(e.id),className:"contrib-dialog",style:Object(ae.a)({},gt,{},e.style),default:{x:400+window.pageXOffset,y:50+window.pageYOffset,width:920,height:500},onClick:e.onClick,onMouseDown:e.onMouseDown,dragHandleClassName:"dlg-card-header",bounds:"window"},o.a.createElement(bt.a,{className:"dlg-card"},o.a.createElement(bt.a.Header,{className:"dlg-card-header py-0",style:{alignItems:"center",display:"flex"}},o.a.createElement("span",null,e.title),o.a.createElement(ee.a,{onClick:e.onClose,variant:"link",size:"sm",style:{marginLeft:"auto"}},"x")),o.a.createElement(bt.a.Body,{className:"dlg-card-body"},e.children),o.a.createElement(bt.a.Footer,{className:"dlg-card-footer py-0"},o.a.createElement(ee.a,{size:"sm",className:"dlg-confirm-button",onClick:e.onConfirm},e.confirmButton))))},vt=a(218),yt=a(219),wt=a(131),Ot=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(wt.a,{value:this.props.value,apiKey:"arg05azt52qbujpnf831szuswhmyhoqute0q48btk5bqigoj",init:{setup:function(t){e.props.onEditorSetup(t)},content_css:"./editor.css",height:300,menubar:!1,statusbar:!1,media_live_embeds:!0,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code wordcount media help"],external_plugins:{drawingTool:"/drawing-tool/plugin.min.js"},toolbar:"styleselect | bold italic underline strikethrough | forecolor backcolor bullist numlist | link code | ltr rtl | charmap | drawingTool media"},onEditorChange:this.props.onEditorChange}))}}]),a}(o.a.Component),kt=a(223),Ct=a(215),Nt=a(121),It=(a(169),function(e){var t=Object(te.d)((function(e){return e.globals.author})),a=Object(te.c)(),r=Object(n.useState)(0),i=Object(je.a)(r,2),c=i[0],s=i[1],l=function(t){e.onClose()},u=function(e){var t=Array.from(e);s(0),t.forEach((function(e){if(e.type.indexOf("image/")>=0){var t=window.URL||window.webkitURL,a=document.createElement("img");a.onload=function(){var t=a.naturalWidth||a.width,n=a.naturalHeight||a.height;e.width=t,e.height=n,m(e,"image")},a.src=t.createObjectURL(e)}else e.type.startsWith("video")?m(e,"video"):m(e,"link")}))},m=function(){var n=Object(j.a)(S.a.mark((function n(o,r){var i,c,s,l,u,m,h,p;return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,q(t.communityId,t._id);case 3:return i=n.sent,n.next=6,J(o,d);case 6:return c=n.sent,s=i.data,l=c.data,s.title=l.filename,s.status="active",l.version=s.data.version+1,s.data=l,s.tmpFilename=l.tmpFilename,n.next=16,K(s,t.communityId,s._id);case 16:return(u=n.sent).data.width=o.width,u.data.height=o.height,n.next=21,z(e.noteId,s._id,"attach");case 21:e.inlineAttach?(m="".concat(_).concat(u.data.url),h=u.title,p="","image"===r?p='<img class="inline-attachment '+s._id+'" src="'+m+'" width="100px" alt="'+h+'" data-mce-src="'+m+'">':"video"===r?p='<video controls="controls" width="300" height="150"> <source src="'.concat(m,'" type="video/mp4" /></video>'):(p='<a class="inline-attachment '+s._id+'" href="'+m+'" target="_blank" download>',p+='<img src="'.concat(_,'/manual_assets/kf6images/03-toolbar-attachment.png" alt="')+h+'">'+h+"</a>"),e.onNewInlineAttach(p)):a(dt(e.noteId)),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(0),console.log(n.t0);case 27:return n.prev=27,n.finish(27);case 29:case"end":return n.stop()}}),n,null,[[0,24,27,29]])})));return function(e,t){return n.apply(this,arguments)}}(),d=function(e){var t=Math.round(100*e.loaded/e.total);s(t)};return o.a.createElement(Se.a,{show:e.attachPanel,onHide:l},o.a.createElement(Se.a.Header,{closeButton:!0},o.a.createElement(Se.a.Title,null,"Insert Attachment File")),o.a.createElement(Se.a.Body,null,o.a.createElement(kt.a.File,{id:"custom-file"},o.a.createElement(kt.a.File.Input,{onChange:function(e){u(e.target.files)}})),o.a.createElement("div",{style:{width:"100%",color:"black"}},o.a.createElement(Nt.FileDrop,{onFrameDragEnter:function(e){return console.log("onFrameDragEnter",e)},onFrameDragLeave:function(e){return console.log("onFrameDragLeave",e)},onFrameDrop:function(e){return console.log("onFrameDrop",e)},onDragOver:function(e){return console.log("onDragOver",e)},onDragLeave:function(e){return console.log("onDragLeave",e)},onDrop:function(e,t){return u(e)}},"or drop some files here!")),o.a.createElement(Ct.a,{now:c})),o.a.createElement(Se.a.Footer,null,o.a.createElement(ee.a,{variant:"primary",onClick:l},"Close")))}),St=a(216),jt=Object(ne.b)("REQUEST_SCAFFOLD"),_t=Object(ne.b)("RECEIVE_SCAFFOLD"),xt=Object(ne.c)({isFetching:!1,items:[],fetched:!1},(R={},Object(m.a)(R,_t,(function(e,t){e.items=t.payload,e.isFetching=!1,e.fetched=!0})),Object(m.a)(R,jt,(function(e,t){e.isFetching=!0})),R)),At=function(e,t){var a="";return a+=" ",a+=t?'<span class="kfSupportStartMark kfTemplateStartMark"> &nbsp; </span>':'<span class="kfSupportStartMark"> &nbsp; </span>',a+=" ",a=t?a+'<span class="kfSupportStartLabel kfTemplateStartLabel">'+e+"</span>":a+'<span class="kfSupportStartLabel">'+e+"</span>",a+=" "},Tt=function(e){var t="";return t+=" ",t+=e?'<span class="kfSupportEndMark kfTemplateEndMark"> &nbsp; </span>':'<span class="kfSupportEndMark"> &nbsp; </span>',t+=" "},Dt=function(e,t,a,n){return function(o){var r=(new Date).getTime().toString(),i='<span id="'+r+'"></span>'+o;n&&(i=" -&nbsp;"+i+"&nbsp;- ");var c="";return c+="<br>",c+="&nbsp;&nbsp;",c=a?c+'<span id="'+e+'" class="KFSupportStart KFTemplateStart mceNonEditable">':c+'<span id="'+e+'" class="KFSupportStart mceNonEditable">',c+=At(t,a),c+="</span>",a&&(c+='<p class="kfTemplateContent">',c+="<br><br><br><br>"),c+=i,a&&(c+="</p>"),c=a?c+'<span id="'+e+'" class="KFSupportEnd KFTemplateEnd mceNonEditable">':c+'<span id="'+e+'" class="KFSupportEnd mceNonEditable">',c+=Tt(a),c+="</span>",c+="&nbsp;&nbsp;",{tag:c+="<br>",supportContentId:r}}},Ft=(a(170),function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).scaffoldSelected=function(e,t){var a=n.props.items[e],o=!0,r="",i=a.data&&a.data.isTemplate;i&&(o=!1,r="<br><br>");var c=t._to.title,s=Dt(t.to,c,i,o);n.props.onScaffoldSelected(s,r)},n.state={selected:e.initVal},n.onSelectChange=n.onSelectChange.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){if(!this.props.fetched){var e=this.props,t=e.communityId,a=e.contextId;this.props.fetchScaffolds(t,a)}}},{key:"onSelectChange",value:function(e){this.setState({selected:e.target.value})}},{key:"render",value:function(){var e=this,t=this.props.items,a=t.map((function(e,t){return o.a.createElement("option",{key:t,value:t},e.title)})),n="";return t.length&&t[this.state.selected].supports&&(n=t[this.state.selected].supports.map((function(t,a){return o.a.createElement(ke.a,{className:"mt-1 p-0",key:a,md:12},o.a.createElement("div",{className:"KFSupportButton",size:"sm",onClick:function(){return e.scaffoldSelected(e.state.selected,t)}},t._to.title))}))),o.a.createElement(St.a,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,{className:"p-0"},o.a.createElement(kt.a,null,o.a.createElement(kt.a.Group,{className:"mb-1",controlId:"exampleForm.ControlSelect2"},o.a.createElement(kt.a.Control,{size:"sm",as:"select",onChange:this.onSelectChange},a))))),o.a.createElement(Ce.a,null,n))}}]),a}(o.a.Component)),Lt={fetchScaffolds:function(e,t){return function(a){a(jt);var n=M(e).then((function(e){return Promise.all(e.data.scaffolds.map((function(e){return U(e)})))}));return Promise.all([n,B(t,"from","uses")]).then(function(){var e=Object(j.a)(S.a.mark((function e(t){var n,o,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t[1].map((function(e){return e.to})),o=t[0].filter((function(e){return n.includes(e._id)})),e.next=4,Promise.all(o.map((function(e){return B(e._id,"from")})));case 4:r=e.sent,o=o.map((function(e,t){return e.supports=r[t],e})),a(_t(o));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},Rt=Object(te.b)((function(e,t){return Object(ae.a)({communityId:e.globals.communityId,contextId:e.globals.contextId},e.scaffolds)}),Lt)(Ft),Vt=(a(171),function(e){var t=Object(te.d)((function(t){return e.attachments.map((function(e){return t.notes.attachments[e]}))})),a=Object(n.useState)([]),r=Object(je.a)(a,2),i=r[0],c=r[1],s=function(){};return o.a.createElement(ke.a,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement("span",{className:""},"Insert image or file: "),o.a.createElement(ee.a,{className:"attach-button mx-2",size:"sm",variant:"outline-dark",onClick:function(){return e.onNewAttachClick(!0)}},"Inline"),o.a.createElement(ee.a,{className:"attach-button mx-2",size:"sm",variant:"outline-dark",onClick:function(){return e.onNewAttachClick(!1)}},"As an attachment"),o.a.createElement(ee.a,{className:"attach-button mx-2",size:"sm",variant:"outline-dark",onClick:function(){console.log("Add images");var t=Array.from(document.getElementById("attachbox-".concat(e.noteId)).getElementsByClassName("selected"));if(0!==t.length){var a="";console.log(t),t.forEach((function(e){var t=e.tagName,n=e.naturalWidth;if(n>200&&(n=200),"IMG"===t){var o=e.getAttribute("src"),r="";e.classList.forEach((function(e){24===e.length&&(r+=e+" ")})),a+='<img class="inline-attachment '+r+'" src="'+o+'" width="'+n+'px" alt="" data-mce-src="'+o+'">'}})),e.onNewInlineAttach(a)}},disabled:0===i.length},"Insert"))),o.a.createElement(Ce.a,{id:"attachbox-".concat(e.noteId),className:"attachment-box"},t.map((function(e){return o.a.createElement("div",{key:e._id,className:"attachment-inner-box col-auto"},o.a.createElement("div",{className:"attachment-thumbnail"},0===e.data.type.indexOf("image/")?o.a.createElement("img",{className:e._id+" "+(i.includes(e._id)?"selected":""),src:"".concat(_).concat(e.data.url),onClick:function(t){return a=e._id,void(i.includes(a)?c((function(e){return e.filter((function(e){return e!==a}))})):c((function(e){return[].concat(Object(Oe.a)(e),[a])})));var a},alt:"attachment"}):o.a.createElement("a",{href:"".concat(_).concat(e.data.downloadUrl||e.data.url),title:e.title,download:!0},o.a.createElement("img",{className:e._id,src:"".concat(_,"/manual_assets/kf6images/03-toolbar-attachment.png"),title:"{attachment.title}",alt:"attachment"}))),o.a.createElement("div",{className:"attachment-buttons"},o.a.createElement("p",null,o.a.createElement("a",{href:"".concat(_).concat(e.data.downloadUrl||e.data.url),title:e.title,download:!0},o.a.createElement("img",{className:"download-attachment",src:"".concat(_,"/manual_assets/kf6images/cloud-download-2x.png"),alt:"Download",height:"15px"}))),o.a.createElement("p",null,o.a.createElement("button",{className:"delete-attachment",onClick:s},o.a.createElement("img",{src:"".concat(_,"/manual_assets/kf6images/trash.png"),alt:"Delete attachment",width:"10px",height:"15px"})))),o.a.createElement("div",{className:"attachment-info"},o.a.createElement("p",{title:"{attachment.title}"},e.title),o.a.createElement("p",null,e.data.size)))}))))}),Mt=(a(172),function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={inlineAttach:!0,attachPanel:!1},n.onScaffoldSelected=n.onScaffoldSelected.bind(Object(p.a)(n)),n.onNewAttachmentClick=n.onNewAttachmentClick.bind(Object(p.a)(n)),n.closeAttachPanel=n.closeAttachPanel.bind(Object(p.a)(n)),n.onNewInlineAttach=n.onNewInlineAttach.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"onScaffoldSelected",value:function(e,t){this.props.onChange({scaffold:{tagCreator:e,initialText:t}})}},{key:"onNewAttachmentClick",value:function(e){this.setState({inlineAttach:e,attachPanel:!0})}},{key:"onNewInlineAttach",value:function(e){this.props.onChange({attach:e})}},{key:"closeAttachPanel",value:function(){this.setState({attachPanel:!1})}},{key:"render",value:function(){var e=this.props,t=e.note,a=e.onChange,n=e.onEditorSetup;return o.a.createElement(St.a,{className:"write-container p-0"},o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement(kt.a.Group,{controlId:"note-title"},o.a.createElement(kt.a.Control,{type:"text",size:"sm",placeholder:"Enter title",value:t.title,onChange:function(e){a({title:e.target.value})}})))),o.a.createElement(Ce.a,null,o.a.createElement(ke.a,{md:2,className:"pr-0"},o.a.createElement(Rt,{initVal:0,onScaffoldSelected:this.onScaffoldSelected})),o.a.createElement(ke.a,{md:10},o.a.createElement(Ot,{value:t.data.body,onEditorSetup:n,onEditorChange:function(e,t){return a({data:{body:e}})}}),o.a.createElement("div",{className:"wordcount-bar text-right"},t.wordCount," words"))),o.a.createElement(Ce.a,{className:"mt-2"},o.a.createElement(It,Object.assign({noteId:t._id,onClose:this.closeAttachPanel,onNewInlineAttach:this.onNewInlineAttach},this.state)),o.a.createElement(Vt,{noteId:t._id,attachments:t.attachments,onNewAttachClick:this.onNewAttachmentClick,onNewInlineAttach:this.onNewInlineAttach})))}}]),a}(o.a.Component)),Pt=function(e){var t=e.records.reduce((function(e,t){return"read"===t.type?e[0].push(t):e[1].push(t),e}),[[],[]]),a=Object(je.a)(t,2),n=a[0],r=a[1];return o.a.createElement("div",null,o.a.createElement("h5",null,"Edit logs:"),o.a.createElement("p",{className:"mb-0"},r.length," edits"),o.a.createElement("ul",null,r.map((function(e){return o.a.createElement("li",{key:e._id},e.date,": ",e.author)}))),o.a.createElement("h5",null,"Read logs:"),o.a.createElement("p",{className:"mb-0"},n.length," reads"),o.a.createElement("ul",null,n.map((function(e){return o.a.createElement("li",{key:e._id},e.date,": ",e.author)}))))},Bt=function(e){var t=function(t){e.onChange({permission:t.target.value})};return o.a.createElement("div",{className:"m-2"},o.a.createElement("div",null,o.a.createElement("label",{className:"mt-1 font-weight-bold"},"Permission:"),o.a.createElement("div",null,o.a.createElement("table",{className:"KFPermission table table-sm"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"\xa0"),o.a.createElement("th",null,"Authors"),o.a.createElement("th",null,"Group Members"),o.a.createElement("th",null,"Others"))),o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("form",{action:""},o.a.createElement("div",{className:"form-check form-check-inline"},o.a.createElement("input",{className:"form-check-input",type:"radio",name:"permission",value:"private",id:"contrib-permission1",onChange:t,checked:"private"===e.contribution.permission}),o.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"contrib-permission1"},"\xa0private")))),o.a.createElement("td",null,"rw"),o.a.createElement("td",null,"rw"),o.a.createElement("td",null,"-")),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("form",{action:""},o.a.createElement("div",{className:"form-check form-check-inline"},o.a.createElement("input",{className:"form-check-input",type:"radio",value:"protected",id:"contrib-permission2",name:"permission",onChange:t,checked:"protected"===e.contribution.permission}),o.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"contrib-permission2"},"\xa0protected")))),o.a.createElement("td",null,"rw"),o.a.createElement("td",null,"rw"),o.a.createElement("td",null,"r")),o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("form",{action:""},o.a.createElement("div",{className:"form-check form-check-inline"},o.a.createElement("input",{className:"form-check-input",type:"radio",value:"public",id:"contrib-permission3",name:"public",onChange:t,checked:"public"===e.contribution.permission}),o.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"contrib-permission3"},"\xa0public")))),o.a.createElement("td",null,"rw"),o.a.createElement("td",null,"rw"),o.a.createElement("td",null,"rw"))))),o.a.createElement("label",{className:"mt-1 font-weight-bold"},"Status:"),o.a.createElement("div",{className:"ml-2"},e.contribution.status),o.a.createElement("label",{className:"mt-2 font-weight-bold"},"Template:"),o.a.createElement("form",{className:"ml-2",action:""},o.a.createElement("div",{className:"form-check  form-check-inline"},o.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"c-isTemplate",checked:e.contribution.data.isTemplate,onChange:function(t){e.onChange({data:{isTemplate:t.target.checked}})}}),o.a.createElement("label",{className:"form-check-label font-weight-normal",htmlFor:"c-isTemplate"},"isTemplate")))))},zt=a(91),Ht=function(e){var t=Object.entries(e.authors).map((function(e){return{value:e[1]._id,label:"".concat(e[1].firstName," ").concat(e[1].lastName)}})),a=Object(n.useState)(null),r=Object(je.a)(a,2),i=r[0],c=r[1];return o.a.createElement("div",null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement(zt.a,{options:t,onChange:function(e){c(e)},isClearable:!0})),o.a.createElement(ke.a,{md:"auto"},o.a.createElement(ee.a,{disabled:!i,onClick:function(){return e.onAuthorSelected(i)}},"Add"))),o.a.createElement("p",null,t.length," possible author(s) in this community."))},Ut=function(e){var t=Object(te.d)((function(t){return t.notes[e.contribId]})),a=Object(te.d)((function(e){return t.authors.map((function(t){return e.users[t]}))})),r=Object(te.d)((function(e){return e.users})),i=Object(te.d)((function(e){return e.globals.community.groups})).map((function(e){return{value:e.title,label:e.title}})),c=Object(n.useState)(t.group),s=Object(je.a)(c,2),l=s[0],u=s[1],m=Object(te.c)();return o.a.createElement("div",{className:"authorTab mt-2",style:{height:"100%"}},o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement("h5",null,"Authors:"),o.a.createElement("ul",null,a.map((function(t,a){return o.a.createElement("li",{key:t._id,style:{cursor:"move"}},t.firstName," ",t.lastName,o.a.createElement(ee.a,{size:"sm",className:"ml-1",onClick:function(){return function(t,a){0!==a?a>=0&&m(rt({contribId:e.contribId,author:t._id})):Ge({title:"Error!",type:"danger",message:"cannot remove the Primary Author"})}(t,a)}},"x"))})))),o.a.createElement(ke.a,null,o.a.createElement("div",null,o.a.createElement("h5",null,"Add author:"),o.a.createElement(Ht,{authors:r,onAuthorSelected:function(a){console.log(a),t.authors.includes(a.value)||m(it({contribId:e.contribId,author:a.value}))}})))),o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement("h5",null,"Group:"),o.a.createElement("div",null,o.a.createElement("form",{method:"",id:"",action:""},o.a.createElement(zt.a,{value:l,options:i,onChange:function(e){u(e),m(Ye({_id:t._id,group:e}))},isClearable:!0}))))))},Kt=a(124),qt=a(64),Gt=a.n(qt),Wt=(a(173),a(175),a(177),a(179),a(181),a(183),a(185),function(e,t,a,n){Annotator.Plugin.KFPlugin=function(){return{pluginInit:function(){this.annotator.subscribe("annotationCreated",(function(e){t&&t.annotationCreated(e)})).subscribe("annotationUpdated",(function(e){t&&t.annotationUpdated(e)})).subscribe("annotationDeleted",(function(e){t&&t.annotationDeleted(e)})).subscribe("annotationEditorShown",(function(e,a){t&&t.displayEditor(e,a)})).subscribe("annotationViewerShown",(function(e,a){t&&t.displayViewer(e,a)})).subscribe("annotationEditorHidden",(function(e,a){t&&t.editorHidden(e,a)})),t&&t.annotatorInitialized(this.annotator)}}};var o={}.hasOwnProperty;Annotator.Plugin.RichText=function(e){!function(e,t){for(var a in t)o.call(t,a)&&(e[a]=t[a]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(a,Annotator.Plugin);var t="";function a(e,t){return a.__super__.constructor.apply(this,arguments)}return a.prototype.options={tinymce:{selector:"li.annotator-item textarea",content_css:"/editor.css",height:"170px",statusbar:!1,plugins:"media image insertdatetime link code",menubar:!1,toolbar_items_size:"small",extended_valid_elements:"iframe[src|frameborder|style|scrolling|class|width|height|name|align|id]",toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | code | mysidebar"}},a.prototype.pluginInit=function(){var e=this.annotator,t=this.annotator.editor;Annotator.supported()&&(e.editor.addField({type:"input",load:this.updateEditor}),e.viewer.addField({load:this.updateViewer}),e.subscribe("annotationEditorShown",(function(){})),e.subscribe("annotationEditorHidden",(function(){})),this.options.tinymce.setup=function(e){a.prototype.mceditor=e,e.on("change",(function(e){$(t.element).find("textarea")[0].value=Gt.a.activeEditor.getContent()})),e.on("Init",(function(e){$(".mce-container").css("z-index","3090000000000000000")})),e.ui.registry.addSidebar("mysidebar",{tooltip:"View Scaffold",icon:"settings",onSetup:function(e){var t=e.element();document.sidebar=t,t.style.width="200px",t.style.overflow="scroll",t.style.fontSize="0.7rem",i.a.render(n,e.element(),null)},onShow:function(e){},onHide:function(e){}})},Gt.a.init(this.options.tinymce))},a.prototype.updateEditor=function(e,a){var n="undefined"!==typeof a.text?a.text:"",o=Gt.a.editors.length;t=Gt.a.editors[o-2].id,Gt.a.get(t).setContent(n),$(e).remove()},a.prototype.updateViewer=function(e,t){var a=$(e.parentNode).find("div:first-of-type")[0];a.innerHTML=t.text,$(a).addClass("richText-annotation"),$(e).remove()},a}(),e.annotator("addPlugin","KFPlugin"),e.annotator("addPlugin","Tags"),e.annotator("addPlugin","RichText"),a&&e.annotator("addPlugin","Permissions",{user:a,permissions:{read:[a],update:[a],delete:[a],admin:[a]},showEditPermissionsCheckbox:!1})}),$t=function(e){var t=0===e.permissions.read.length;e.permission=t?"protected":"private";var a=e.ranges[0];return 0===a.start.indexOf("/div[1]")&&(a.start=a.start.substring(7)),0===a.end.indexOf("/div[1]")&&(a.end=a.end.substring(7)),e},Yt=(a(187),Object(ne.b)("ADD_USER")),Jt=Object(ne.b)("ADD_AUTHORS"),Qt=Object(ne.c)({},(V={},Object(m.a)(V,Yt,(function(e,t){e[t.payload._id]=t.payload})),Object(m.a)(V,Jt,(function(e,t){t.payload.forEach((function(t){return e[t._id]=t}))})),V)),Xt=function(e){return function(){var t=Object(j.a)(S.a.mark((function t(a){var n;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W(e);case 2:n=t.sent,a(Jt(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Zt=Object(ne.a)({reducer:{dialogs:Ve,notes:ut,scaffolds:xt,globals:de,users:Qt},devTools:!0}),ea=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).contentRef=o.a.createRef(),n.annotatorInitialized=n.annotatorInitialized.bind(Object(p.a)(n)),n.annotationCreated=n.annotationCreated.bind(Object(p.a)(n)),n.annotationUpdated=n.annotationUpdated.bind(Object(p.a)(n)),n.annotator=null,n.displayEditor=n.displayEditor.bind(Object(p.a)(n)),n.displayViewer=n.displayViewer.bind(Object(p.a)(n)),n.fixPopupLocation=n.fixPopupLocation.bind(Object(p.a)(n)),n.editorHidden=n.editorHidden.bind(Object(p.a)(n)),n.loadAnnotations=n.loadAnnotations.bind(Object(p.a)(n)),n.onScaffoldSelected=n.onScaffoldSelected.bind(Object(p.a)(n)),n.dlg=null,n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=$(this.contentRef.current);e.annotator(),this.scaffoldElem=o.a.createElement(te.a,{store:Zt},o.a.createElement(Rt,{initVal:0,onScaffoldSelected:this.onScaffoldSelected})),Wt(e,{annotationCreated:this.annotationCreated,annotationUpdated:this.annotationUpdated,annotationDeleted:this.props.onDelete,displayEditor:this.displayEditor,displayViewer:this.displayViewer,annotatorInitialized:this.annotatorInitialized,editorHidden:this.editorHidden},this.props.author.userName,this.scaffoldElem),this.dlg=$("#contrib-dialog-".concat(this.props.containerId))}},{key:"componentDidUpdate",value:function(e,t){1===this.props.annotsFetched&&this.props.annotsFetched!==e.annotsFetched&&this.loadAnnotations()}},{key:"componentWillUnmount",value:function(){this.annotator&&this.annotator.plugins.RichText.mceditor&&this.annotator.plugins.RichText.mceditor.remove()}},{key:"editorHidden",value:function(e,t){$(e.element.find(".annotator-controls")).off()}},{key:"loadAnnotations",value:function(){var e=Object.values(this.props.annots).map((function(e){var t=Object.assign({},e.data);return t.ranges=Object(Oe.a)(t.ranges),t.highlights=Object(Oe.a)(t.highlights),function(e){var t=Object.assign({},e.ranges[0]);t.start="/div[1]"+t.start,t.end="/div[1]"+t.end,e.ranges[0]=t}(t),t}));this.annotator.loadAnnotations(e),this.props.onAnnotsLoaded()}},{key:"annotatorInitialized",value:function(e){this.annotator=e,this.loadAnnotations();var t=$("div.annotator-adder");t.attr("title","Annotation"),t.addClass("tooltip1"),t.append('<span class="tooltiptext">Annotation</span>'),document.annotator=this.annotator;var a=e.adder.get(0);this.observer=new MutationObserver(function(t){var n,o=Object(Kt.a)(t);try{for(o.s();!(n=o.n()).done;){if("attributes"===n.value.type&&"none"!==a.style.display)return this.fixPopupLocation(e.adder),void this.observer.takeRecords()}}catch(r){o.e(r)}finally{o.f()}}.bind(this)),this.observer.observe(a,{attributes:!0,attributeOldValue:!0})}},{key:"annotationCreated",value:function(e){this.props.onCreate($t(e))}},{key:"annotationUpdated",value:function(e){this.props.onUpdate($t(e))}},{key:"displayEditor",value:function(e,t){e.element.hasClass(e.classes.invert.y)||e.element.addClass(e.classes.invert.y)}},{key:"fixPopupLocation",value:function(e){var t=this.dlg.offset(),a=e.offset();e.offset({top:a.top-t.top,left:a.left-t.left})}},{key:"displayViewer",value:function(e,t){this.fixPopupLocation(e.element),e.element.addClass(e.classes.invert.y)}},{key:"onScaffoldSelected",value:function(e,t){var a=this.annotator.plugins.RichText.mceditor,n=a.selection.getContent(),o=e(n.length?n:t),r=o.tag,i=o.supportContentId;a.insertContent(r);var c=a.dom.get(i);c&&a.selection.setCursorLocation(c)}},{key:"render",value:function(){return o.a.createElement("div",{ref:this.contentRef},o.a.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.content}}))}}]),a}(o.a.Component),ta=(a(188),function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).onEditorSetup=n.onEditorSetup.bind(Object(p.a)(n)),n.onDrawingToolOpen=n.onDrawingToolOpen.bind(Object(p.a)(n)),n.addDrawing=n.addDrawing.bind(Object(p.a)(n)),n.onNoteChange=n.onNoteChange.bind(Object(p.a)(n)),n.wordCount=n.wordCount.bind(Object(p.a)(n)),n.onTabSelected=n.onTabSelected.bind(Object(p.a)(n)),n.onAnnotationCreated=n.onAnnotationCreated.bind(Object(p.a)(n)),n.onAnnotationDeleted=n.onAnnotationDeleted.bind(Object(p.a)(n)),n.onAnnotationUpdated=n.onAnnotationUpdated.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){this.props.drawing&&e.drawing!==this.props.drawing&&this.props.drawTool===this.props.noteId&&(this.editor.insertContent(this.props.drawing),this.props.removeDrawing())}},{key:"onNoteChange",value:function(e){if(e.scaffold){var t=e.scaffold,a=t.tagCreator,n=t.initialText;this.addSupport(!0,n,a)}else e.attach?this.editor.insertContent(e.attach):(this.props.editNote(Object(ae.a)({_id:this.props.noteId},e)),e.data&&e.data.body&&this.wordCount(e.data.body))}},{key:"wordCount",value:function(e){var t=this.editor.plugins.wordcount.getCount()-function(e){for(var t="<div>"+e+"</div>",a=Pe()(t).find(".kfSupportStartLabel"),n=0,o=0;o<a.length;o++)n+=a[o].innerHTML.split(" ").length;return n}(e);this.props.setWordCount({contribId:this.props.noteId,wc:t})}},{key:"onEditorSetup",value:function(e){e.onDrawButton=this.onDrawingToolOpen,this.editor=e}},{key:"onDrawingToolOpen",value:function(e){e?this.props.editSvgDialog(this.props.noteId,e):this.props.openDrawDialog(this.props.noteId)}},{key:"addDrawing",value:function(e){this.editor.insertContent(e)}},{key:"addSupport",value:function(e,t,a){var n=this.editor.selection.getContent(),o=a(n.length?n:t),r=o.tag,i=o.supportContentId;if(this.editor.insertContent(r),e){var c=this.editor.dom.get(i);c&&this.editor.selection.setCursorLocation(c)}}},{key:"onTabSelected",value:function(e){"history"===e&&this.props.fetchRecords(this.props.note._id),"author"===e&&this.props.fetchCommGroups(this.props.note.communityId)}},{key:"onAnnotationCreated",value:function(e){this.props.createAnnotation(this.props.note.communityId,this.props.note._id,this.props.author._id,e)}},{key:"onAnnotationDeleted",value:function(e){e.linkId&&e.modelId&&this.props.deleteAnnotation(e.linkId,this.props.note._id,e.modelId)}},{key:"onAnnotationUpdated",value:function(e){if(e.linkId&&e.modelId){var t=Object.assign({},this.props.note.annos[e.modelId]);t?(t.data=e,this.props.modifyAnnotation(t,this.props.note.communityId,this.props.note._id)):console.error("ERROR! model couldn't find")}else console.error("ERROR! annoVM doesn't have id on update")}},{key:"render",value:function(){var e=this,t=new Intl.DateTimeFormat("default",ue);return o.a.createElement("div",null,o.a.createElement("div",{className:"contrib-info"},"Created By: ",this.props.author.firstName," ",this.props.author.lastName," ",o.a.createElement("br",null),"Last modified: ",t.format(new Date(this.props.note.modified))),o.a.createElement(vt.a,{defaultActiveKey:"write",transition:!1,onSelect:this.onTabSelected},o.a.createElement(yt.a,{eventKey:"read",title:"read"},o.a.createElement(ea,{containerId:this.props.dlgId,content:this.props.note.data.body,annots:this.props.note.annos,annotsFetched:this.props.note.annotsFetched,author:this.props.author,onCreate:this.onAnnotationCreated,onUpdate:this.onAnnotationUpdated,onDelete:this.onAnnotationDeleted,onAnnotsLoaded:function(){return e.props.setAnnotationsLoaded({contribId:e.props.note._id,value:0})}})),o.a.createElement(yt.a,{eventKey:"write",title:"write"},o.a.createElement(Mt,{note:this.props.note,onScaffoldSelected:this.scaffoldSelected,onChange:this.onNoteChange,onEditorSetup:this.onEditorSetup})),o.a.createElement(yt.a,{eventKey:"author",title:"author(s)"},o.a.createElement(Ut,{contribId:this.props.noteId})),o.a.createElement(yt.a,{eventKey:"history",title:"history"},o.a.createElement(Pt,{records:this.props.note.records})),o.a.createElement(yt.a,{eventKey:"properties",title:"properties"},o.a.createElement(Bt,{contribution:this.props.note,onChange:this.onNoteChange}))))}}]),a}(o.a.Component)),aa={editNote:Ye,openDrawDialog:Ae,setWordCount:at,removeDrawing:Qe,editSvgDialog:function(e,t){return function(a){a(Xe({noteId:e,svg:t})),a(Ae(e))}},fetchAttachments:dt,fetchRecords:function(e){return function(){var t=Object(j.a)(S.a.mark((function t(a,n){var o,r,i;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n().users,t.next=3,Y(e);case 3:r=t.sent,i=new Intl.DateTimeFormat("default",ue),r.forEach((function(e){if(o[e.authorId]){var t=o[e.authorId];e.author="".concat(t.firstName," ").concat(t.lastName)}else e.author="NA";e.date=i.format(new Date(e.timestamp))})),a(ot({contribId:e,records:r}));case 7:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}()},deleteAnnotation:function(e,t,a){return function(){var n=Object(j.a)(S.a.mark((function n(o){return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H(e);case 2:return n.abrupt("return",o(lt({contribId:t,annoId:a})));case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},fetchCommGroups:function(e){return function(){var t=Object(j.a)(S.a.mark((function t(a){var n;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(e);case 2:n=t.sent,a(le({groups:n}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},createAnnotation:function(e,t,a,n){return function(){var o=Object(j.a)(S.a.mark((function o(r){var i,c,s;return S.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i={communityId:e,type:"Annotation",title:"an Annotation",authors:[a],status:"active",permission:"private",data:n},o.next=3,G(e,i);case 3:return c=o.sent,o.next=6,z(c._id,t,"annotates");case 6:s=o.sent,n.linkId=s._id,n.modelId=c._id,r(ct({contribId:t,annotation:c}));case 10:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}()},modifyAnnotation:function(e,t,a){return function(){var n=Object(j.a)(S.a.mark((function n(o){var r;return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,K(e,t,e._id);case 2:return r=n.sent,n.abrupt("return",o(ct({contribId:a,annotation:r})));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},setAnnotationsLoaded:st},na=Object(te.b)((function(e,t){var a=e.notes[t.noteId];return{note:a,drawing:e.notes.drawing,drawTool:e.dialogs.drawTool,author:a&&(e.users[a.authors[0]]||"NA")}}),aa)(ta),oa=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).onConfirm=n.onConfirm.bind(Object(p.a)(n)),n.onLoad=n.onLoad.bind(Object(p.a)(n)),n.getIframeRef=n.getIframeRef.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"onConfirm",value:function(){var e=this.iframe_ref.contentWindow,t=e.svgCanvas.current_drawing_.all_layers[0],a=e.svgCanvas.current_drawing_.all_layers[1],n=a[1].getBBox().width,o=a[1].getBBox().height;e.svgCanvas.current_drawing_.svgElem_.setAttribute("width",n),e.svgCanvas.current_drawing_.svgElem_.setAttribute("height",o),t[1].childNodes[1].setAttribute("width",n),t[1].childNodes[1].setAttribute("height",o),e.svgCanvas.selectAllInCurrentLayer(),e.svgCanvas.groupSelectedElements(),e.svgCanvas.alignSelectedElements("l","page"),e.svgCanvas.alignSelectedElements("t","page"),e.svgCanvas.ungroupSelectedElement(),e.svgCanvas.clearSelection(),e.svgCanvas.current_drawing_.svgElem_.setAttribute("padding","2em"),e.svgCanvas.setResolution("fit",100);var r=e.svgCanvas.getSvgString(),i=document.createElement("canvas");i.width=n+4,i.height=o+4;var c=i.getContext("2d"),s=document.createElement("img");s.setAttribute("src","data:image/svg+xml;base64,"+btoa(r)),s.onload=function(){c.drawImage(s,0,0);var e=i.toDataURL("image/png"),t="<img alt='"+r+"' src='"+e+"'/>";this.props.onConfirm(t)}.bind(this)}},{key:"getIframeRef",value:function(e){e&&(this.iframe_ref=e)}},{key:"onLoad",value:function(e){var t=this.props.note.editSvg;t&&e.target.contentWindow.svgCanvas.setSvgString(t)}},{key:"render",value:function(){return o.a.createElement(Et,{title:"DrawTool",style:{zIndex:3e3},onClose:this.props.onClose,onConfirm:this.onConfirm,confirmButton:"Add"},o.a.createElement("iframe",{onLoad:this.onLoad,title:"DrawingTool",src:"/drawing-tool/svg/index.html",ref:this.getIframeRef,width:"100%",height:"100%"}))}}]),a}(o.a.Component),ra=Object(te.b)((function(e,t){return{note:e.notes[t.noteId]}}))(oa),ia=function(e){var t=Object(te.d)((function(e){return e.dialogs})),a=Object(te.c)(),r=Object(n.useCallback)((function(e){a(xe(e.id)),a($e(e.noteId))}),[a]),i=Object(n.useCallback)((function(e){var t,n;a((t=e.noteId,n=e.id,function(){var e=Object(j.a)(S.a.mark((function e(a,o){var r,i,c,s,l;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o(),i=r.notes[t],(i=Object.assign({},i)).data=Object.assign({},i.data),i.title){e.next=7;break}return Ge({title:"Error Saving Note!",type:"danger",message:"Title is required"}),e.abrupt("return");case 7:if("Note"!==i.type){e.next=22;break}return i.status="active",e.next=11,Ke(i.data.body,i._id,i.toLinks,i.fromLinks);case 11:return c=e.sent,a(ht(t,"from")),a(ht(t,"to")),s=c.html(),i.data.body=s,e.next=18,K(i,i.communityId,i._id);case 18:l=e.sent,a(Ye(l)),void 0!==n&&a(xe(n)),Ge({title:"Saved!",type:"success",message:"Contribution created!"});case 22:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()))}),[a]),c=Object(n.useCallback)((function(e){return a(De(e))}),[a]),s=Object(n.useCallback)((function(){a(Te())}),[a]),l=Object(n.useCallback)((function(e){a(Je(e)),a(Te())}),[a]);return o.a.createElement("div",null,t.dialogs.map((function(e,t){return o.a.createElement(Et,{key:e.id,id:e.id,onMouseDown:function(){return c(e.id)},title:e.title,style:{zIndex:e.zIndex},onClose:function(){return r(e)},onConfirm:function(){return i(e)},confirmButton:e.confirmButton},o.a.createElement(na,{key:e.noteId,dlgId:e.id,noteId:e.noteId}))})),null!==t.drawTool?o.a.createElement(ra,{onClose:s,onConfirm:l,noteId:t.drawTool}):null)},ca=a(225),sa=(a(189),function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).noteList=[],n.state={token:sessionStorage.getItem("token"),myViews:[],viewId:sessionStorage.getItem("viewId"),viewTitle:sessionStorage.getItem("viewTitle")?sessionStorage.getItem("viewTitle"):"welcome",addView:sessionStorage.getItem("viewTitle")?sessionStorage.getItem("viewTitle"):"welcome",communityId:sessionStorage.getItem("communityId"),visible:!1},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t={headers:{Authorization:"Bearer ".concat(this.state.token)}},a="".concat(x,"/communities/").concat(this.state.communityId,"/views");E.a.get(a,t).then((function(t){e.setState({myViews:t.data})})).catch((function(e){}))}},{key:"handleChange",value:function(e){e.persist();var t=e.target.value;this.setState({addView:t})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),console.log("State Handle Submit",this.state.addView);var a="".concat(x,"/links"),n={headers:{Authorization:"Bearer ".concat(this.state.token)}};this.props.noteContnetList.forEach((function(e){var o=e._id,r={from:t.state.addView,to:o,type:"contains"};E.a.post(a,r,n).then((function(e){t.setState({visible:!0},(function(){window.setTimeout((function(){t.setState({visible:!1})}),1e3)}))}))}))}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement(w.a,{className:"mrg-1-top"},o.a.createElement(Ce.a,null,o.a.createElement(ke.a,{md:"8"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"select",name:"viewId",value:this.state.addView,onChange:this.handleChange},this.state.myViews.map((function(e,t){return o.a.createElement("option",{key:t,value:e._id}," ",e.title," ")}))))),o.a.createElement(ke.a,{md:"4"},o.a.createElement(ee.a,{onClick:this.handleSubmit},"Add to View"))),o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement(ca.a,{color:"info",isOpen:this.state.visible},"Notes added to View!")))),this.props.noteContnetList.map((function(t,a){if(e.props.query&&t.data.English){var n=t.data.English,r=n.indexOf(e.props.query);r>=0&&(t.data.English=n.substring(0,r)+"<span class='highlight'>"+n.substring(r,r+e.props.query.length)+"</span>"+n.substring(r+e.props.query.length))}else if(e.props.query&&t.data.body){var i=t.data.body,c=i.indexOf(e.props.query);c>=0&&(t.data.body=i.substring(0,c)+"<span class='highlight'>"+i.substring(c,c+e.props.query.length)+"</span>"+i.substring(c+e.props.query.length))}return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{className:"min-height-2 mrg-05 border rounded mrg-1-bot pd-1",key:a},o.a.createElement(ke.a,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,{md:"11",className:"pd-1 primary-800 font-weight-bold"},t.title),o.a.createElement(ke.a,{md:"1"},o.a.createElement(ee.a,{variant:"secondary",onClick:function(){return e.props.closeNote(t._id)}},"X"))),o.a.createElement(Ce.a,null,o.a.createElement("span",{className:"pd-1",dangerouslySetInnerHTML:{__html:t.data.English?t.data.English:t.data.body}})))))})))}}]),a}(n.Component)),la=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).token=sessionStorage.getItem("token"),n.state={communityId:sessionStorage.getItem("communityId"),authors:[],authorName:""},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this,t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(x,"/communities/").concat(this.state.communityId,"/authors");E.a.get(a,t).then((function(t){e.setState({authors:t.data}),e.state.authors.filter((function(t){return t._id.includes(e.props.authorId)})).map((function(t){return e.setState({authorName:t.firstName+" "+t.lastName}),null}))})).catch((function(e){alert(e)}))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null," ",this.state.authorName))}}]),a}(n.Component),ua=(a(197),a(198)),ma=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).myRegistrations=[],n.myViews=[],n.myCommunityId="",n.show=!1,n.from=[],n.to=[],n.myTempTo=[],n.hierarchyNote=[],n.noteData1=[],n.noteContnetNew=[],n.token=sessionStorage.getItem("token"),n.handleChange=function(e){var t=e.target,a=t.name,o=t.value;n.setState(Object(m.a)({},a,o))},n.handleChangeView=function(e){var t=e.target,a=t.name,o=t.value;n.setState(Object(m.a)({},a,o))},n.closeNote=function(e){if(n.state.noteContnetList){var t=Object(Oe.a)(n.state.noteContnetList);t&&t.filter((function(t){return t._id.includes(e)})).map((function(e){return t.pop(e),n.setState({noteContnetList:Object(Oe.a)(t)}),null}))}},n.filterNotes=function(e){var t;t=n.noteData1.filter((function(t){return t.data&&t.data.English?t.data.English.includes(e):null})),n.setState({filteredData:t})},n.handleInputChange=function(e){n.setState({query:e.target.value});var t=[];if(n.state.query||n.state.filter)switch(n.state.filter){case"title":n.state.viewLinks.filter((function(e){return e._to.title.includes(n.state.query)})).map((function(e){return t.push(e),null}));break;case"content":t=n.noteData1.filter((function(t){return t.data&&t.data.English?t.data.English.includes(e.target.value):t.data&&t.data.body?t.data.body.includes(e.target.value):null}));break;case"author":var a=[];n.state.authors.map((function(e){return(e.firstName.toLowerCase().includes(n.state.query.toLowerCase())||e.lastName.toLowerCase().includes(n.state.query.toLowerCase()))&&a.push(e._id),null})),a.forEach((function(e){t=n.noteData1.filter((function(t){return t.authors.includes(e)})).map((function(e){return e}))}));break;case"scaffold":var o=[];n.state.scaffolds.map((function(e){return e.map((function(e){return o.push(e._to.title),null})),null})),n.setState({scaffoldsTitle:o})}n.setState({filteredData:t})},n.handleFilter=function(e){var t=e.target.value;n.setState({filter:t})},n.buildOn=function(e){sessionStorage.setItem("buildOn",e),n.props.newNote(n.props.view,n.props.communityId,n.props.author._id)},n.openNote=function(e){n.props.openContribution(e)},n.state={communitites:[],myCommunities:[],views:[],communityId:sessionStorage.getItem("communityId"),viewId:sessionStorage.getItem("viewId"),viewLinks:[],showView:!1,showCommunity:!1,showContribution:!1,showNote:!1,hNotes:[],addView:"",showRiseAbove:!1,showModel:!1,showNoteContent:!1,noteContnetList:[],query:"",filteredData:[],filter:"title",authors:[],scaffolds:[],scaffoldsTitle:[],noteData:[]},n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n.handleSubmitView=n.handleSubmitView.bind(Object(p.a)(n)),n.handleChangeView=n.handleChangeView.bind(Object(p.a)(n)),n.onCloseDialog=n.onCloseDialog.bind(Object(p.a)(n)),n.onConfirmDrawDialog=n.onConfirmDrawDialog.bind(Object(p.a)(n)),n.handleInputChange=n.handleInputChange.bind(Object(p.a)(n)),n.showContent=n.showContent.bind(Object(p.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.fetchAuthor(this.props.communityId),this.props.fetchView(this.props.viewId),this.props.fetchCommunity(this.props.communityId),this.props.fetchAuthors(this.props.communityId),this.setState(this.props.location.state),E.a.get("".concat(x,"/communities")).then((function(t){e.setState({communitites:t.data})})).catch((function(e){console.log("GET Communities Failed"),alert("GET Communities Failed")}));var t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(x,"/communities/").concat(this.state.communityId,"/views");E.a.get(a,t).then((function(t){e.setState({myViews:t.data})})).catch((function(e){alert(e)})),E.a.get("".concat(x,"/users/myRegistrations"),t).then((function(t){e.setState({myCommunities:t.data})})).catch((function(e){alert(e)}));var n,o="".concat(x,"/links/from/").concat(sessionStorage.getItem("viewId")),r=[];E.a.get(o,t).then((function(a){n=a.data.filter((function(e){return"Note"===e._to.type&&""!==e._to.title&&"active"===e._to.status})).map((function(e){var a="".concat(x,"/objects/").concat(e.to);return E.a.get(a,t).then((function(e){r.push(e.data)})).catch((function(t){console.log("Failed to get data for: ",e.to)})),e}));var o=ua.sortBy(n,(function(e){return e._to.modified})).reverse();e.setState({viewLinks:o,noteData:r}),e.noteData1=r})).catch((function(e){console.log("Failed to get Links for viewId",sessionStorage.getItem("viewId"))}));var i="".concat(x,"/links/").concat(this.state.communityId,"/search");E.a.post(i,{query:{type:"buildson"}},t).then((function(t){t.data.reverse().filter((function(e){return"Note"===e._to.type&&"active"===e._to.status&&"Note"===e._from.type&&"active"===e._from.status?e:null})).map((function(t){return e.from.push(t.from),e.to.push(t.to),e.hierarchyNote.push(t),null}));try{for(var a in e.to)if(e.from.includes(e.to[a])){var n=e.from.indexOf(e.to[a]),o=[];e.hierarchyNote[n]&&o.push(e.hierarchyNote[n]),o.push(e.hierarchyNote[a]),e.hierarchyNote[a]=o,delete e.hierarchyNote[n]}}catch(r){console.log("Error in Hnotes",r)}finally{e.setState({hNotes:e.hierarchyNote})}})).catch((function(e){console.log("Error occured for BuildsOn",e)}));var c="".concat(x,"/communities/").concat(this.state.communityId,"/authors");E.a.get(c,t).then((function(t){e.setState({authors:t.data})})).catch((function(e){alert(e)}));var s=[];M(this.state.communityId).then((function(a){a.data.scaffolds.forEach((function(e){var a="".concat(x,"/links/from/")+e;E.a.get(a,t).then((function(e){s.push(e.data)}))})),e.setState({scaffolds:s})}))}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"handleSubmitView",value:function(e){e.preventDefault();var t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(x,"/contributions/").concat(this.state.communityId),n={authors:[sessionStorage.getItem("userId")],communityId:this.state.communityId,permission:"public",status:"active",title:this.state.addView,type:"View"};E.a.post(a,n,t).then((function(e){})).catch((function(e){console.log(e)}))}},{key:"logout",value:function(){sessionStorage.removeItem("token")}},{key:"newContribution",value:function(){this.setState({showContribution:!0,showCommunity:!1,showView:!1,showRiseAbove:!1})}},{key:"newNote",value:function(){this.setState({showNote:!0,showView:!1,showRiseAbove:!1})}},{key:"newView",value:function(){this.setState({showView:!0,showRiseAbove:!1,showNote:!1,showModel:!0})}},{key:"newRiseAbove",value:function(){this.setState({showView:!1,showNote:!1,showRiseAbove:!0,showModel:!0})}},{key:"handleShow",value:function(e){this.setState({showModel:e})}},{key:"handleShowNoteContent",value:function(e){this.setState({showView:!1,showNote:!1,showRiseAbove:!1})}},{key:"showContent",value:function(e,t){var a=this,n=e.target.checked;(this.setState({showNoteContent:!0}),n)?this.noteData1.map((function(e){return e._id&&e._id===t&&(a.noteContnetNew.push(e),a.setState({noteContnetList:a.noteContnetNew})),null})):(this.noteContnetNew.filter((function(e){return e._id.includes(t)})).map((function(e){return a.noteContnetNew.pop(e),null})),this.setState({noteContnetList:this.noteContnetNew}))}},{key:"changeView",value:function(e){this.setState({viewId:e.obj._id}),sessionStorage.setItem("viewId",e.obj._id),sessionStorage.setItem("viewTitle",e.obj.title),this.handleShow(!1),window.location.reload()}},{key:"onConfirmDrawDialog",value:function(e){this.props.addDrawing(e),this.props.closeDrawDialog()}},{key:"onCloseDialog",value:function(e){this.props.removeNote(e.noteId),this.props.closeDialog(e.id)}},{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement(ia,null),o.a.createElement("div",{className:"row min-width"},o.a.createElement(ke.a,{md:"1",sm:"12",className:"pd-6-top"},o.a.createElement(Ce.a,{className:"mrg-025"},o.a.createElement(ke.a,{md:"12",sm:"2",xs:"2"},o.a.createElement(Ne.a,{drop:"right",variant:"outline-info",title:o.a.createElement("i",{className:"fas fa-plus-circle"})},o.a.createElement(Ie.a.Item,{onClick:function(){return e.props.newNote(e.props.view,e.props.communityId,e.props.author._id)}},"New Note"),o.a.createElement(Ie.a.Item,{onClick:function(){return e.newView()}},"new View"),o.a.createElement(Ie.a.Item,{onClick:function(){return e.newRiseAbove()}},"New RiseAbove"))),o.a.createElement(ke.a,{md:"12",sm:"2",xs:"2"},o.a.createElement(Ne.a,{drop:"right",variant:"outline-info",title:o.a.createElement("i",{className:"fa fa-pencil"})})),o.a.createElement(ke.a,{md:"12",sm:"2",xs:"2"},o.a.createElement(Ne.a,{drop:"right",variant:"outline-info",title:o.a.createElement("i",{className:"fas fa-file"})})),o.a.createElement(ke.a,{md:"12",sm:"2",xs:"2"},o.a.createElement(Ne.a,{drop:"right",variant:"outline-info",title:o.a.createElement("i",{className:"fas fa-hammer"})})),o.a.createElement(ke.a,{md:"12",sm:"2",xs:"2"},o.a.createElement(Ne.a,{drop:"right",variant:"outline-info",title:o.a.createElement("i",{className:"fas fa-edit"})})))),o.a.createElement(ke.a,{md:"5",sm:"12",className:"mrg-6-top pd-2-right v-scroll"},o.a.createElement(w.a,{className:"mrg-1-bot"},o.a.createElement(Ce.a,null,o.a.createElement(ke.a,{md:"8"},o.a.createElement(O.a,null,o.a.createElement(C.a,{placeholder:"Search Your Note",onChange:this.handleInputChange}))),o.a.createElement(ke.a,{md:"4"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"select",name:"filter",id:"filter",onChange:this.handleFilter},o.a.createElement("option",{key:"title",value:"title"},"Search By Title"),o.a.createElement("option",{key:"scaffold",value:"scaffold"},"Search By Scaffold"),o.a.createElement("option",{key:"content",value:"content"},"Search By Content"),o.a.createElement("option",{key:"author",value:"author"},"Search By Author")))))),""===this.state.query?o.a.createElement(o.a.Fragment,null,this.state.hNotes.map((function(t,a){return o.a.createElement(Ce.a,{key:a,className:"mrg-05-top"},o.a.createElement(ke.a,{className:"mr-auto primary-bg-200 rounded mrg-1-bot"},t._to&&t._to.title&&t._to.created?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{className:"pd-05"},o.a.createElement(ke.a,{md:"10",className:"primary-800 font-weight-bold"},t._to.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"checkbox",ref:t.to,onChange:function(a){return e.showContent(a,t.to)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:t._to.authors}),"\xa0 ",t._to.created),o.a.createElement(ke.a,{md:"2"},o.a.createElement(ee.a,{onClick:function(){return e.buildOn(t.to)}},"BuildOn")))):o.a.createElement(o.a.Fragment,null,t[0]?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{className:""},o.a.createElement(ke.a,null,o.a.createElement(Ce.a,null,t[0]._to&&t[0]._to.title&&t[0]._to.created?o.a.createElement(o.a.Fragment,null,o.a.createElement(ke.a,null,o.a.createElement(Ce.a,{className:"pd-05"},o.a.createElement(ke.a,{md:"10",className:"primary-800 font-weight-bold"}," ",t[0]._to.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"checkbox",ref:t[0].to,onChange:function(a){return e.showContent(a,t[0].to)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:t[0]._to.authors}),"\xa0 ",t[0]._to.created),o.a.createElement(ke.a,{md:"2"},o.a.createElement(ee.a,{onClick:function(){return e.buildOn(t[0].to)}},"BuildOn"))))):null),t.map((function(a,n){return o.a.createElement(Ce.a,{key:n},o.a.createElement(ke.a,{md:"1"}),o.a.createElement(ke.a,null,t[0]&&t[0]._to&&t[0]._to.title&&a&&a._from&&a._from.created?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{className:"pd-05 border-left border-primary"},o.a.createElement(ke.a,{className:"primary-800 font-weight-bold"},a._from.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min"},o.a.createElement(O.a,null,o.a.createElement(C.a,{className:"pd-left",type:"checkbox",ref:a.from,onChange:function(t){return e.showContent(t,a.from)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05 border-left border-primary"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:a._from.authors}),"\xa0 ",a._from.created),o.a.createElement(ke.a,{md:"2"},o.a.createElement(ee.a,{onClick:function(){return e.buildOn(a.from)}},"BuildOn")))):o.a.createElement(o.a.Fragment,null)))}))))):o.a.createElement(o.a.Fragment,null)),t._from&&t._from.title&&t._to.created?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,{md:"1"}),o.a.createElement(ke.a,null,o.a.createElement(Ce.a,{className:"pd-05 border-left border-primary"},o.a.createElement(ke.a,{className:"primary-800 font-weight-bold"},t._from.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min"},o.a.createElement(O.a,null,o.a.createElement(C.a,{className:"pd-left",type:"checkbox",ref:t.from,onChange:function(a){return e.showContent(a,t.from)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05 border-left border-primary"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:t._from.authors}),"\xa0 ",t._from.created),o.a.createElement(ke.a,{md:"2"},o.a.createElement(ee.a,{onClick:function(){return e.buildOn(t.from)}},"BuildOn")))))):o.a.createElement(o.a.Fragment,null)))})),this.state.viewLinks.map((function(t,a){return o.a.createElement(o.a.Fragment,null,t&&t._to.title?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{key:a,value:t.to,className:"mrg-05-top"},o.a.createElement(ke.a,{className:"primary-bg-200 rounded mrg-1-bot"},o.a.createElement(Ce.a,{className:"pd-05"},o.a.createElement(ke.a,{className:"primary-800 font-weight-bold"}," ",t._to.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"checkbox",ref:t.to,onChange:function(a){return e.showContent(a,t.to)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:t._to.authors}),"\xa0 ",t._to.created),o.a.createElement(ke.a,{md:"3"},o.a.createElement(ee.a,{size:"sm",onClick:function(){return e.buildOn(t.to)}},"BuildOn"),o.a.createElement(ee.a,{size:"sm",className:"ml-1",onClick:function(){return e.openNote(t.to)}},o.a.createElement("i",{className:"fa fa-pencil"}))))))):o.a.createElement(o.a.Fragment,null))}))):o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,null,this.state.scaffoldsTitle&&"scaffold"===this.state.filter?o.a.createElement(ke.a,null,this.state.scaffoldsTitle.map((function(t,a){return o.a.createElement(Ce.a,{key:a,className:"scaffold-title"},o.a.createElement(c.b,{onClick:function(){return e.filterNotes(t)},className:"white"},t))}))):null),this.state.filteredData.map((function(t,a){return o.a.createElement(o.a.Fragment,null,t._to&&t._to.title?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{key:a,value:t.to,className:"mrg-05-top"},o.a.createElement(ke.a,{className:"primary-bg-200 rounded mrg-1-bot"},o.a.createElement(Ce.a,{className:"pd-05"},o.a.createElement(ke.a,{className:"primary-800 font-weight-bold"}," ",t._to.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"checkbox",ref:t.to,onChange:function(a){return e.showContent(a,t.to)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:t._to.authors}),"\xa0 ",t._to.created),o.a.createElement(ke.a,{md:"2"},o.a.createElement(ee.a,{onClick:function(){return e.buildOn(t.to)}},"BuildOn")))))):o.a.createElement(o.a.Fragment,null,t._id?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ce.a,{key:a,value:t._id,className:"mrg-05-top"},o.a.createElement(ke.a,{className:"primary-bg-200 rounded mrg-1-bot"},o.a.createElement(Ce.a,{className:"pd-05"},o.a.createElement(ke.a,{className:"primary-800 font-weight-bold"}," ",t.title),o.a.createElement(ke.a,{md:"2"},o.a.createElement(w.a,{className:"mrg-1-min pd-2-right"},o.a.createElement(O.a,null,o.a.createElement(C.a,{type:"checkbox",ref:t._id,onChange:function(a){return e.showContent(a,t._id)}}))))),o.a.createElement(Ce.a,{className:"primary-600 sz-075 pd-05"},o.a.createElement(ke.a,null,o.a.createElement(la,{authorId:t.authors}),"\xa0 ",t.created),o.a.createElement(ke.a,{md:"2"},o.a.createElement(ee.a,{onClick:function(){return e.buildOn(t._id)}},"BuildOn")))))):o.a.createElement(o.a.Fragment,null)))})))),this.state.showNoteContent?o.a.createElement(o.a.Fragment,null,o.a.createElement(ke.a,{md:"5",sm:"12",className:"mrg-6-top v-scroll"},o.a.createElement(sa,{noteContnetList:this.state.noteContnetList,closeNote:this.closeNote,query:this.state.query,filter:this.state.filter}))):null),o.a.createElement(Se.a,{show:this.state.showModel,onHide:function(){return e.handleShow(!1)}},this.state.showContribution?o.a.createElement(o.a.Fragment,null,o.a.createElement(Se.a.Header,{closeButton:!0},o.a.createElement(Se.a.Title,null,"Contributions")),o.a.createElement(Se.a.Body,{style:{"max-height":"calc(100vh - 300px)","overflow-y":"auto"}},this.state.hNotes.map((function(e,t){return o.a.createElement(Ce.a,{key:t,value:e.to,className:"mrg-05-top"},o.a.createElement(ke.a,{className:"mr-auto"},o.a.createElement(Ce.a,{className:"indigo"}," ",e._to.title),o.a.createElement(Ce.a,null," ",e.to),o.a.createElement(Ce.a,{className:"pd-2-left blue"}," ",e._from.title),o.a.createElement(Ce.a,{className:"pd-2-left"}," ",e.from),o.a.createElement("hr",null)))})),this.state.viewLinks.map((function(e,t){return o.a.createElement(Ce.a,{key:t,value:e.to,className:"mrg-05-top"},o.a.createElement(ke.a,null,o.a.createElement(Ce.a,{className:"indigo"}," ",e._to.title),o.a.createElement(Ce.a,null," ",e.to),o.a.createElement("hr",null)))})))):null,this.state.showView?o.a.createElement(o.a.Fragment,null,o.a.createElement(Se.a.Header,{closeButton:!0},o.a.createElement(Se.a.Title,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,"Views")),o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,o.a.createElement(Ce.a,null,o.a.createElement(w.a,{onSubmit:this.handleSubmitView,className:"form"},o.a.createElement(ke.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"addView",style:{fontSize:"1rem"}},"Add View"),o.a.createElement(C.a,{type:"text",id:"addView",placeholder:"Enter View Name",name:"addView",value:this.state.addView,onChange:this.handleChangeView}))),o.a.createElement(ke.a,null,o.a.createElement(ee.a,{varient:"secondary",onClick:this.handleSubmitView},"Add")))))))),o.a.createElement(Se.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},this.state.myViews.map((function(t,a){return o.a.createElement(Ce.a,{key:a,value:t.title,className:"mrg-05-top"},o.a.createElement(ke.a,null,o.a.createElement(c.b,{onClick:function(){return e.changeView({obj:t})}}," ",t.title," ")))})))):null,this.state.showRiseAbove?o.a.createElement(o.a.Fragment,null,o.a.createElement(Se.a.Header,{closeButton:!0},o.a.createElement(Se.a.Title,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,"New RiseAbove")))),o.a.createElement(Se.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},o.a.createElement(w.a,{onSubmit:this.handleSubmit},o.a.createElement(k.a,{htmlFor:"riseAboveTitle",style:{fontSize:"1rem"}},"RiseAbove Title"),o.a.createElement(C.a,{type:"text",id:"riseAboveTitle",placeholder:"Enter RiseAbove Title",name:"riseAboveTitle",value:this.state.riseAboveTitle,onChange:this.handleChange}),o.a.createElement(ee.a,{className:"mrg-1-top",onClick:this.handleSubmit},"Submit")))):null,this.state.showNote?o.a.createElement(o.a.Fragment,null,o.a.createElement(Se.a.Header,{closeButton:!0},o.a.createElement(Se.a.Title,null,o.a.createElement(Ce.a,null,o.a.createElement(ke.a,null,"New Note")))),o.a.createElement(Se.a.Body,{style:{"max-height":"calc(100vh - 210px)","overflow-y":"auto"}},"New Note")):null,o.a.createElement(Se.a.Footer,null,o.a.createElement(ee.a,{variant:"secondary",onClick:function(){return e.handleShow(!1)}},"Close"))))}}]),a}(n.Component),da={fetchAuthor:he,fetchView:pe,fetchCommunity:fe,fetchAuthors:Xt,setCommunityId:re,setViewId:ie,newNote:mt,openContribution:pt},ha=Object(te.b)((function(e,t){return{communityId:e.globals.communityId,viewId:e.globals.viewId,view:e.globals.view,author:e.globals.author}}),da)(ma),pa=function(e){var t=Object(te.d)((function(e){return e.globals.communityId})),a=Object(te.d)((function(e){return e.globals.viewId})),r=Object(te.d)((function(e){return e.globals.view})),i=Object(te.d)((function(e){return e.globals.author})),c=Object(te.c)();return Object(n.useEffect)((function(){c(he(t)),c(pe(a)),c(fe(t)),c(Xt(t))}),[c,t,a]),o.a.createElement("div",{style:{marginTop:"100px"}},o.a.createElement(ee.a,{onClick:function(){c(mt(r,t,i._id))}},"New Note"),o.a.createElement("br",null),o.a.createElement(ee.a,{onClick:function(e){c(pt("5ee2aefee028a1d4cfb07252"))}},"Open Note"),o.a.createElement(ia,null))},fa=function(e){Object(b.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).token=sessionStorage.getItem("token"),e.state={oldPassword:"",newPassword:""},e.handleChange=e.handleChange.bind(Object(p.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(p.a)(e)),e}return Object(h.a)(a,[{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(m.a)({},a,n))}},{key:"handleSubmit",value:function(e){e.preventDefault(),console.log("The form was submitted with:"),console.log(this.state);var t={headers:{Authorization:"Bearer ".concat(this.token)}},a="".concat(x,"/users/").concat(sessionStorage.getItem("userId"),"/password");E.a.put(a,this.state,t).then((function(e){alert("Password is Successfully changed")})).catch((function(e){alert(e)}))}},{key:"render",value:function(){return o.a.createElement(v.a,null,o.a.createElement("div",{className:"mrg-8-top"},o.a.createElement(y.a,null,o.a.createElement("h3",null,"Change Password")),o.a.createElement(w.a,{onSubmit:this.handleSubmit,className:"form"},o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"oldPassword"},"Current Password"),o.a.createElement(C.a,{type:"password",id:"oldPassword",placeholder:"Enter Current Password",name:"oldPassword",value:this.state.oldPassword,onChange:this.handleChange}))),o.a.createElement(y.a,null,o.a.createElement(O.a,null,o.a.createElement(k.a,{htmlFor:"newPassword"},"New Password"),o.a.createElement(C.a,{type:"password",id:"password",placeholder:"Enter New Password",name:"newPassword",value:this.state.newPassword,onChange:this.handleChange}))),o.a.createElement(y.a,{className:"mrg-1-top"},o.a.createElement(N.a,null,"Save")))))}}]),a}(n.Component),ba=function(e){var t=Object(te.d)((function(e){return e.globals.communityId})),a=Object(te.c)();return Object(n.useEffect)((function(){console.log("use effect"),a(Xt(t)),a(he(t))}),[a,t]),o.a.createElement("div",{style:{marginTop:"100px"}},o.a.createElement(Vt,{note:{id:1,title:"hola",content:"asdf",attachments:[]}}),o.a.createElement(It,null))};a(200),a(201);var ga=function(){return Object(n.useEffect)((function(){var e=sessionStorage.getItem("token");e&&A(e)})),o.a.createElement("div",null,o.a.createElement(u.a,null),o.a.createElement(we,null),o.a.createElement(c.a,null,o.a.createElement(s.a,{exact:!0,path:"/",component:Q}),o.a.createElement(s.a,{path:"/signup",component:X}),o.a.createElement(s.a,{path:"/community-manager",component:Ee}),o.a.createElement(s.a,{path:"/view",component:ha}),o.a.createElement(s.a,{path:"/new-note",component:pa}),o.a.createElement(s.a,{path:"/change-password",component:fa}),o.a.createElement(s.a,{path:"/test",component:ba})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(te.a,{store:Zt},o.a.createElement(ga,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[134,1,2]]]);
//# sourceMappingURL=main.7841e113.chunk.js.map